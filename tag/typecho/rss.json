{
    "version": "https://jsonfeed.org/version/1",
    "title": "Lete乐特 's Blog • All posts by \"typecho\" tag",
    "description": "我相信我可以，但我一直在路上，所以我有无限的可能！！",
    "home_page_url": "https://blog.imlete.cn",
    "items": [
        {
            "id": "https://blog.imlete.cn/article/Vercel-Deploy-Typecho.html",
            "url": "https://blog.imlete.cn/article/Vercel-Deploy-Typecho.html",
            "title": "Vercel部署Typecho动态博客",
            "date_published": "2021-05-03T17:07:31.000Z",
            "content_html": "<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><blockquote>\n<p>感谢: <a href=\"https://github.com/am-abudu\">am-abudu</a> 大佬的 Vercel 实例</p>\n</blockquote>\n<p>相信很多人会和我一样 what? Vercel 什么时候能部署 PHP 了？我怎么不知道？(我用 Vercel 也有一年时间了，我居然不知道，之前的 Vercel 文档白看了?)</p>\n<p>然后我就去查<a href=\"https://vercel.com/docs/runtimes?query=php#advanced-usage/community-runtimes\">Vercel 文档</a>，果然发现了能部署 PHP<br>Vercel-PHP 地址：<a href=\"https://github.com/juicyfx/vercel-php\">juicyfx/vercel-php</a><br>本文 Github 仓库： <a href=\"https://github.com/lete114/Vercel-Typecho\">https://github.com/lete114/Vercel-Typecho</a></p>\n<h2 id=\"准备工作\"><a href=\"#准备工作\" class=\"headerlink\" title=\"准备工作\"></a>准备工作</h2><ol>\n<li>Github 账号</li>\n<li>Vercel 账号</li>\n<li>下载 Typecho 程序(<a href=\"https://typecho.org/\">官网</a>)</li>\n<li>自己喜欢的 Typecho 主题(<a href=\"https://typecho.me/\">主题官网</a>)</li>\n<li>数据库(MySQL、PostgreSQL、SQLite)</li>\n</ol>\n<h2 id=\"正文\"><a href=\"#正文\" class=\"headerlink\" title=\"正文\"></a>正文</h2><p>关于部署项目到 Vercel 有两种方式</p>\n<ol>\n<li>使用 Vercel CLI 进行部署</li>\n<li>使用第三方库进行拉去(GitHub、GitLab、Bitbucket)</li>\n</ol>\n<p>我个人是比较喜欢使用 Vercel CLI 的，但在这里我为了照顾大家，我还是使用<code>git push</code>到 Github 后再让 Vercel 来拉取的方式</p>\n<ol>\n<li>创建 Github 仓库：Vercel-Typecho</li>\n<li>本地解压 Typecho 程序<br>解压后会得到 bulid 目录内容如下<br><img src=\"/img/Vercel-Typecho/1.png\" alt=\"Typecho\"></li>\n</ol>\n<h3 id=\"Vercel-依赖\"><a href=\"#Vercel-依赖\" class=\"headerlink\" title=\"Vercel 依赖\"></a>Vercel 依赖</h3><p>在 bulid 目录下新建<code>vercel.json</code></p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;functions&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;api/index.php&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;runtime&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;vercel-php@0.4.0&quot;</span></span><br><span class=\"line\">    <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\">  <span class=\"punctuation\">&#125;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;routes&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span><span class=\"punctuation\">&#123;</span> <span class=\"attr\">&quot;src&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;/(.*)&quot;</span><span class=\"punctuation\">,</span> <span class=\"attr\">&quot;dest&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;/api/index.php&quot;</span> <span class=\"punctuation\">&#125;</span><span class=\"punctuation\">]</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n\n<p>在 bulid 目录下新建<code>config.inc.php</code></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Typecho Blog Platform</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@copyright</span>  Copyright (c) 2008 Typecho team (http://www.typecho.org)</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@license</span>    GNU General Public License 2.0</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@version</span>    $Id$</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/** 开启https */</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">define</span>(<span class=\"string\">&#x27;__TYPECHO_SECURE__&#x27;</span>,<span class=\"literal\">true</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/** 定义根目录 */</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">define</span>(<span class=\"string\">&#x27;__TYPECHO_ROOT_DIR__&#x27;</span>, <span class=\"title function_ invoke__\">dirname</span>(<span class=\"keyword\">__FILE__</span>));</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/** 定义插件目录(相对路径) */</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">define</span>(<span class=\"string\">&#x27;__TYPECHO_PLUGIN_DIR__&#x27;</span>, <span class=\"string\">&#x27;/usr/plugins&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/** 定义模板目录(相对路径) */</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">define</span>(<span class=\"string\">&#x27;__TYPECHO_THEME_DIR__&#x27;</span>, <span class=\"string\">&#x27;/usr/themes&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/** 后台路径(相对路径) */</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">define</span>(<span class=\"string\">&#x27;__TYPECHO_ADMIN_DIR__&#x27;</span>, <span class=\"string\">&#x27;/admin/&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/** 设置包含路径 */</span></span><br><span class=\"line\">@<span class=\"title function_ invoke__\">set_include_path</span>(<span class=\"title function_ invoke__\">get_include_path</span>() . PATH_SEPARATOR .</span><br><span class=\"line\">__TYPECHO_ROOT_DIR__ . <span class=\"string\">&#x27;/var&#x27;</span> . PATH_SEPARATOR .</span><br><span class=\"line\">__TYPECHO_ROOT_DIR__ . __TYPECHO_PLUGIN_DIR__);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/** 载入API支持 */</span></span><br><span class=\"line\"><span class=\"keyword\">require_once</span> <span class=\"string\">&#x27;Typecho/Common.php&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/** 程序初始化 */</span></span><br><span class=\"line\"><span class=\"title class_\">Typecho_Common</span>::<span class=\"title function_ invoke__\">init</span>();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/** 定义数据库参数 */</span></span><br><span class=\"line\"><span class=\"variable\">$db</span> = <span class=\"keyword\">new</span> <span class=\"title class_\">Typecho_Db</span>(<span class=\"string\">&#x27;Pdo_Mysql&#x27;</span>, <span class=\"string\">&#x27;typecho_&#x27;</span>);</span><br><span class=\"line\"><span class=\"variable\">$db</span>-&gt;<span class=\"title function_ invoke__\">addServer</span>(<span class=\"keyword\">array</span> (</span><br><span class=\"line\">  <span class=\"string\">&#x27;host&#x27;</span> =&gt; <span class=\"string\">&#x27;数据库地址&#x27;</span>,</span><br><span class=\"line\">  <span class=\"string\">&#x27;user&#x27;</span> =&gt; <span class=\"string\">&#x27;数据库用户名&#x27;</span>,</span><br><span class=\"line\">  <span class=\"string\">&#x27;password&#x27;</span> =&gt; <span class=\"string\">&#x27;数据库密码&#x27;</span>,</span><br><span class=\"line\">  <span class=\"string\">&#x27;charset&#x27;</span> =&gt; <span class=\"string\">&#x27;utf8mb4&#x27;</span>,</span><br><span class=\"line\">  <span class=\"string\">&#x27;port&#x27;</span> =&gt; <span class=\"string\">&#x27;3306&#x27;</span>,</span><br><span class=\"line\">  <span class=\"string\">&#x27;database&#x27;</span> =&gt; <span class=\"string\">&#x27;数据库昵称&#x27;</span>,</span><br><span class=\"line\">  <span class=\"string\">&#x27;engine&#x27;</span> =&gt; <span class=\"string\">&#x27;MyISAM&#x27;</span>,</span><br><span class=\"line\">), <span class=\"title class_\">Typecho_Db</span>::READ | <span class=\"title class_\">Typecho_Db</span>::WRITE);</span><br><span class=\"line\"><span class=\"title class_\">Typecho_Db</span>::<span class=\"title function_ invoke__\">set</span>(<span class=\"variable\">$db</span>);</span><br></pre></td></tr></table></figure>\n\n<p>在 bulid 目录下新建<code>api/index.php</code></p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"variable\">$file</span>= <span class=\"keyword\">__DIR__</span> . <span class=\"string\">&#x27;/..&#x27;</span>.<span class=\"variable\">$_SERVER</span>[<span class=\"string\">&quot;PHP_SELF&quot;</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span>(<span class=\"title function_ invoke__\">file_exists</span>(<span class=\"variable\">$file</span>))</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">   <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">else</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">require_once</span> <span class=\"keyword\">__DIR__</span> . <span class=\"string\">&#x27;/../index.php&#x27;</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">#echo $_SERVER[&quot;PHP_SELF&quot;];</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"自定义主题\"><a href=\"#自定义主题\" class=\"headerlink\" title=\"自定义主题\"></a>自定义主题</h3><p>到 Typecho 官网下载自己喜欢的主题解压放到<code>bulid/usr/themes/</code>目录下即可(本文只提供部署教程，则使用默认主题)<br><img src=\"/img/Vercel-Typecho/2.png\" alt=\"themes\"></p>\n<h3 id=\"准备数据库\"><a href=\"#准备数据库\" class=\"headerlink\" title=\"准备数据库\"></a>准备数据库</h3><blockquote>\n<p>GearHost 数据库现已不可用<br>目前推荐: (我没用过)</p>\n<ol>\n<li><a href=\"https://freedb.tech/\">FreeDB</a></li>\n<li><a href=\"https://www.elephantsql.com/\">ElephantSQL</a></li>\n</ol>\n</blockquote>\n<p>数据库渠道有很多，你可以选择花钱买数据库，也可以白嫖(当然你不怕你文章丢失的话(白嫖有风险))<br>我这里推荐一个平台，算是比较稳的，这个平台我用了差不多快一年了吧，记不太清了，但是速度不是很快、而且存储只有 5MB，我 hexo 博客文章有 70+文章，目前占用 400+kb，5MB 因该够写好几百篇的文章了<br><del>GearHost: <a href=\"https://www.gearhost.com/\">GearHost</a></del><br>具体注册就不多说了(需要科学上网，大陆 IP 会被拦截)<br>这个平台支持 PHP 程序，可以直接部署 Typecho，而且还提供数据库，且数据库支持非本平台连接，我觉得速度不行</p>\n<p><img src=\"/img/Vercel-Typecho/3.png\" alt=\"DataBase\"><br><img src=\"/img/Vercel-Typecho/4.png\" alt=\"DataBase\"><br><img src=\"/img/Vercel-Typecho/5.png\" alt=\"DataBase\"></p>\n<h3 id=\"部署\"><a href=\"#部署\" class=\"headerlink\" title=\"部署\"></a>部署</h3><p>上个步骤已经获取了数据库，将数据库信息填入<code>bulid/confi.inc.php</code></p>\n<p>最后克隆已经创建好的 Github 仓库: <a href=\"https://github.com/lete114/Vercel-Typecho\">https://github.com/lete114/Vercel-Typecho</a><br>克隆后得到<code>Vercel-Typecho</code>目录，且里面包含<code>.git</code>，将<code>bulid</code>里的全部文件及文件夹复制到<code>Vercel-Typecho</code>目录下</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 添加所有文件到暂存区</span></span><br><span class=\"line\">git add .</span><br><span class=\"line\"><span class=\"comment\"># 提交</span></span><br><span class=\"line\">git commit -m<span class=\"string\">&#x27;Vercel-Deploy-Typecho&#x27;</span></span><br><span class=\"line\"><span class=\"comment\"># 推送到远程仓库</span></span><br><span class=\"line\">git push</span><br></pre></td></tr></table></figure>\n\n<p>创建 Vercel 项目：Vercel-Typecho(该昵称可以不与 GitHub 仓库同名)</p>\n<p><img src=\"/img/Vercel-Typecho/6.png\" alt=\"Vercel-Typecho\"><br><img src=\"/img/Vercel-Typecho/7.png\" alt=\"Vercel-Typecho\"><br><img src=\"/img/Vercel-Typecho/8.png\" alt=\"Vercel-Typecho\"><br><img src=\"/img/Vercel-Typecho/9.png\" alt=\"Vercel-Typecho\"><br><img src=\"/img/Vercel-Typecho/10.png\" alt=\"Vercel-Typecho\"></p>\n<p>最后自己绑定域名，或者自己自定义域名，打开链接<br><img src=\"/img/Vercel-Typecho/11.png\" alt=\"Vercel-Typecho\"><br><img src=\"/img/Vercel-Typecho/12.png\" alt=\"Vercel-Typecho\"><br><img src=\"/img/Vercel-Typecho/13.png\" alt=\"Vercel-Typecho\"><br><img src=\"/img/Vercel-Typecho/14.png\" alt=\"Vercel-Typecho\"><br><img src=\"/img/Vercel-Typecho/15.png\" alt=\"Vercel-Typecho\"></p>\n<h3 id=\"常见问题\"><a href=\"#常见问题\" class=\"headerlink\" title=\"常见问题\"></a>常见问题</h3><ol>\n<li>在使用官方下载的 1.1 正式版部署时后进行安装会出现如下警告<br>此问题博主也不知道如何解决，如果你已解决可以在评论区留言，我会将留言添加到此处<br><img src=\"/img/Vercel-Typecho/config-init-error.png\" alt=\"config-init-error\"></li>\n<li>(目前已解决，可能与<code>config.inc.php</code>文件的配置有关，先已添加注释，这也可能是我的个人原因)进入后台样式缺失，要求使用 https 请求，可在安装的时候填写的的确是 https，它为什么会出现该问题，可能是程序的原因，有或者其他原因我也不清楚，如果有人已解决可在评论区留言，我会将留言添加到此处<br><img src=\"/img/Vercel-Typecho/16.png\" alt=\"Vercel-Typecho\"></li>\n</ol>\n",
            "tags": [
                "Vercel",
                "Typecho",
                "Blog"
            ]
        }
    ]
}