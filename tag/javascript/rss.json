{
    "version": "https://jsonfeed.org/version/1",
    "title": "Leteä¹ç‰¹ 's Blog â€¢ All posts by \"javascript\" tag",
    "description": "æˆ‘ç›¸ä¿¡æˆ‘å¯ä»¥ï¼Œä½†æˆ‘ä¸€ç›´åœ¨è·¯ä¸Šï¼Œæ‰€ä»¥æˆ‘æœ‰æ— é™çš„å¯èƒ½ï¼ï¼",
    "home_page_url": "https://blog.imlete.cn",
    "items": [
        {
            "id": "https://blog.imlete.cn/article/Virtual-DOM-slower-real-DOM.html",
            "url": "https://blog.imlete.cn/article/Virtual-DOM-slower-real-DOM.html",
            "title": "è™šæ‹Ÿ DOM æ¯”çœŸ DOM çƒ‚",
            "date_published": "2023-10-17T20:00:29.000Z",
            "content_html": "<h2 id=\"å‰è¨€\"><a href=\"#å‰è¨€\" class=\"headerlink\" title=\"å‰è¨€\"></a>å‰è¨€</h2><p>åœ¨å¼€å§‹ä¹‹å‰ï¼Œè¯´æ˜ä¸€ä¸‹ä¸ºä»€ä¹ˆå†™è¿™ç¯‡æ–‡ç« å§ã€‚è™šæ‹Ÿ DOMï¼ˆæœ¬æ–‡åé¢ç»Ÿä¸€ <code>vDOM</code>ï¼‰ï¼Œè¿™ä¸ªè¯ç»å¸¸åœ¨é¢è¯•ã€ç¤¾åŒºæ–‡ç« ä¸­å‡ºç°ï¼Œéƒ½åœ¨è¯´ vDOM å¿«ã€è‡³äºå¿«åœ¨å“ªé‡Œä¹Ÿæ²¡ä¸ªäººèƒ½è¯´çš„æ¸…æ¥šï¼ˆå½“ç„¶ï¼Œæˆ‘ä¹Ÿä¸ä¸€å®šæ˜¯å¯¹çš„ï¼Œä¸»è¦æ˜¯åˆ†äº«è‡ªå·±å¯¹ vDOM å’Œ DOM çš„çœ‹æ³•ï¼‰ï¼Œä»ç½‘ä¸Šçœ‹åˆ°çš„èµ„æ–™æˆ‘èƒ½äº†è§£åˆ°çš„å°±æ˜¯ä½¿ç”¨ JavaScript çš„æ™®é€šå¯¹è±¡<code>æŠ½è±¡</code>å‡ºä¸€ä¸ª vDOM æ ‘ï¼Œå½“æ•°æ®å˜åŒ–çš„æ—¶å€™é‡æ–°ç”Ÿæˆ vDOM æ ‘ï¼Œå†é€šè¿‡ <code>diif</code> ç®—æ³•æ¯”è¾ƒ<code>æ–°</code> vDOM å’Œ<code>æ—§</code>çš„ vDOM å¯¹æ¯”ï¼Œçœ‹çœ‹æ˜¯å“ªå—çš„æ•°æ®å˜åŠ¨äº†ï¼Œæœ€åå°†å˜åŠ¨çš„åœ°æ–¹<code>æ˜ å°„</code>åˆ° DOM ä¸Šï¼Œä»è€Œå®Œæˆé¡µé¢æ•°æ®çš„å±•ç¤ºã€‚é‚£ä¹ˆé—®é¢˜å°±æ¥äº†ï¼Œæ—¢ç„¶æœ€åéƒ½è¦ä¿®æ”¹ DOM ä¸ºä»€ä¹ˆè¿˜è¦å¼„å‡ºä¸€ä¸ª vDOM å‘¢ï¼Ÿåƒé¥±äº†æ²¡äº‹å¹²ï¼Ÿè¿˜éå†å¯¹æ¯”æ–°æ—§ vDOM çš„å·®å¼‚ï¼Œé¥¶äº†ä¸€åœˆä¸è¿˜æ˜¯è¦æ”¹ DOM å—ï¼Ÿæˆ‘é™·å…¥äº†æ²‰æ€â€¦..</p>\n<h2 id=\"æ­£æ–‡\"><a href=\"#æ­£æ–‡\" class=\"headerlink\" title=\"æ­£æ–‡\"></a>æ­£æ–‡</h2><p>ä»€ä¹ˆæ˜¯ vDOM æˆ‘å°±ä¸å¤šè¯´äº†ï¼ŒåŸºäº<code>å‰è¨€</code>æœ€åä¸€å¥è¯çš„æ€è€ƒï¼Œæˆ‘æ›´æƒ³äº†è§£ vDOM å®ƒç©¶ç«Ÿå¸¦æ¥ä»€ä¹ˆä¼˜ç‚¹ï¼Œå‰ç«¯å·¨å¤´ Vueã€React éƒ½åœ¨ç”¨ï¼Œè¿™ç©¶ç«Ÿæ˜¯ä¸ºä»€ä¹ˆï¼Ÿï¼Ÿ</p>\n<p>äºæ˜¯æˆ‘æ‰“å¼€äº† Vue çš„å®˜ç½‘ <a href=\"https://web.archive.org/web/20231017125349/https://cn.vuejs.org/guide/extras/rendering-mechanism\">Virtual DOM</a>ï¼Œå¹¶æœªåœ¨æ–‡æ¡£é•¿çœ‹åˆ°æœ‰ä»»ä½•åœ°æ–¹æè¿° vDOM æ•ˆç‡é«˜ã€é€Ÿåº¦å¿«ã€å†…å­˜å ç”¨ä½ã€‚</p>\n<p>å†æ¥çœ‹çœ‹ React å®˜ç½‘ <a href=\"https://web.archive.org/web/20231017131640/https://zh-hans.legacy.reactjs.org/docs/faq-internals.html\">Virtual DOM - ä¸­æ–‡</a> <a href=\"https://web.archive.org/web/20231017131401/https://legacy.reactjs.org/docs/faq-internals.html\">Virtual DOM - è‹±è¯­</a>ï¼Œå’Œ Vue ä¸€æ ·ï¼Œå¹¶æœªæèµ· vDOM æ•ˆç‡é«˜ã€é€Ÿåº¦å¿«ã€å†…å­˜å ç”¨ä½ç­‰å­—çœ¼ã€‚å…¶ä¸­æœ‰ä¸€å¥è¯ï¼šåœ¨ React çš„ä¸–ç•Œé‡Œï¼Œæœ¯è¯­ â€œVirtual DOMâ€ é€šå¸¸ä¸ React å…ƒç´ å…³è”åœ¨ä¸€èµ·ï¼Œå› ä¸ºå®ƒä»¬éƒ½æ˜¯ä»£è¡¨äº†<code>ç”¨æˆ·ç•Œé¢çš„å¯¹è±¡</code>ã€‚</p>\n<p>å› æ­¤ vDOM å¹¶ä¸æ˜¯åœ¨æé«˜æ•ˆç‡ï¼Œè€Œæ˜¯åœ¨æ¶ˆè€—æ•ˆç‡ã€‚ä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´ï¼Ÿå› ä¸ºåŒæ ·æ˜¯å‰ç«¯æ¡†æ¶ï¼Œåèµ·ä¹‹ç§€ <a href=\"https://svelte.dev\">Svelte.js</a> å’Œ <a href=\"https://www.solidjs.com\">Solid.js</a> éƒ½æ²¡æœ‰ä½¿ç”¨ vDOM åè€Œæ•ˆç‡è¿˜åŠæ‰“ Vue.js å’Œ React.js ï¼Œæ•ˆç‡ç”šè‡³ç›´é€¼ Vanilla.js (åŸç”Ÿ JS)</p>\n<h3 id=\"ä¸ºä»€ä¹ˆéœ€è¦è™šæ‹Ÿ-DOM\"><a href=\"#ä¸ºä»€ä¹ˆéœ€è¦è™šæ‹Ÿ-DOM\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆéœ€è¦è™šæ‹Ÿ DOM\"></a>ä¸ºä»€ä¹ˆéœ€è¦è™šæ‹Ÿ DOM</h3><p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œä¸ºä»€ä¹ˆéœ€è¦ vDOMï¼ŒvDOM æ•ˆç‡ä¸æ˜¯æ¯” DOM ä½å—ï¼Ÿä¸ºä»€ä¹ˆè¿˜è¦ç”¨ï¼Ÿæ•´é‚£ä¹ˆå¤šåˆ¤æ–­å’Œæ•°æ®å¯¹æ¯”ï¼Œæœ€åä¸è¿˜æ˜¯è¦æ”¹ DOM å—ï¼Ÿä¸ºä»€ä¹ˆä¸ç›´æ¥æ”¹ DOMï¼Ÿ</p>\n<p>æˆ‘ä»¬å…ˆæƒ³æƒ³ vDOM ç©¶ç«Ÿå¸¦æ¥äº†ä»€ä¹ˆä¼˜åŠ¿ã€‚</p>\n<ol>\n<li><p>è·¨å¹³å°ï¼šå€ŸåŠ©ä¸€äº›å·¥å…·å¯ä»¥å°† vDOM <code>è½¬æ¢</code>æˆå¯¹åº”å¹³å°å¯ä»¥è®¤è¯†çš„ä¸œè¥¿<br>ä¾‹å¦‚åœ¨æµè§ˆå™¨ä¸­ react å°±éœ€è¦ react-dom è¿™ä¸ªåº“åœ¨å®ç°å°† vDOM è½¬æ¢æˆçœŸå® DOMã€‚<br>è¿˜æœ‰ react-native å°† vDOM è½¬æ¢æˆ <code>Android</code> å’Œ <code>iOS</code> å¹³å°å¯ä»¥ä½¿ç”¨çš„ç”¨æˆ·ç•Œé¢ã€‚<br><br>å†ä¸¾ä¸ª ğŸŒ°ï¼Œå›½å†… uniApp å¾ˆå¤šå‰ç«¯å¼€å‘å¤šå¤šå°‘å°‘éƒ½å¬è¿‡å§ï¼Ÿåšå°ç¨‹åºï¼Œæˆ– APP çš„ï¼Œå®ƒä½¿ç”¨ Vue vDOM è½¬æ¢æˆå¯¹åº”å¹³å°ã€iOSã€Androidã€å°ç¨‹åº(å¾®ä¿¡/æ”¯ä»˜å®/ç™¾åº¦/å¤´æ¡/é£ä¹¦/QQ/å¿«æ‰‹/é’‰é’‰/æ·˜å®)</p>\n</li>\n<li><p>ç®€å•æ–¹ä¾¿: èƒ½è®©ä½ è½»æ¾çš„æ“ä½œ DOMï¼Œä¹Ÿä¸ç”¨ä½ å»ç»´æŠ¤ DOM çš„çŠ¶æ€ã€‚<br>ä¸åƒæµè§ˆå™¨ä¸­çš„ DOM æ¯æ¬¡éƒ½è¦ document.querySelectorï¼Œç”šè‡³è¿˜è¦åˆ¤æ–­è·å–çš„è¿™ä¸ªçœŸå® DOM åˆ°åº•å­˜ä¸å­˜åœ¨ï¼Œè¿™æ ·å†™ä»£ç å°±éå¸¸çš„æ¶å¿ƒ</p>\n</li>\n<li><p>æ€§èƒ½æå‡: ä¸æ˜¯è¯´ vDOM æ€§èƒ½æ¯”ä¸ä¸Š DOM å—ï¼Ÿä¸ºä»€ä¹ˆè¿˜è¯´å®ƒæ€§èƒ½æå‡ï¼Ÿ<br>åœ¨æŸäº›æƒ…å†µä¸‹ï¼ŒvDOM æ€§èƒ½ç¡®å®æ˜¯è¦æ¯” DOM æ€§èƒ½å¥½ï¼Œå¦‚æœæœ‰ 1000 ä¸ª DOM èŠ‚ç‚¹ï¼ˆä¸¾ä¾‹ ul&gt;liï¼‰ï¼Œè¿™æ˜¯åç«¯è¿”å›çš„æ•°æ®ï¼Œéœ€è¦æ¸²æŸ“åˆ°é¡µé¢ä¸Šï¼ˆä¸€èˆ¬äººè°æ²¡äº‹åç«¯è¿”å›ä½ é‚£ä¹ˆå¤šæ•°æ®å¹²å˜›ï¼Œæ›´ä½•å†µä½ ä¹Ÿä¸èƒ½ä¸€æ¬¡æ€§æ¸²æŸ“é‚£ä¹ˆå¤šæ•°æ®å•Šï¼Œç”¨æˆ·åˆçœ‹ä¸åˆ°é‚£ä¹ˆå¤šï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯åšåˆ†é¡µå¤„ç†ï¼‰ï¼Œå‡å¦‚æœ‰æŸç§ä¸šåŠ¡éœ€æ±‚ï¼Œä¿®æ”¹äº† 100 ä¸ª li æ¥ä¸‹æ¥çœ‹çœ‹ vDOM å’Œ DOM æ˜¯æ€ä¹ˆè¿è¡Œçš„å§<br><br>vDOM ç”Ÿæˆä¸€ä¸ªæ–°çš„ vDOM è·Ÿæ—§çš„ vDOM å¯¹æ¯”ï¼Œå‘ç°æœ‰ 100 ä¸ª li æ•°æ®å‘ç”Ÿäº†å˜åŒ–ï¼Œè¿™æ—¶ vDOM å¼€å§‹ä¿®æ”¹ DOM ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­åªè§¦å‘ä¸€æ¬¡ DOM ä¿®æ”¹<br><br>DOM å¯èƒ½ä¹Ÿä¼šå’Œ vDOM ä¸€æ ·æœ€ååªè§¦å‘ä¸€æ¬¡ DOM ä¿®æ”¹ï¼Œä¹Ÿå¯èƒ½è§¦å‘ 100 æ¬¡å·¦å³çš„ DOM ä¿®æ”¹ï¼Œå…·ä½“çœ‹ä»£ç æ˜¯æ€ä¹ˆå®ç°</p>\n</li>\n</ol>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">!(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> ul = <span class=\"variable language_\">document</span>.<span class=\"title function_\">querySelector</span>(<span class=\"string\">&#x27;ul&#x27;</span>)</span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">100</span>; i++) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> li = <span class=\"variable language_\">document</span>.<span class=\"title function_\">createElement</span>(<span class=\"string\">&#x27;li&#x27;</span>)</span><br><span class=\"line\">    li.<span class=\"property\">textContent</span> = i</span><br><span class=\"line\">    <span class=\"comment\">// å…³é”®ç‚¹</span></span><br><span class=\"line\">    <span class=\"comment\">// æ¯æ¬¡ç»™ ul çš„å­å…ƒç´ éƒ½æ·»åŠ ä¸€ä¸ª liï¼Œå°±æ’ç‰ˆä¸€æ¬¡ï¼Œ100æ¬¡å¾ªç¯ç»“æŸåæ’ç‰ˆäº†100æ¬¡ï¼Œä¹Ÿç»˜åˆ¶æ¸²æŸ“äº†100æ¬¡</span></span><br><span class=\"line\">    <span class=\"comment\">// ä¸çŸ¥é“æˆ‘è¿™æ ·è¯´æ˜¯ä¸æ˜¯å¯¹çš„ï¼Œå› ä¸ºæˆ‘å¯¹æµè§ˆå™¨æ¸²æŸ“åŸç†ä¹Ÿä¸æ˜¯å¾ˆäº†è§£ã€‚é‡æ’ã€é‡ç»˜</span></span><br><span class=\"line\">    ul.<span class=\"title function_\">appendChild</span>(li)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;)()</span><br><span class=\"line\"></span><br><span class=\"line\">!(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> ul = <span class=\"variable language_\">document</span>.<span class=\"title function_\">querySelector</span>(<span class=\"string\">&#x27;ul&#x27;</span>)</span><br><span class=\"line\">  <span class=\"keyword\">const</span> fragment = <span class=\"variable language_\">document</span>.<span class=\"title function_\">createDocumentFragment</span>()</span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">100</span>; i++) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> li = <span class=\"variable language_\">document</span>.<span class=\"title function_\">createElement</span>(<span class=\"string\">&#x27;li&#x27;</span>)</span><br><span class=\"line\">    li.<span class=\"property\">textContent</span> = i</span><br><span class=\"line\">    <span class=\"comment\">// å…³é”®ç‚¹</span></span><br><span class=\"line\">    <span class=\"comment\">// æ¯æ¬¡ç»™æ–‡æ¡£ç¢ç‰‡é‡Œæ·»åŠ ä¸€ä¸ª li è¿™åªæ˜¯åœ¨å†…å­˜ä¸­ï¼Œå¹¶æ²¡æœ‰æ·»åŠ åˆ°é¡µé¢ä¸Šï¼Œæ‰€ä»¥é¡µé¢å¹¶ä¼šä¸ä¼šå‘ç”Ÿä»€ä¹ˆå˜åŒ–</span></span><br><span class=\"line\">    fragment.<span class=\"title function_\">appendChild</span>(li)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"comment\">// ç›´åˆ°å¾ªç¯å®Œæ¯•åï¼Œå°†æ–‡æ¡£ç¢ç‰‡é‡Œçš„æ‰€æœ‰ li ä¸€æ¬¡æ€§æ·»åŠ åˆ° ul é‡Œï¼Œæ­¤æ—¶é¡µé¢åªè§¦å‘ä¸€æ¬¡é‡æ’ã€é‡ç»˜</span></span><br><span class=\"line\">  ul.<span class=\"title function_\">appendChild</span>(fragment)</span><br><span class=\"line\">&#125;)()</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h3><p>æœ¬æ–‡ä»…ä»…æ˜¯ä¹ç‰¹å¯¹ vDOM çš„ç†è§£å’Œæ„Ÿæ‚Ÿï¼Œå¹¶æœªçœŸæ­£çš„å»ç¿»çœ‹æ–‡ä¸­æåˆ°çš„æ¡†æ¶æºç ï¼Œæ‰€ä»¥æˆ‘å¸Œæœ›å¤§å®¶çœ‹å®Œè¿™ç¯‡æ–‡ç« åèƒ½å¤Ÿæœ‰ä¸€äº›è‡ªå·±çš„çœ‹æ³•å’Œç†è§£ï¼Œå¹¶è‡ªå·±è¡ŒåŠ¨å»å¯»æ‰¾è‡ªå·±çš„ç­”æ¡ˆï¼Œè€Œä¸æ˜¯åœ¨ç½‘ä¸Šçœ‹åˆ°åˆ«äººå†™çš„æ–‡ç« å°±çœŸçš„ä»¥ä¸ºåˆ«äººè¯´çš„å°±æ˜¯å¯¹çš„ï¼Œä»è€Œä¸§å¤±è‡ªå·±çš„åˆ¤æ–­é‡Œã€‚å°±åƒç½‘ä¸Šå‘çš„çŸ­è§†é¢‘ï¼ŒæœªçŸ¥äº‹æƒ…çœŸä¼ªï¼Œä»…ä»…æ˜¯çœ‹åˆ°äº†åˆ«äººè£å‰ªè§†é¢‘çš„ä¸€å°éƒ¨åˆ†ï¼Œå°±åœ¨è¯„è®ºåŒºè·Ÿé£</p>\n<p>æ€»ç»“(è¿™æ‰æ˜¯çœŸæ­£çš„æ€»ç»“)ï¼ŒvDOM å¹¶æ²¡æœ‰æé«˜æ•ˆç‡ï¼Œåè€Œæ˜¯åœ¨é™ä½æ•ˆç‡ï¼Œç»§ç»­ä¸Šé¢æ‰€è¯´çš„ 1000 ä¸ª DOM èŠ‚ç‚¹ï¼Œå¦‚æœæˆ‘åªä¿®æ”¹äº† 1 ä¸ª li å‘¢ï¼ŸvDOM è¿˜æ˜¯ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„ vDOM å’Œæ—§çš„ vDOM å¯¹æ¯”ï¼Œç™½ç™½è·‘äº† 1000 æ¬¡</p>\n<p>å¦‚æœæœ‰å“ªå†™çš„ä¸å¯¹çš„ï¼Œè¿˜è¯·å„ä½å¤§ä½¬æŒ‡å‡º ğŸ˜ğŸ˜</p>\n",
            "tags": [
                "JavaScript"
            ]
        },
        {
            "id": "https://blog.imlete.cn/article/nonuse-es6+-implements-call-apply-bind.html",
            "url": "https://blog.imlete.cn/article/nonuse-es6+-implements-call-apply-bind.html",
            "title": "ä¸ä½¿ç”¨ ES6+ å®ç° call apply bind æ–¹æ³•",
            "date_published": "2022-11-04T15:24:31.000Z",
            "content_html": "<p>ä½¿ç”¨ ES6+ å®ç°è¿™ä¸‰ä¸ªæ–¹æ³•å…¶å®éå¸¸ç®€å•ï¼Œæœ¬æ–‡å°±æ¥æŒ‘æˆ˜ä¸€ä¸‹ï¼Œå¦‚æœä¸é€‚ç”¨ ES6+ çš„æƒ…å†µä¸‹å¦‚ä½•å®ç°è¿™ä¸‰ä¸ªæ–¹æ³•</p>\n<blockquote>\n<p>éš¾ç‚¹: ä¸èƒ½ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦(â€¦)è¯¥å¦‚ä½•æ¥æ”¶å‚æ•°å’Œä¼ å…¥å‚æ•°</p>\n</blockquote>\n<p>è‡³äºè¿™ä¸‰ä¸ªæ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«å¯ä»¥é˜…è¯»æˆ‘ä¹‹å‰çš„è¿™ç¯‡æ–‡ç«  <a href=\"/article/call-apply-bind-distinction.html\">call()-apply()-bind()æ–¹æ³•æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ</a></p>\n<h2 id=\"apply\"><a href=\"#apply\" class=\"headerlink\" title=\"apply\"></a>apply</h2><p>å°±ä¸å¤šè¯´åºŸè¯äº†ï¼Œç›´æ¥çœ‹ä»£ç </p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title class_\">Function</span>.<span class=\"property\"><span class=\"keyword\">prototype</span></span>.<span class=\"property\">myApply</span> = <span class=\"keyword\">function</span> (<span class=\"params\">_this, args</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">    _this = _this || <span class=\"variable language_\">window</span></span><br><span class=\"line\">    _this[<span class=\"string\">&#x27;#function#&#x27;</span>] = <span class=\"variable language_\">this</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (!args) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> _this[<span class=\"string\">&#x27;#function#&#x27;</span>]()</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">var</span> params = <span class=\"title class_\">JSON</span>.<span class=\"title function_\">stringify</span>(args)</span><br><span class=\"line\">      <span class=\"comment\">// å½“ JSON.stringify æŠŠä¸€ä¸ªæ•°ç»„è§£ææˆå­—ç¬¦ä¸²æ˜¯ä¼šå¤šå¥—ä¸€å±‚ â€˜[]â€™ ï¼Œæ‰€ä»¥éœ€è¦è£åˆ‡æ‰</span></span><br><span class=\"line\">      params = params.<span class=\"title function_\">slice</span>(<span class=\"number\">1</span>, params.<span class=\"property\">length</span> - <span class=\"number\">1</span>)</span><br><span class=\"line\">      <span class=\"comment\">// ç”±äº Function æ— æ³•è®¿é—®ä¸Šçº§ä½œç”¨åŸŸï¼Œç”±äºä¸Šå±‚ä»¥åŠè£æ‰äº†é¦–å°¾éƒ¨åˆ†</span></span><br><span class=\"line\">      <span class=\"comment\">// æ‰€ä»¥å¾—åˆ° _this[&quot;#function#&quot;](1,2) è¿™æ ·å°±èƒ½å®ç°æ‰©å±•è¿ç®—ç¬¦(...)çš„æ“ä½œäº†ï¼Œå…³äº new Function è¯·è‡ªè¡ŒæŸ¥é˜…</span></span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Function</span>(<span class=\"string\">&#x27;_this&#x27;</span>, <span class=\"string\">&#x27;return _this[&quot;#function#&quot;](&#x27;</span> + params + <span class=\"string\">&#x27;)&#x27;</span>)(_this)</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"comment\">// ------ ä¸Šé¢è¿™å¨ä½ ä¹Ÿå¯ä»¥æ”¹ä¸º eval() ------</span></span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"keyword\">var</span> params = []</span><br><span class=\"line\">      <span class=\"comment\">// æ³¨æ„ï¼Œè¿™é‡Œçš„ i åˆå§‹å€¼æ˜¯ 1 ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†å»é™¤ç¬¬ä¸€ä¸ªå‚æ•°(ä¹Ÿå°±æ˜¯ _this)</span></span><br><span class=\"line\">      <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">1</span>; i &lt; <span class=\"variable language_\">arguments</span>.<span class=\"property\">length</span>; i++) &#123;</span><br><span class=\"line\">        params.<span class=\"title function_\">push</span>(<span class=\"string\">&#x27;arguments[&#x27;</span> + i + <span class=\"string\">&#x27;]&#x27;</span>)</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      <span class=\"comment\">// è¿™é‡Œè§£é‡Šä¸€ä¸‹ï¼Œå½“å¼•ç”¨ç±»å‹ä¸å­—ç¬¦ä¸²æ‹¼æ¥çš„æ—¶å€™ä¼šéšå¼è°ƒç”¨ toString() ï¼Œæ•°ç»„è°ƒç”¨ toString() ä¼šè¿”å›å¦‚ä¸‹ç»“æœ</span></span><br><span class=\"line\">      <span class=\"comment\">// _this[&quot;#function#&quot;](arguments[1],arguments[2],arguments[3])</span></span><br><span class=\"line\">      <span class=\"comment\">// eval æ‰§è¡Œåå¯ä»¥è®¿é—®ä¸Šçº§ä½œç”¨åŸŸçš„å˜é‡ï¼Œè¿™é‡Œå°±å¯ä»¥å®ç°æ‰©å±•è¿ç®—ç¬¦(...)çš„æ“ä½œäº†</span></span><br><span class=\"line\">      <span class=\"keyword\">return</span> <span class=\"built_in\">eval</span>(<span class=\"string\">&#x27;_this[&quot;#function#&quot;](&#x27;</span> + params + <span class=\"string\">&#x27;)&#x27;</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">delete</span> _this[<span class=\"string\">&#x27;#function#&#x27;</span>]</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"call\"><a href=\"#call\" class=\"headerlink\" title=\"call\"></a>call</h2><p>ç”±äºå‰é¢ä»¥åŠå®ç°äº† <code>myApply</code> æ–¹æ³•ï¼Œå† <code>myCall</code> å³å¯ç›´æ¥è°ƒç”¨ï¼Œå¦‚æœè¦å®Œæ•´å†™ä¸€ä¸ª <code>myCall</code> ä¹Ÿåªæ˜¯å¢åŠ ä»£ç å†—ä½™è€Œå·²</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title class_\">Function</span>.<span class=\"property\"><span class=\"keyword\">prototype</span></span>.<span class=\"property\">myCall</span> = <span class=\"keyword\">function</span> (<span class=\"params\">_this</span>) &#123;</span><br><span class=\"line\">  _this = _this || <span class=\"variable language_\">window</span></span><br><span class=\"line\">  <span class=\"keyword\">var</span> params = []</span><br><span class=\"line\">  <span class=\"comment\">// æ³¨æ„ï¼Œè¿™é‡Œçš„ i åˆå§‹å€¼æ˜¯ 1 ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†å»é™¤ç¬¬ä¸€ä¸ªå‚æ•°(ä¹Ÿå°±æ˜¯ _this)</span></span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">1</span>; i &lt; <span class=\"variable language_\">arguments</span>.<span class=\"property\">length</span>; i++) &#123;</span><br><span class=\"line\">    params.<span class=\"title function_\">push</span>(<span class=\"variable language_\">arguments</span>[i])</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"variable language_\">this</span>.<span class=\"title function_\">myApply</span>(_this, params)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"bind\"><a href=\"#bind\" class=\"headerlink\" title=\"bind\"></a>bind</h2><p>å¦‚ä¸Šï¼Œå¯ä»¥ç»§ç»­å¤ç”¨å·²ç»å°è£…å¥½çš„</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title class_\">Function</span>.<span class=\"property\"><span class=\"keyword\">prototype</span></span>.<span class=\"property\">myBind</span> = <span class=\"keyword\">function</span> (<span class=\"params\">_this</span>) &#123;</span><br><span class=\"line\">  _this = _this || <span class=\"variable language_\">window</span></span><br><span class=\"line\">  <span class=\"keyword\">var</span> self = <span class=\"variable language_\">this</span></span><br><span class=\"line\">  <span class=\"keyword\">var</span> params = []</span><br><span class=\"line\">  <span class=\"comment\">// æ³¨æ„ï¼Œè¿™é‡Œçš„ i åˆå§‹å€¼æ˜¯ 1 ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†å»é™¤ç¬¬ä¸€ä¸ªå‚æ•°(ä¹Ÿå°±æ˜¯ _this)</span></span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">1</span>; i &lt; <span class=\"variable language_\">arguments</span>.<span class=\"property\">length</span>; i++) &#123;</span><br><span class=\"line\">    params.<span class=\"title function_\">push</span>(<span class=\"variable language_\">arguments</span>[i])</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// æ³¨æ„è¿™é‡Œçš„ i åˆå§‹å€¼æ˜¯ 0 ,å› ä¸ºå®ƒä¸éœ€è¦ç§»é™¤ _this ï¼Œå¯èƒ½è¿™æœ‰ç‚¹ä¹±ï¼Œå¸Œæœ›è¯»è€…å¤šå¤šæ€è€ƒ</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"variable language_\">arguments</span>.<span class=\"property\">length</span>; i++) &#123;</span><br><span class=\"line\">      params.<span class=\"title function_\">push</span>(<span class=\"variable language_\">arguments</span>[i])</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> self.<span class=\"title function_\">myApply</span>(_this, params)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h2><p>ä»¥ä¸Šå°±æ˜¯æœ¬æ–‡çš„å…¨éƒ¨å†…å®¹ï¼Œå¯èƒ½ä¼šå­˜åœ¨ä¸€äº›å°ç‘•ç–µï¼Œå¸Œæœ›å„ä½è¯»è€…ç•™è¨€è¯„è®ºæˆ–ä¼˜åŒ–</p>\n",
            "tags": [
                "è®°å½•",
                "JavaScript"
            ]
        },
        {
            "id": "https://blog.imlete.cn/article/webpack-on-demand-loading-principle.html",
            "url": "https://blog.imlete.cn/article/webpack-on-demand-loading-principle.html",
            "title": "webpack æŒ‰éœ€åŠ è½½åŸç†",
            "date_published": "2022-10-15T10:45:51.000Z",
            "content_html": "<blockquote>\n<p>æœ¬æ–‡ä¸ä¼šå¸¦ä½ å»é˜…è¯» <code>build</code> åçš„æºç ï¼Œè€Œæ˜¯å‘Šè¯‰ä½ å®ƒæ˜¯æ€ä¹ˆåšåˆ°çš„ï¼ŒåŸç†æ˜¯ä»€ä¹ˆï¼Œæ€ä¹ˆå®ç°ï¼Œå¦‚ä½•è‡ªå·±åŠ¨æ‰‹åšä¸€ä¸ªæŒ‰éœ€åŠ è½½æ¨¡å—ï¼Œå¦‚æœä¸æƒ³å¬æœ¬æ–‡ BBï¼Œå¯ç›´æ¥ä¸€æ­¥åˆ°é¡µè„šï¼Œè·å–å®Œæ•´ä»£ç  <a href=\"#å®Œæ•´çš„æŒ‰éœ€åŠ è½½ä»£ç \">#å®Œæ•´çš„æŒ‰éœ€åŠ è½½ä»£ç </a></p>\n</blockquote>\n<h2 id=\"å‡†å¤‡\"><a href=\"#å‡†å¤‡\" class=\"headerlink\" title=\"å‡†å¤‡\"></a>å‡†å¤‡</h2><p>å¦‚æœä½ æƒ³é˜…è¯»æºç ï¼Œä½ å¯ä»¥æ ¹æ®ä¸‹é¢çš„ç»“æ„å»åˆ›å»ºï¼Œç„¶åè‡ªå·±æ‰“åŒ…é˜…è¯»æºç </p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// webpack.config.js</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> path = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;path&#x27;</span>)</span><br><span class=\"line\"><span class=\"keyword\">const</span> mode = <span class=\"string\">&#x27;production&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123;</span><br><span class=\"line\">  mode,</span><br><span class=\"line\">  <span class=\"attr\">entry</span>: <span class=\"string\">&#x27;./src/index.js&#x27;</span>,</span><br><span class=\"line\">  <span class=\"attr\">output</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">path</span>: path.<span class=\"title function_\">join</span>(__dirname, <span class=\"string\">&#x27;dist&#x27;</span>),</span><br><span class=\"line\">    <span class=\"attr\">filename</span>: <span class=\"string\">&#x27;main.js&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">chunkFilename</span>: <span class=\"string\">&#x27;[name].js&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">libraryTarget</span>: <span class=\"string\">&#x27;umd&#x27;</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">optimization</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">minimize</span>: <span class=\"literal\">false</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// src/test.js</span></span><br><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = <span class=\"string\">&#x27;test&#x27;</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// src/index.js</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// å½“è°ƒç”¨ window çš„ init æ–¹æ³•æ—¶è§¦å‘åŠ è½½ test.js ï¼ŒåŠ è½½å®Œæˆåè¾“å‡ºç»“æœ</span></span><br><span class=\"line\"><span class=\"variable language_\">window</span>.<span class=\"property\">init</span> = <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"title function_\">import</span>(<span class=\"comment\">/* webpackChunkName: &quot;test&quot; */</span> <span class=\"string\">&#x27;./test&#x27;</span>).<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">r</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(r)</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"import-å¹²äº†ä»€ä¹ˆ\"><a href=\"#import-å¹²äº†ä»€ä¹ˆ\" class=\"headerlink\" title=\"import() å¹²äº†ä»€ä¹ˆ\"></a>import() å¹²äº†ä»€ä¹ˆ</h2><p>å…¶å® webpack å°±æ˜¯æŠŠ <code>import()</code> åŠ¨æ€å¯¼å…¥çš„æ¨¡å—æ‰“åŒ…æˆäº†ä¸€ä¸ªæ–‡ä»¶ï¼Œè€Œå…¶ä¸­çš„ <code>webpackChunkName</code> æ³¨é‡Šå°±æ˜¯å®šä¹‰æ‰“åŒ…åè¿™ä¸ªåŠ¨æ€æ¨¡å—çš„ js æ–‡ä»¶ï¼Œä¸Šæ–¹æŒ‡å®šå‘½åä¸º <code>test</code>ï¼Œåˆ™æ‰“åŒ…ç»“æœä¸º <code>test.js</code>,å¦‚æœæ²¡æœ‰å†™ <code>webpackChunkName</code> é‚£ä¹ˆ webpack ä¼šè‡ªåŠ¨å®šä¹‰éšæœºçš„æ–‡ä»¶å(å½“ç„¶è¿™ä¸æ˜¯éšæœºçš„ï¼Œå®ƒæ˜¯æ ¹æ®æ–‡ä»¶ä¸­çš„å†…å®¹è¿›è¡Œ hash æ¨ç®—çš„ï¼Œåªè¦å†…å®¹æ²¡å˜ï¼Œä»–å°±ä¸€ç›´æ˜¯è¿™ä¸ªåå­—ï¼Œè¿™æ®µæ„Ÿå…´è¶£çš„å¯ä»¥è‡ªå·±å»é˜…è¯»æºç )</p>\n<h2 id=\"å¦‚ä½•è·å–-url\"><a href=\"#å¦‚ä½•è·å–-url\" class=\"headerlink\" title=\"å¦‚ä½•è·å– url\"></a>å¦‚ä½•è·å– url</h2><p>æˆ‘åœ¨æ²¡çœ‹æ‰“åŒ…ç»“æœçš„æºç æ—¶ï¼Œæˆ‘æ˜¯è¿™æ ·æƒ³çš„ï¼Œæ—¢ç„¶è¦åŠ è½½ï¼Œé‚£ä¹ˆä¸€å®šæ˜¯é€šè¿‡ <code>script</code> æ ‡ç­¾<br>å› ä¸ºå¼•å…¥æ˜¯å¤šå˜çš„ï¼Œæ¯”å¦‚é€šè¿‡æœ¬åœ°å¼•å…¥ï¼Œæˆ–æ˜¯ cdn å¼•å…¥ï¼Œåˆæˆ–è€…æ˜¯å…¶å®ƒæ–¹å¼ï¼Œè€Œ webpack å®ƒæ˜¯æ— æ³•åˆ¤æ–­å¼•å…¥æ–¹å¼çš„ï¼Œé‚£ä¹ˆè¯¥å¦‚ä½•è·å– js æ–‡ä»¶çš„ url åœ°å€å‘¢ï¼Ÿ</p>\n<p>æ‹¦æˆªè¯·æ±‚ï¼š<br>ä¸è¿‡ <code>script</code> å‘å‡ºçš„è¯·æ±‚æ˜¯æµè§ˆå™¨å‘é€çš„ï¼Œå¹¶ä¸åƒ <code>xhr</code> ä¸€æ ·å¯ä»¥åŒ…è£…ä¸€å±‚è¿›è¡Œ hook æ‹¦æˆª<br>äºæ˜¯æˆ‘åˆæƒ³åˆ°äº† <code>Service Workers</code> çš„ <code>fetch</code> äº‹ä»¶ï¼Œä¸è¿‡ webpack æ€ä¹ˆå¯èƒ½å¹²è¿™ç§äº‹ï¼Œè¿™å°±å±äºå…¥ä¾µå¼ä¿®æ”¹äº†ï¼Œä¸åˆç†</p>\n<p>æ€æ¥æƒ³å»ï¼Œæˆ‘å®åœ¨æ˜¯æƒ³ä¸åˆ°æœ‰å•¥åŠæ³•äº†ï¼Œäºæ˜¯æˆ‘å°±å»çœ‹äº†æºç ï¼Œä¸‡ä¸‡æ²¡æƒ³åˆ°å•Šï¼Œå±…ç„¶æ˜¯ç”¨ <a href=\"https://developer.mozilla.org/zh-CN/docs/Web/API/Document/currentScript\">document.currentScript</a> å±æ€§ï¼Œæˆ‘å±…ç„¶æŠŠè¿™ç»™å¿˜äº†:(</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// è·å–å½“å‰ script æ ‡ç­¾çš„ src å±æ€§</span></span><br><span class=\"line\"><span class=\"variable language_\">document</span>.<span class=\"property\">currentScript</span>.<span class=\"property\">src</span></span><br></pre></td></tr></table></figure>\n\n<p>webpack æºç é‡Œè¿˜å†™äº†ä¸€ä¸ªè·å–å½“å‰ script æ ‡ç­¾çš„ä»£ç </p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// è·å–åˆ°æ‰€æœ‰çš„ script æ ‡ç­¾</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> scripts = <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementsByTagName</span>(<span class=\"string\">&#x27;script&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\">// å¦‚æœæœ‰ï¼Œè¿™é€šè¿‡ä¸‹è¡¨è·å–</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> (scripts.<span class=\"property\">length</span>) scriptUrl = scripts[scripts.<span class=\"property\">length</span> - <span class=\"number\">1</span>].<span class=\"property\">src</span></span><br></pre></td></tr></table></figure>\n\n<p>åŸç†æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿï¼Œå¤§å®¶éƒ½çŸ¥é“ï¼Œhtml æ˜¯ä»ä¸Šå¾€ä¸‹è§£æçš„ï¼Œå½“è§£æåˆ° script æ ‡ç­¾æ—¶ï¼Œæµè§ˆå™¨ä¼šé˜»å¡é¡µé¢æ¸²æŸ“ï¼Œç­‰å¾…ä¸‹è½½å®Œå½“å‰ js å¹¶æ‰§è¡Œå®Œæˆåæ‰ä¼šç»§ç»­å¾€ä¸‹è§£æï¼Œ(é™¤éä½ ç»™å½“å‰ script æ ‡ç­¾ä½¿ç”¨äº† <code>async</code> æˆ– <code>defer</code> å±æ€§ï¼Œè‡³äºè¿™ä¿©å±æ€§çš„ä½œç”¨ï¼Œå¯è‡ªè¡Œç½‘ä¸Šæœç´¢)è¿™æ—¶ä½¿ç”¨ <code>document.getElementsByTagName(&#39;script&#39;)</code> è·å–é¡µé¢ä¸Šçš„ script æ ‡ç­¾åˆ™åªä¼šè·å–åˆ°å·²ç»è§£æçš„ script æ ‡ç­¾ï¼Œæ‰€ä»¥å½“å‰çš„ script æ ‡ç­¾å®ƒä¸€å®šæ˜¯æœ€åä¸€ä¸ª script æ ‡ç­¾ï¼Œå°±å¯ä»¥é€šè¿‡ <code>length - 1</code> è·å–å•¦</p>\n<p>æ—¢ç„¶å¾—åˆ°äº† urlï¼Œé‚£ä¹ˆå°±å¯ä»¥åŠ è½½ js äº†ï¼Œåªéœ€è¦æŠŠå½“å‰çš„ js æ–‡ä»¶åæ”¹æˆéœ€è¦åŠ è½½çš„ js æ–‡ä»¶åï¼Œä¹Ÿå°±æ˜¯å‰é¢æ‰€è¯´çš„ <code>webpackChunkName</code></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> scriptUrl</span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"variable language_\">document</span>.<span class=\"property\">currentScript</span>) scriptUrl = <span class=\"variable language_\">document</span>.<span class=\"property\">currentScript</span>.<span class=\"property\">src</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> (!scriptUrl) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> scripts = <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementsByTagName</span>(<span class=\"string\">&#x27;script&#x27;</span>)</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (scripts.<span class=\"property\">length</span>) scriptUrl = scripts[scripts.<span class=\"property\">length</span> - <span class=\"number\">1</span>].<span class=\"property\">src</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">if</span> (!scriptUrl) <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Error</span>(<span class=\"string\">&#x27;Automatic publicPath is not supported in this browser&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\">// ç»“æœä»¥ä¸‹å‡ ä¸ª replace() å³å¯å¾—åˆ° url</span></span><br><span class=\"line\">scriptUrl = scriptUrl</span><br><span class=\"line\">  .<span class=\"title function_\">replace</span>(<span class=\"regexp\">/#.*$/</span>, <span class=\"string\">&#x27;&#x27;</span>) <span class=\"comment\">// å»é™¤é”šç‚¹</span></span><br><span class=\"line\">  .<span class=\"title function_\">replace</span>(<span class=\"regexp\">/\\?.*$/</span>, <span class=\"string\">&#x27;&#x27;</span>) <span class=\"comment\">// å»é™¤å‚æ•°</span></span><br><span class=\"line\">  .<span class=\"title function_\">replace</span>(<span class=\"regexp\">/\\/[^/]+$/</span>, <span class=\"string\">&#x27;/&#x27;</span>) <span class=\"comment\">// å»é™¤æ–‡ä»¶å</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"å¦‚ä½•åŠ è½½\"><a href=\"#å¦‚ä½•åŠ è½½\" class=\"headerlink\" title=\"å¦‚ä½•åŠ è½½\"></a>å¦‚ä½•åŠ è½½</h2><p>å› ä¸ºåœ¨ä¸Šä¸€æ­¥æˆ‘ä»¬å·²ç»å¾—åˆ° urlï¼Œæ­¤æ—¶åªéœ€è¦æ‹¼æ¥ä¸Š <code>webpackChunkName</code> çš„æ–‡ä»¶åå°±å¯ä»¥åŠ è½½æŒ‡å®šçš„ js äº†</p>\n<p>é‚£ä¹ˆ<code>webpackChunkName</code>æ˜¯æ€ä¹ˆæ¥çš„å‘¢ï¼Ÿ<br>å¦‚æœä½ ç”¨çš„æ˜¯ webpackï¼Œé‚£ä¹ˆå®ƒå·²ç»å¸®ä½ åšå¥½äº†ï¼Œåä¹‹åˆ™å¾—è‡ªå·±å†™ï¼Œå…¶å®å¾ˆç®€å•</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// å®šä¹‰ä¸€ä¸ªå¯¹è±¡ï¼Œé‡Œé¢å†™å¥½åŠ¨æ€åŠ è½½çš„jsæ–‡ä»¶åå³å¯</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> map = &#123; <span class=\"attr\">admin</span>: <span class=\"string\">&#x27;discuss.admin.js&#x27;</span> &#125;</span><br></pre></td></tr></table></figure>\n\n<p>ç„¶åé€šè¿‡ js åŠ¨æ€åˆ›å»º script æ ‡ç­¾åŠ è½½ js å³å¯ï¼Œæœ€ååŠ ä¸Šä¸€ä¸ª <code>onload</code> äº‹ä»¶ï¼Œç­‰å¾…åŠ è½½æˆåŠŸåè‡ªè¡Œä»£ç å³å¯</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// chunk: js æ–‡ä»¶å</span></span><br><span class=\"line\"><span class=\"comment\">// callback: å›è°ƒå‡½æ•°ï¼Œå½“jsåŠ è½½å®Œæˆåæ‰§è¡Œ</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">loadScript</span> = (<span class=\"params\">chunk, callback</span>) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> script = <span class=\"variable language_\">document</span>.<span class=\"title function_\">createElement</span>(<span class=\"string\">&#x27;script&#x27;</span>)</span><br><span class=\"line\">  script.<span class=\"property\">src</span> = scriptUrl + map[chunk]</span><br><span class=\"line\">  script.<span class=\"property\">onload</span> = <span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// æ‰§è¡Œå®ŒæˆååŠæ—¶é‡Šæ”¾ï¼Œè®©ç³»ç»Ÿå›æ”¶å†…å­˜ï¼Œæ¯•ç«Ÿæˆ‘ä»¬åªéœ€è¦åŠ è½½ä¸€æ¬¡å³å¯</span></span><br><span class=\"line\">    script.<span class=\"property\">onload</span> = <span class=\"literal\">null</span></span><br><span class=\"line\">    <span class=\"title function_\">callback</span>()</span><br><span class=\"line\">    <span class=\"comment\">// åˆ æ‰åŠ¨æ€åŠ è½½çš„ script æ ‡ç­¾ dom å…ƒç´ (ä¸ä¼šå¯¹ç¨‹åºç…§æˆå½±å“)</span></span><br><span class=\"line\">    script.<span class=\"property\">parentNode</span> &amp;&amp; script.<span class=\"property\">parentNode</span>.<span class=\"title function_\">removeChild</span>(script)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"variable language_\">document</span>.<span class=\"property\">head</span>.<span class=\"title function_\">appendChild</span>(script)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>æœ€åè¿˜æœ‰ä¸€ä¸ªé—®é¢˜éœ€è¦è§£å†³ï¼Œé‚£å°±æ˜¯é¿å…åœ¨å¤šæ¬¡æ‰§è¡Œ<code>window.init()</code>æ—¶è§¦å‘å¤šæ¬¡åŠ è½½ï¼Œå¯¼è‡´å¤šæ¬¡è¯·æ±‚ï¼Œç…§æˆä¸å¿…è¦çš„è¯·æ±‚ï¼Œä»¥åŠæµªè´¹æµé‡å¸¦å®½</p>\n<p>æ—¢ç„¶å·²ç»åŠ è½½ï¼Œé‚£ä¹ˆå°±ç•™ä¸ªæ ‡è®°ï¼Œè¡¨ç¤ºè¿™ä¸ª url å·²ç»åŠ è½½è¿‡äº†ï¼Œä¸‹è½½æ‰§è¡Œä¸è¦ä¸è¦ç»§ç»­åˆ›å»º script æ ‡ç­¾å³å¯</p>\n<p>å®šä¹‰ä¸€ä¸ªæ•°ç»„ç”¨æ¥å‚¨å­˜å·²ç»åŠ è½½è¿‡çš„åŠ¨æ€ jsï¼Œ<code>const chunks = []</code> åœ¨åŠ¨æ€åˆ›å»º script æ ‡ç­¾ä¹‹å‰å°†æ–‡ä»¶å<code>push()</code>è¿›å»æ•°ç»„é‡Œå³å¯</p>\n<h2 id=\"å®Œæ•´çš„æŒ‰éœ€åŠ è½½ä»£ç \"><a href=\"#å®Œæ•´çš„æŒ‰éœ€åŠ è½½ä»£ç \" class=\"headerlink\" title=\"å®Œæ•´çš„æŒ‰éœ€åŠ è½½ä»£ç \"></a>å®Œæ•´çš„æŒ‰éœ€åŠ è½½ä»£ç </h2><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// source: https://github.com/discussjs/discuss/blob/dc345810e6696f1282fca65df039b2186b1f34d1/src/client/lib/import.js</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> scriptUrl</span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"variable language_\">document</span>.<span class=\"property\">currentScript</span>) scriptUrl = <span class=\"variable language_\">document</span>.<span class=\"property\">currentScript</span>.<span class=\"property\">src</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> (!scriptUrl) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> scripts = <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementsByTagName</span>(<span class=\"string\">&#x27;script&#x27;</span>)</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (scripts.<span class=\"property\">length</span>) scriptUrl = scripts[scripts.<span class=\"property\">length</span> - <span class=\"number\">1</span>].<span class=\"property\">src</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">if</span> (!scriptUrl) <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Error</span>(<span class=\"string\">&#x27;Automatic publicPath is not supported in this browser&#x27;</span>)</span><br><span class=\"line\">scriptUrl = scriptUrl</span><br><span class=\"line\">  .<span class=\"title function_\">replace</span>(<span class=\"regexp\">/#.*$/</span>, <span class=\"string\">&#x27;&#x27;</span>) <span class=\"comment\">// å»é™¤é”šç‚¹</span></span><br><span class=\"line\">  .<span class=\"title function_\">replace</span>(<span class=\"regexp\">/\\?.*$/</span>, <span class=\"string\">&#x27;&#x27;</span>) <span class=\"comment\">// å»é™¤å‚æ•°</span></span><br><span class=\"line\">  .<span class=\"title function_\">replace</span>(<span class=\"regexp\">/\\/[^/]+$/</span>, <span class=\"string\">&#x27;/&#x27;</span>) <span class=\"comment\">// å»é™¤æ–‡ä»¶å</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// æœªæ¥é¿å…äºå…¶å®ƒjsäº§ç”Ÿå…¨å±€å˜é‡å†²çªï¼Œä½ å¯ä»¥å®šä¹‰ä¸ºä¸€ä¸ªå…¶å®ƒæ¯”è¾ƒå¤æ‚çš„å˜é‡å</span></span><br><span class=\"line\"><span class=\"variable language_\">window</span>.<span class=\"property\">chunks</span> = []</span><br><span class=\"line\"><span class=\"keyword\">const</span> map = &#123; <span class=\"attr\">admin</span>: <span class=\"string\">&#x27;discuss.admin.js&#x27;</span> &#125;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">loadScript</span> = (<span class=\"params\">chunk, callback</span>) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"comment\">// å¦‚æœå­˜åœ¨ï¼Œåˆ™ç›´æ¥æ‰§è¡Œå›è°ƒ</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"variable language_\">window</span>.<span class=\"property\">chunks</span>.<span class=\"title function_\">includes</span>(chunk)) <span class=\"keyword\">return</span> <span class=\"title function_\">callback</span>()</span><br><span class=\"line\">  <span class=\"comment\">// å¦‚æœä¸Šæ–¹åˆ¤æ–­æ²¡æœ‰æˆç«‹ï¼Œåˆ™pushåˆ°æ•°ç»„é‡Œï¼Œä¸‹æ¬¡æ‰§è¡Œå°±ä¼šç«‹å³æ‰§è¡Œå›è°ƒä¸å¿…å†å‘ä¸‹æ‰§è¡Œä»£ç </span></span><br><span class=\"line\">  <span class=\"variable language_\">window</span>.<span class=\"property\">chunks</span>.<span class=\"title function_\">push</span>(chunk)</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">const</span> script = <span class=\"variable language_\">document</span>.<span class=\"title function_\">createElement</span>(<span class=\"string\">&#x27;script&#x27;</span>)</span><br><span class=\"line\">  script.<span class=\"property\">src</span> = scriptUrl + map[chunk]</span><br><span class=\"line\">  script.<span class=\"property\">onload</span> = <span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">    script.<span class=\"property\">onload</span> = <span class=\"literal\">null</span></span><br><span class=\"line\">    <span class=\"title function_\">callback</span>()</span><br><span class=\"line\">    script.<span class=\"property\">parentNode</span> &amp;&amp; script.<span class=\"property\">parentNode</span>.<span class=\"title function_\">removeChild</span>(script)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"variable language_\">document</span>.<span class=\"property\">head</span>.<span class=\"title function_\">appendChild</span>(script)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> loadScript</span><br></pre></td></tr></table></figure>\n",
            "tags": [
                "JavaScript",
                "æ•™ç¨‹"
            ]
        },
        {
            "id": "https://blog.imlete.cn/article/CardLink.html",
            "url": "https://blog.imlete.cn/article/CardLink.html",
            "title": "ä½¿ç”¨ CardLink åº“ç”Ÿäº§å¡ç‰‡å¼é“¾æ¥",
            "date_published": "2022-07-11T09:52:21.000Z",
            "content_html": "<script async src=\"/js/cardlink.js\" ></script>\n\n<p>æœ‰æ—¶å€™ç»å¸¸çœ‹åˆ°çŸ¥ä¹çš„æ–‡ç« ï¼Œæˆ–è€…é—®é¢˜ä¸­çš„é“¾æ¥æ˜¯å¡ç‰‡å¼çš„</p>\n<p>å°†å¡ç‰‡å¼é“¾æ¥ä¸æ™®é€šçš„é“¾æ¥ç›¸æ¯”ï¼Œå¡ç‰‡å¼é“¾æ¥ä¸ä»…ç¾è§‚ï¼Œè¿˜å±•ç¤ºæ›´å¤šä¿¡æ¯ï¼Œå¦‚ï¼šæ ‡é¢˜ã€å›¾ç‰‡ã€ç½‘å€ç­‰</p>\n<p>æ•ˆæœå¦‚ä¸‹ <a href=\"https://github.com/Lete114/CardLink\">CardLink</a></p>\n<h2 id=\"CardLink\"><a href=\"#CardLink\" class=\"headerlink\" title=\"CardLink\"></a>CardLink</h2><p>ä¸€äº›ä½¿ç”¨æ–¹æ³•è¯·è§ <a href=\"https://github.com/Lete114/CardLink\">https://github.com/Lete114/CardLink</a></p>\n<p>é€šè¿‡ CDN çš„æ–¹å¼å¼•å…¥ CardLink</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- å»ºè®®æ”¾åœ¨headæ ‡ç­¾é‡Œ --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;https://cdn.jsdelivr.net/npm/cardlink&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- å»ºè®®æ”¾åœ¨ &lt;/body&gt; ä¹‹å‰ --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">  <span class=\"comment\">// ä¸º&lt;article&gt;&lt;/article&gt;(æ–‡ç« )æ ‡ç­¾ä¸‹æ‰€æœ‰æ‰“å¼€æ–°æ ‡ç­¾çª—å£çš„aæ ‡ç­¾ç”Ÿæˆå¡ç‰‡é“¾æ¥</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">  <span class=\"title function_\">cardLink</span>(<span class=\"variable language_\">document</span>.<span class=\"title function_\">querySelectorAll</span>(<span class=\"string\">&#x27;article a[target=_blank]&#x27;</span>))</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>å½“ä½ æƒ³è®©ç‰¹å®šçš„é“¾æ¥å˜æˆå¡ç‰‡å¼é“¾æ¥æ—¶ä½ å¯ä»¥ä¸ºå®ƒæ·»åŠ ä¸Š <code>cardlink</code> å±æ€§</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- å»ºè®®æ”¾åœ¨ &lt;/body&gt; ä¹‹å‰ --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">  <span class=\"comment\">// CardLink é»˜è®¤ä¼šå¯¹é¡µé¢ä¸Šæ‰€æœ‰a[cardlink]ç”Ÿæˆå¡ç‰‡é“¾æ¥</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">  <span class=\"title function_\">cardLink</span>()</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>æˆ–è€…å¦‚æœä½ ä½¿ç”¨ <code>markdown</code> å†™å†…å®¹çš„æ—¶å€™ï¼Œå¯ä»¥ç›´æ¥åœ¨å†…å®¹ä¸­å†™ <code>HTML</code></p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"section\">## æ ‡é¢˜ 1</span></span><br><span class=\"line\"></span><br><span class=\"line\">å…¶å®ƒå†…å®¹...</span><br><span class=\"line\"></span><br><span class=\"line\">æ­£å¸¸ markdown è¯­æ³•</span><br><span class=\"line\">[<span class=\"string\">https://Lete114.github.io/CardLink</span>](<span class=\"link\">https://Lete114.github.io/CardLink</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">html è¯­æ³•</span><br><span class=\"line\"><span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">&quot;https://Lete114.github.io/CardLink/&quot;</span> <span class=\"attr\">target</span>=<span class=\"string\">&quot;_blank&quot;</span>&gt;</span></span><span class=\"language-xml\"><span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"section\">## æ ‡é¢˜ 2</span></span><br><span class=\"line\"></span><br><span class=\"line\">å…¶å®ƒå†…å®¹...</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- å»ºè®®æ”¾åœ¨ &lt;/body&gt; ä¹‹å‰ --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">  <span class=\"comment\">// CardLink é»˜è®¤ä¼šå¯¹é¡µé¢ä¸Šæ‰€æœ‰a[cardlink]ç”Ÿæˆå¡ç‰‡é“¾æ¥</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">  <span class=\"title function_\">cardLink</span>()</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"è·¨åŸŸè¯·æ±‚\"><a href=\"#è·¨åŸŸè¯·æ±‚\" class=\"headerlink\" title=\"è·¨åŸŸè¯·æ±‚\"></a>è·¨åŸŸè¯·æ±‚</h3><ol>\n<li>æ­å»ºä»£ç†æœåŠ¡å™¨ï¼Œå°†ç›®æ ‡é“¾æ¥ä¼ ç»™ä»£ç†æœåŠ¡å™¨ï¼Œè®©ä»£ç†æœåŠ¡å™¨å»è¯·æ±‚ HTML æ–‡æœ¬å¹¶è¿”å›<br><a href=\"https://github.com/Lete114/CardLink/tree/server\">CardLink-Server</a></li>\n<li>ä½¿ç”¨åœ¨çº¿å…è´¹çš„è·¨åŸŸä»£ç†<br>(å‰è€…æ˜¯åšä¸»è‡ªå·±æ­å»ºçš„è·¨åŸŸè¯·æ±‚æœåŠ¡ï¼Œåè€…æ˜¯ç½‘ä¸Šæ‰¾çš„å…è´¹è·¨åŸŸè¯·æ±‚æœåŠ¡)<br><code>https://api.allorigins.win/raw?url=</code></li>\n</ol>\n",
            "tags": [
                "JavaScript"
            ]
        },
        {
            "id": "https://blog.imlete.cn/article/build-ts-doc.html",
            "url": "https://blog.imlete.cn/article/build-ts-doc.html",
            "title": "å¦‚ä½•ä¸ºè‡ªå·±çš„jsé¡¹ç›®ç”ŸæˆAPIæ–‡æ¡£",
            "date_published": "2022-06-06T15:52:50.000Z",
            "content_html": "<p>å¦‚é¢˜ï¼Œå½“è‡ªå·±å†™å®Œäº†ä¸€ä¸ªç¬¬ä¸‰æ–¹åº“ï¼Œå‡†å¤‡å‘å¸ƒæ—¶ï¼Œæ€»ä¸èƒ½ç›´æ¥æŠŠä¸€äº›ä½¿ç”¨æ–¹æ³•ä»¥åŠä¼ å‚è¯´æ˜å†™åœ¨<code>README.md</code>é‡Œå§</p>\n<p>çœ‹åˆ°è®¸å¤šç¬¬ä¸‰æ–¹åº“éƒ½æœ‰ä¸€ä¸ª<code>.d.ts</code>æ–‡ä»¶ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨è¿™äº›ç¬¬ä¸‰æ–¹åº“æ—¶ï¼Œåœ¨æ–¹æ³•ä¸Šå®‰è£…<code>ctrl+é¼ æ ‡å·¦é”®</code>æ—¶å°±ä¼šè·³è½¬åˆ°å¯¹åº”<code>.d.ts</code>è¯´æ˜æ–‡æ¡£ä¸­</p>\n<p>é‚£ä¹ˆè¿™ä¸ªæ˜¯å’±ä»¬åšçš„å‘¢ï¼Ÿéš¾é“æ˜¯æ‰‹åŠ¨åˆ›å»ºå¹¶ç¼–å†™çš„å—ï¼Ÿä¸æ˜¯å§ï¼Ÿå¦‚æœæ˜¯æ‰‹åŠ¨åˆ›å»ºçš„è¯ï¼Œå“ªäº›å¤§å‹é¡¹ç›®é‚£ä¹ˆå¤šæ–¹æ³•å’Œæ–‡ä»¶æ¨¡å—ï¼Œå¹¶ä¸”è¿˜æ˜¯å¤šäººåä½œå¼€å‘ï¼Œä¸å¯èƒ½åŒæ­¥å¦‚æ­¤åºå¤§çš„<code>.d.ts</code>æ–‡ä»¶ï¼Œé‚£ä¹ˆè¿™ä¸ªæ˜¯æ€ä¹ˆåšçš„å‘¢ï¼Ÿ</p>\n<p>è¿™ä¸ªæ˜¯ä½¿ç”¨<code>TypeScript</code>ç”Ÿæˆçš„ï¼Œä¸æ˜¯å§ï¼Ÿé‚£æˆ‘ç”¨çš„ä¸æ˜¯<code>TypeScript</code>å†™çš„åº“ä¸å°±ä¸èƒ½ç”Ÿæˆäº†ï¼Ÿ</p>\n<p>éä¹Ÿéä¹Ÿï¼Œå³ä½¿ä¸æ˜¯ç”¨<code>TypeScript</code>å†™çš„é¡¹ç›®ä¹Ÿèƒ½ç”Ÿæˆ<code>.d.ts</code>æ–‡ä»¶</p>\n<p>åªè¦ä½ å†™çš„æ—¶å€™åœ¨æ–¹æ³•ä¸Šæ·»åŠ æ³¨é‡Šå³å¯ï¼Œæ³¨é‡Šå…³é”®å­—å¿…é¡»éµå¾ª<a href=\"https://jsdoc.app/\">JSDoc</a></p>\n<p>JSDoc ä¸­æœ‰å¾ˆå¤šå…³é”®å­—ï¼Œè¿™äº›å…³é”®å­—æƒ³å¿…ä½ å¤šå¤šå°‘å°‘ä¼šåœ¨å…¶å®ƒç¬¬ä¸‰æ–¹åº“çš„<code>.d.ts</code>æ–‡ä»¶ä¸­è§è¿‡ï¼Œå¦‚: <code>@param</code> <code>@returns</code> <code>@author</code>ç­‰ï¼Œæ›´å¤šå…·ä½“çš„è¯·è‡ªè¡Œåœ¨<a href=\"https://jsdoc.app/\">JSDoc</a>ä¸­æŸ¥çœ‹</p>\n<p>è¯´äº†é‚£ä¹ˆå¤šï¼Œé‚£ä¹ˆåˆ°åº•å¦‚ä½•ç”Ÿæˆ<code>.d.ts</code>æ–‡æ¡£å‘¢ï¼Ÿ</p>\n<p>ä¸¾ä¾‹æˆ‘ç›®å‰æœ‰ä¸€ä¸ª<code>/src/main.js</code>ï¼Œå…¶ä¸­ä»£ç å¦‚ä¸‹</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * ä»£ç æ¥æºäº: https://github.com/Lete114/CardLink/blob/f4ab08b78625244d9515743e41c7e04f839e149f/src/main.js#L12</span></span><br><span class=\"line\"><span class=\"comment\"> * Determine if it is a [&#x27;https://&#x27;, &#x27;http://&#x27;, &#x27;//&#x27;] protocol</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> &#123;<span class=\"type\">String</span>&#125; url Website url</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@returns</span> &#123;<span class=\"type\">Boolean</span>&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"keyword\">function</span> <span class=\"title function_\">isHttp</span>(<span class=\"params\">url</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"regexp\">/^(https?:)?\\/\\//g</span>.<span class=\"title function_\">test</span>(url)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>åªéœ€ä¸€è¡Œå‘½ä»¤å³å¯ï¼Œä½¿ç”¨ npx ä¸´æ—¶å®‰è£…<code>typescript</code>ï¼Œå¹¶è°ƒç”¨<code>typescript</code>çš„å‘½ä»¤ç”Ÿæˆ<code>.d.ts</code>æ–‡æ¡£</p>\n<blockquote>\n<p>æ³¨æ„å…¶ä¸­<code>-p</code>æ˜¯ npx çš„å‘½ä»¤ï¼ŒåŸå<code>--package</code>ï¼Œå…·ä½“è¯·çœ‹å®˜ç½‘<a href=\"https://docs.npmjs.com/cli/v8/commands/npx\">https://docs.npmjs.com/cli/v8/commands/npx</a></p>\n</blockquote>\n<ul>\n<li><code>src/**/*.js</code>: å¯¹ src ç›®å½•ä¸‹çš„æ‰€æœ‰ js æ–‡ä»¶ç”Ÿæˆ<code>.d.ts</code>æ–‡ä»¶</li>\n<li><code>--declaration</code>: ç”Ÿæˆç›¸åº”çš„<code>.d.ts</code>æ–‡ä»¶</li>\n<li><code>--allowJs</code>: å…è®¸ç¼–è¯‘ javascript æ–‡ä»¶</li>\n<li><code>--emitDeclarationOnly</code>: åªè¾“å‡º <code>.d.ts</code> æ–‡ä»¶ï¼Œä¸è¾“å‡º JavaScript æ–‡ä»¶</li>\n<li><code>--outDir</code>: è¾“å‡ºåˆ°æŒ‡å®šçš„ç›®å½•</li>\n</ul>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npx -p typescript tsc src/**.js --declaration --allowJs --emitDeclarationOnly --outDir types</span><br></pre></td></tr></table></figure>\n\n<p>æ‰§è¡Œå¦‚ä¸Šå‘½ä»¤åå°±ä¼šå…ˆä¸‹è½½<code>typescript</code>ï¼Œç„¶åæ‰§è¡Œ tsc å‘½ä»¤ï¼Œæ„å»ºç”Ÿæˆ<code>.d.ts</code> æ–‡ä»¶åˆ°<code>types/main.d.ts</code></p>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * ä»£ç æ¥æºäº: https://github.com/Lete114/CardLink/blob/f4ab08b78625244d9515743e41c7e04f839e149f/src/main.js#L12</span></span><br><span class=\"line\"><span class=\"comment\"> * Determine if it is a [&#x27;https://&#x27;, &#x27;http://&#x27;, &#x27;//&#x27;] protocol</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> &#123;<span class=\"type\">String</span>&#125; url Website url</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@returns</span> &#123;<span class=\"type\">Boolean</span>&#125;</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"keyword\">function</span> <span class=\"title function_\">isHttp</span>(<span class=\"params\">url: <span class=\"built_in\">string</span></span>): <span class=\"built_in\">boolean</span></span><br></pre></td></tr></table></figure>\n",
            "tags": [
                "JavaScript",
                "TypeScript"
            ]
        },
        {
            "id": "https://blog.imlete.cn/article/Static-resource-cache-control.html",
            "url": "https://blog.imlete.cn/article/Static-resource-cache-control.html",
            "title": "å‰ç«¯ä¼˜åŒ–ä¹‹é™æ€èµ„æºç¼“å­˜æ§åˆ¶",
            "date_published": "2022-05-12T11:51:45.000Z",
            "content_html": "<blockquote>\n<p>æœ¬æ–‡è½¬è‡ª<a href=\"https://www.zhihu.com/question/20790576/answer/32602154\">@å¼ äº‘é¾™</a>ï¼Œäº 2014 å¹´ 10 æœˆåœ¨çŸ¥ä¹ä¸Šçš„ä¸€ä¸ªé—®é¢˜å›ç­”ï¼Œåšä¸»è§‰å¾—è¿™ä½å¤§ä½¬å†™çš„å¾ˆå¥½ï¼Œä¹Ÿå¾ˆè¯¦ç»†ï¼Œäºæ˜¯å°±æŠŠå†…å®¹æ¬åˆ°äº†è‡ªå·±çš„åšå®¢ä¸Šï¼Œä¾¿äºä»¥åè‡ªå·±æŸ¥é˜…</p>\n</blockquote>\n<h2 id=\"å¤ªé•¿ä¸æƒ³çœ‹\"><a href=\"#å¤ªé•¿ä¸æƒ³çœ‹\" class=\"headerlink\" title=\"å¤ªé•¿ä¸æƒ³çœ‹\"></a>å¤ªé•¿ä¸æƒ³çœ‹</h2><p>ä½¿ç”¨å¼ºåˆ¶ç¼“å­˜å¦‚ä½•ï¼Œå¦‚ä½•è®©ç”¨æˆ·èƒ½å¤ŸåŠæ—¶ä½¿ç”¨æœ€æ–°ä¿®æ”¹åçš„é™æ€èµ„æºï¼Ÿ</p>\n<ol>\n<li>ä¿®æ”¹èµ„æºæ–‡ä»¶å<code>index-v1.css</code></li>\n<li>ä¿®æ”¹èµ„æºæ–‡ä»¶åï¼Œå¹¶ä¸”å¯¹æ–‡ä»¶å†…å®¹ç”Ÿæˆ hash å€¼(å†…å®¹æ”¹å˜ï¼Œåˆ™ hash æ”¹å˜åä¹‹ä¸æ”¹å˜)(<code>index.v1tg6l.css</code>)</li>\n<li>ä¸ºèµ„æºæ·»åŠ è¯·æ±‚å‚æ•°(è¯¥å‚æ•°æ²¡æœ‰ä»»ä½•ä½œç”¨ï¼Œåªæ˜¯ä¸ºäº†ä¿®æ”¹ url åœ°å€)ä¸ç¬¬äºŒæ¡ä¸€æ ·ç”Ÿæˆ hash(<code>index.css?v=qb6l0p</code>)</li>\n</ol>\n<blockquote>\n<p>æ€»ç»“: åªè¦ä¿®æ”¹äº†èµ„æºè¯·æ±‚çš„ url åœ°å€ï¼Œé‚£ä¹ˆå°±ä¼šè·å–æœ€æ–°ä¿®æ”¹çš„é™æ€èµ„æºï¼Œä»è€Œä¸»åŠ¨å¼ƒç”¨æ—§é™æ€èµ„æº<br>å¾ˆå¤šå¤§ç½‘ç«™éƒ½ä¼šä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œä¾‹å¦‚ baiduï¼Œtaobao</p>\n</blockquote>\n<h2 id=\"ä»€ä¹ˆæ˜¯-HTTP-ç¼“å­˜\"><a href=\"#ä»€ä¹ˆæ˜¯-HTTP-ç¼“å­˜\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯ HTTP ç¼“å­˜\"></a>ä»€ä¹ˆæ˜¯ HTTP ç¼“å­˜</h2><p>HTTP ç¼“å­˜åˆ†ä¸ºä¸¤ç§(æœ¬æ–‡ä¸ä¼šæ·±ç©¶å“åº”å¤´çš„ä¼—å¤šå‚æ•°)</p>\n<ul>\n<li>å¼ºåˆ¶ç¼“å­˜: (çŠ¶æ€ç å§‹ç»ˆ 200)åœ¨è§„å®šæ—¶é—´å†…ï¼Œä¸ç”¨å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œç›´æ¥ä½¿ç”¨æœ¬åœ°ç¼“å­˜(è¶…è¿‡è§„å®šæ—¶é—´åæ‰ä¼šé‡æ–°å‘æœåŠ¡å™¨å‘é€è¯·æ±‚è·å–èµ„æº)</li>\n<li>åå•†ç¼“å­˜: (çŠ¶æ€ç è¿‡æœŸ 200ï¼Œæœªè¿‡æœŸ 304)æ¯æ¬¡éƒ½ä¼šå‘æœåŠ¡å™¨ç¡®è®¤ï¼Œè¿™ä¸ªæœ¬åœ°èµ„æºæœ‰æ²¡æœ‰è¿‡æœŸï¼Œè¿‡æœŸ: æœåŠ¡å™¨è¿”å›æ–°èµ„æºã€‚æœªè¿‡æœŸ: è®©æµè§ˆå™¨ä½¿ç”¨æœ¬åœ°ç¼“å­˜</li>\n</ul>\n<h2 id=\"æ­£æ–‡\"><a href=\"#æ­£æ–‡\" class=\"headerlink\" title=\"æ­£æ–‡\"></a>æ­£æ–‡</h2><p>ä½¿ç”¨å¼ºåˆ¶ç¼“å­˜å¦‚ä½•ï¼Œå¦‚ä½•è®©ç”¨æˆ·èƒ½å¤ŸåŠæ—¶ä½¿ç”¨æœ€æ–°ä¿®æ”¹åçš„é™æ€èµ„æºï¼Ÿ</p>\n<p>è¿™æ˜¯ä¸€ä¸ªæ™®é€šç½‘ç«™çš„ç»“æ„<br><img src=\"/img/Static-resource-cache-control/1.png\" alt=\"\"></p>\n<p>è®¿é—®è¿™ä¸ªç½‘ç«™ï¼Œå¯ä»¥çœ‹åˆ°ç½‘ç»œè¯·æ±‚çŠ¶æ€ï¼Œå“åº”çŠ¶æ€ 200ï¼Œè¿™æ˜¯åœ¨æ­£å¸¸ä¸è¿‡çš„äº‹äº†<br>é‚£å°±çœ‹çœ‹<code>a.css</code>çš„è¯·æ±‚å§ï¼Œå¦‚æœæ¯æ¬¡ç”¨æˆ·è®¿é—®é¡µé¢éƒ½è¦åŠ è½½ï¼Œæ˜¯ä¸æ˜¯å¾ˆå½±å“æ€§èƒ½ï¼Œå¾ˆæµªè´¹å¸¦å®½å•Š<br><img src=\"/img/Static-resource-cache-control/2.png\" alt=\"\"></p>\n<p>æˆ‘ä»¬å¸Œæœ›æœ€å¥½è¿™æ ·,åˆ©ç”¨ 304ï¼Œè®©æµè§ˆå™¨ä½¿ç”¨æœ¬åœ°ç¼“å­˜ã€‚ä½†ï¼Œè¿™æ ·å°±å¤Ÿäº†å—ï¼Ÿä¸æˆï¼<strong>304 å«åå•†ç¼“å­˜</strong>ï¼Œè¿™ç©æ„å„¿è¿˜æ˜¯éœ€è¦å‘æµè§ˆå™¨å‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œé—®é—®æœåŠ¡å™¨è¿™ä¸ªèµ„æºæœ‰æ²¡æœ‰æ›´æ–°</p>\n<blockquote>\n<p>æ›´æ–°: è¿”å›æ–°èµ„æº<br>æ²¡æ›´æ–°: å‘Šè¯‰æµè§ˆå™¨ä½¿ç”¨æœ¬åœ°ç¼“å­˜</p>\n</blockquote>\n<p><img src=\"/img/Static-resource-cache-control/3.png\" alt=\"\"></p>\n<p>ä½¿ç”¨<strong>å¼ºåˆ¶ç¼“å­˜ï¼ˆcache-control/expiresï¼‰</strong>è®©æµè§ˆå™¨ä¸è¦å‘æœåŠ¡å™¨å‘é€è¯·æ±‚äº†<br>æ‰€ä»¥å¿…é¡»å½»åº•ç­æ‰è¿™ä¸ªè¯·æ±‚ï¼Œå˜æˆè¿™æ ·<br><img src=\"/img/Static-resource-cache-control/4.png\" alt=\"\"></p>\n<p>é‚£é—®é¢˜æ¥äº†ï¼šè¿™éƒ½ä¸è®©æµè§ˆå™¨å‘èµ„æºè¯·æ±‚äº†ï¼Œè¿™ç¼“å­˜å’‹æ›´æ–°ï¼Ÿ<br>å¯ä»¥é€šè¿‡æ›´æ–°é¡µé¢ä¸­å¼•ç”¨çš„èµ„æºè·¯å¾„ï¼Œè®©æµè§ˆå™¨ä¸»åŠ¨æ”¾å¼ƒç¼“å­˜ï¼ŒåŠ è½½æ–°èµ„æº<br><img src=\"/img/Static-resource-cache-control/5.png\" alt=\"\"></p>\n<p>ä¸‹æ¬¡ä¸Šçº¿èµ„æºçš„æ—¶å€™ï¼ŒæŠŠé“¾æ¥åœ°å€æ”¹æˆæ–°çš„ç‰ˆæœ¬ï¼Œè¿™å°±èƒ½æ›´æ–°èµ„æºäº†<br><img src=\"/img/Static-resource-cache-control/6.png\" alt=\"\"></p>\n<p>é¡µé¢å¼•ç”¨äº† 3 ä¸ª cssï¼Œè€ŒæŸæ¬¡ä¸Šçº¿åªæ”¹äº†å…¶ä¸­çš„ a.cssï¼Œå¦‚æœæ‰€æœ‰é“¾æ¥éƒ½æ›´æ–°ç‰ˆæœ¬(å½“ç„¶ä½ å¦‚æœåªæ”¹ a çš„é“¾æ¥åœ°å€å°±å¯ä»¥äº†ï¼Œä¸è¿‡æˆ‘ä»¬è¿˜æ˜¯è¦ç»§ç»­è®¨è®ºåç»­é—®é¢˜)ï¼Œå°±ä¼šå¯¼è‡´ b.cssï¼Œc.css çš„ç¼“å­˜ä¹Ÿå¤±æ•ˆï¼Œé‚£å²‚ä¸æ˜¯åˆæœ‰æµªè´¹äº†ï¼Ÿï¼<br>è¦è§£å†³è¿™ç§é—®é¢˜ï¼Œå¿…é¡»è®© url çš„ä¿®æ”¹ä¸æ–‡ä»¶å†…å®¹å…³è”ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåªæœ‰æ–‡ä»¶å†…å®¹å˜åŒ–ï¼Œæ‰ä¼šå¯¼è‡´ç›¸åº” url çš„å˜æ›´ï¼Œä»è€Œå®ç°æ–‡ä»¶çº§åˆ«çš„ç²¾ç¡®ç¼“å­˜æ§åˆ¶ã€‚</p>\n<p>å¯ä»¥ä½¿ç”¨<strong>æ•°æ®æ‘˜è¦ç®—æ³•</strong>ï¼Œæ‘˜è¦ä¿¡æ¯ä¸æ–‡ä»¶å†…å®¹ä¸€ä¸€å¯¹åº”ï¼Œå°±æœ‰äº†ä¸€ç§å¯ä»¥ç²¾ç¡®åˆ°å•ä¸ªæ–‡ä»¶ç²’åº¦çš„ç¼“å­˜æ§åˆ¶ä¾æ®äº†</p>\n<p>è¿™å›å†æœ‰æ–‡ä»¶ä¿®æ”¹ï¼Œå°±åªæ›´æ–°é‚£ä¸ªæ–‡ä»¶å¯¹åº”çš„ url äº†ï¼Œæƒ³åˆ°è¿™é‡Œè²Œä¼¼å¾ˆå®Œç¾äº†<br><img src=\"/img/Static-resource-cache-control/7.png\" alt=\"\"></p>\n<p>ç°ä»£äº’è”ç½‘ä¼ä¸šï¼Œä¸ºäº†è¿›ä¸€æ­¥æå‡ç½‘ç«™æ€§èƒ½ï¼Œä¼šæŠŠé™æ€èµ„æºå’ŒåŠ¨æ€ç½‘é¡µåˆ†é›†ç¾¤éƒ¨ç½²ï¼Œé™æ€èµ„æºä¼šè¢«éƒ¨ç½²åˆ° CDN èŠ‚ç‚¹ä¸Šï¼Œç½‘é¡µä¸­å¼•ç”¨çš„èµ„æºä¹Ÿä¼šå˜æˆå¯¹åº”çš„éƒ¨ç½²è·¯å¾„<br><img src=\"/img/Static-resource-cache-control/8.png\" alt=\"\"></p>\n<p>å¥½äº†ï¼Œå½“æˆ‘è¦æ›´æ–°é™æ€èµ„æºçš„æ—¶å€™ï¼ŒåŒæ—¶ä¹Ÿä¼šæ›´æ–° html ä¸­çš„å¼•ç”¨å§ï¼Œå°±å¥½åƒè¿™æ ·<br><img src=\"/img/Static-resource-cache-control/9.png\" alt=\"\"></p>\n<p>ä½†æ˜¯è¿™ä¼šäº§ç”Ÿä¸€ä¸ªé—®é¢˜ï¼Œå¦‚ä½•ä¿è¯é¡µé¢ä¸èµ„æºä¿æŒä¸€è‡´å‘¢ï¼Ÿ</p>\n<ul>\n<li>å…ˆéƒ¨ç½²é¡µé¢ï¼Œå†éƒ¨ç½²èµ„æº<ul>\n<li>åœ¨äºŒè€…éƒ¨ç½²çš„æ—¶é—´é—´éš”å†…ï¼Œå¦‚æœæœ‰ç”¨æˆ·è®¿é—®é¡µé¢ï¼Œå°±ä¼šåœ¨æ–°çš„é¡µé¢ç»“æ„ä¸­åŠ è½½æ—§çš„èµ„æºï¼Œå¹¶ä¸”æŠŠè¿™ä¸ªæ—§ç‰ˆæœ¬çš„èµ„æºå½“åšæ–°ç‰ˆæœ¬ç¼“å­˜èµ·æ¥ï¼Œå…¶ç»“æœå°±æ˜¯ï¼šç”¨æˆ·è®¿é—®åˆ°äº†ä¸€ä¸ªæ ·å¼é”™ä¹±çš„é¡µé¢ï¼Œé™¤éæ‰‹åŠ¨åˆ·æ–°ï¼Œå¦åˆ™åœ¨èµ„æºç¼“å­˜è¿‡æœŸä¹‹å‰ï¼Œé¡µé¢ä¼šä¸€ç›´æ‰§è¡Œé”™è¯¯ã€‚</li>\n</ul>\n</li>\n<li>å…ˆéƒ¨ç½²èµ„æºï¼Œå†éƒ¨ç½²é¡µé¢<ul>\n<li>åœ¨éƒ¨ç½²æ—¶é—´é—´éš”ä¹‹å†…ï¼Œæœ‰æ—§ç‰ˆæœ¬èµ„æºæœ¬åœ°ç¼“å­˜çš„ç”¨æˆ·è®¿é—®ç½‘ç«™ï¼Œç”±äºè¯·æ±‚çš„é¡µé¢æ˜¯æ—§ç‰ˆæœ¬çš„ï¼Œèµ„æºå¼•ç”¨æ²¡æœ‰æ”¹å˜ï¼Œæµè§ˆå™¨å°†ç›´æ¥ä½¿ç”¨æœ¬åœ°ç¼“å­˜ï¼Œè¿™ç§æƒ…å†µä¸‹é¡µé¢å±•ç°æ­£å¸¸ï¼›ä½†æ²¡æœ‰æœ¬åœ°ç¼“å­˜æˆ–è€…ç¼“å­˜è¿‡æœŸçš„ç”¨æˆ·è®¿é—®ç½‘ç«™ï¼Œå°±ä¼šå‡ºç°æ—§ç‰ˆæœ¬é¡µé¢åŠ è½½æ–°ç‰ˆæœ¬èµ„æºçš„æƒ…å†µï¼Œå¯¼è‡´é¡µé¢æ‰§è¡Œé”™è¯¯ï¼Œä½†å½“é¡µé¢å®Œæˆéƒ¨ç½²ï¼Œè¿™éƒ¨åˆ†ç”¨æˆ·å†æ¬¡è®¿é—®é¡µé¢åˆä¼šæ¢å¤æ­£å¸¸äº†ã€‚</li>\n</ul>\n</li>\n</ul>\n<blockquote>\n<p>ç®€è€Œè¨€ä¹‹: å…ˆéƒ¨ç½²è°éƒ½ä¸æˆï¼éƒ½ä¼šå¯¼è‡´éƒ¨ç½²è¿‡ç¨‹ä¸­å‘ç”Ÿé¡µé¢é”™ä¹±çš„é—®é¢˜ã€‚<br>æ‰€ä»¥ï¼Œè®¿é—®é‡ä¸å¤§çš„é¡¹ç›®ï¼Œå¯ä»¥è®©ç ”å‘åŒå­¦è‹¦é€¼ä¸€æŠŠï¼Œç­‰åˆ°åŠå¤œå·å·ä¸Šçº¿ï¼Œå…ˆä¸Šé™æ€èµ„æºï¼Œå†éƒ¨ç½²é¡µé¢ï¼Œçœ‹èµ·æ¥é—®é¢˜å°‘ä¸€äº›ã€‚</p>\n</blockquote>\n<p>ä½†æ˜¯å¦‚æœä½ ç°åœ¨æ­£åœ¨ç»´æŠ¤ä¸€ä¸ªç”¨æˆ·è®¿é—®é‡æ¯”è¾ƒå¤§çš„ç½‘ç«™ï¼Œæ”¹æ€ä¹ˆåŠï¼Œä½ æ‰“ç®—ä¸è§£å†³äº†å—ï¼Ÿ</p>\n<p>å¯ä»¥é‡‡ç”¨<strong>éè¦†ç›–å¼å‘å¸ƒ</strong>ï¼Œå‰é¢æˆ‘ä»¬è¯´äº†é‚£ä¹ˆå¤šéƒ½æ˜¯<strong>è¦†ç›–å¼å‘å¸ƒ</strong><br><img src=\"/img/Static-resource-cache-control/10.png\" alt=\"\"></p>\n<p>å…¨å¥—åšä¸‹æ¥ï¼Œå°±æ˜¯ç›¸å¯¹æ¯”è¾ƒå®Œæ•´çš„é™æ€èµ„æºç¼“å­˜æ§åˆ¶æ–¹æ¡ˆäº†ï¼Œè€Œä¸”ï¼Œè¿˜è¦æ³¨æ„çš„æ˜¯ï¼Œé™æ€èµ„æºçš„ç¼“å­˜æ§åˆ¶è¦æ±‚åœ¨å‰ç«¯æ‰€æœ‰é™æ€èµ„æºåŠ è½½çš„ä½ç½®éƒ½è¦åšè¿™æ ·çš„å¤„ç†ã€‚æ˜¯çš„ï¼Œæ‰€æœ‰ï¼ä»€ä¹ˆ jsã€css è‡ªä¸å¿…è¯´ï¼Œè¿˜è¦åŒ…æ‹¬ jsã€css æ–‡ä»¶ä¸­å¼•ç”¨çš„èµ„æºè·¯å¾„ï¼Œç”±äºæ¶‰åŠåˆ°æ‘˜è¦ä¿¡æ¯ï¼Œå¼•ç”¨èµ„æºçš„æ‘˜è¦ä¿¡æ¯ä¹Ÿä¼šå¼•èµ·å¼•ç”¨æ–‡ä»¶æœ¬èº«çš„å†…å®¹æ”¹å˜ï¼Œä»è€Œå½¢æˆçº§è”çš„æ‘˜è¦å˜åŒ–ï¼Œå¤§æ¦‚å°±æ˜¯å¦‚ä¸‹å›¾<br><img src=\"/img/Static-resource-cache-control/11.png\" alt=\"\"></p>\n",
            "tags": [
                "CSS",
                "JavaScript",
                "HTML",
                "Cache"
            ]
        },
        {
            "id": "https://blog.imlete.cn/article/Use-lint-staged.html",
            "url": "https://blog.imlete.cn/article/Use-lint-staged.html",
            "title": "ä½¿ç”¨ Lint-staged æ ¡éªŒ Git æš‚å­˜åŒºä»£ç æ˜¯å¦ç¬¦åˆæ ‡å‡†",
            "date_published": "2022-04-12T16:57:17.000Z",
            "content_html": "<h2 id=\"ä»€ä¹ˆæ˜¯-Lint-staged\"><a href=\"#ä»€ä¹ˆæ˜¯-Lint-staged\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯ Lint-staged\"></a>ä»€ä¹ˆæ˜¯ Lint-staged</h2><p>åœ¨ Git æš‚å­˜åŒºæ‰§è¡Œç›¸å…³çš„æ“ä½œï¼Œå¦‚å¯¹æš‚å­˜åŒºè¿›è¡Œ<code>eslint</code>æˆ–æ˜¯<code>prettier</code>ï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰ä¸€äº›è„šæœ¬</p>\n<p>å®˜æ–¹å†™ç€å¾ˆæœ‰è¶£çš„ä¸€æ®µè¯:</p>\n<blockquote>\n<p>Run linters against staged git files and donâ€™t let ğŸ’© slip into your code base!<br>å¯¹æš‚å­˜åŒºè¿›è¡Œä»£ç æ ¡éªŒï¼Œä¸è¦è®© ğŸ’©(ä¾¿ä¾¿)æºœè¿›ä½ çš„ä»£ç åº“ï¼</p>\n</blockquote>\n<h2 id=\"æ­£æ–‡\"><a href=\"#æ­£æ–‡\" class=\"headerlink\" title=\"æ­£æ–‡\"></a>æ­£æ–‡</h2><p>æœ‰äº›äººå¯èƒ½ä¼šé—®ï¼Œæˆ‘éƒ½æœ‰<code>eslint</code>å’Œ<code>prettier</code>ä¸ºä»€ä¹ˆè¿˜è¦ç”¨<code>lint-staged</code>?</p>\n<blockquote>\n<p>ç®€è€Œè¨€ä¹‹: <code>lint-staged</code>åªå¯¹å·²ä¿®æ”¹çš„æˆ–æ˜¯å°†è¦æäº¤åˆ°ä»“åº“çš„æ–‡ä»¶è¿›è¡Œæ ¡éªŒ</p>\n</blockquote>\n<p>å› ä¸º<code>lint-staged</code>ä»…å¯¹æš‚å­˜åŒºçš„æ–‡ä»¶è¿›è¡Œæ ¡éªŒï¼Œè€Œ<code>eslint</code>å’Œ<code>prettier</code>åˆ™æ˜¯å…¨å±€æˆ–æ˜¯æŒ‡å®šæŸä¸ªç›®å½•ä¸‹çš„çš„æ‰€æœ‰æ–‡ä»¶è¿›è¡Œæ ¡éªŒï¼Œåœ¨æ‰§è¡Œæ•ˆç‡ä¸Šè‚¯å®šæ˜¯<code>lint-staged</code>æ›´èƒœä¸€ç­¹</p>\n<h3 id=\"å®‰è£…\"><a href=\"#å®‰è£…\" class=\"headerlink\" title=\"å®‰è£…\"></a>å®‰è£…</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install lint-staged -D</span><br></pre></td></tr></table></figure>\n\n<p>ç¼–è¾‘<code>package.json</code>æ–‡ä»¶</p>\n<blockquote>\n<p>å¦‚æœåŒæ—¶æ ¡éªŒ<code>.vue</code>åˆ™å¯ä»¥è¿™ä¹ˆå†™<code>&quot;*.&#123;js,vue&#125;&quot;: &quot;npx eslint --fix&quot;</code><br>å…¶å†…éƒ¨ä½¿ç”¨çš„åŒ¹é…è§„åˆ™æ˜¯<a href=\"https://github.com/micromatch/micromatch\">micromatch</a></p>\n</blockquote>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;lint-staged&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;*.js&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;npx eslint --fix&quot;</span></span><br><span class=\"line\">  <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n\n<p>å®Œæ•´<code>package.json</code>æ–‡ä»¶</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;name&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;study-notes&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;version&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;1.0.0&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;description&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;main&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;index.js&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;scripts&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;test&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;echo \\&quot;Error: no test specified\\&quot; &amp;&amp; exit 1&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;prepare&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;npx husky install&quot;</span></span><br><span class=\"line\">  <span class=\"punctuation\">&#125;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;keywords&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span><span class=\"punctuation\">]</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;author&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;license&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;ISC&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;devDependencies&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;@commitlint/cli&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;^16.2.3&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;@commitlint/config-conventional&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;^16.2.1&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;eslint&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;^8.13.0&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;husky&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;^7.0.4&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;lint-staged&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;^12.3.7&quot;</span></span><br><span class=\"line\">  <span class=\"punctuation\">&#125;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;commitlint&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;extends&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;@commitlint/config-conventional&quot;</span></span><br><span class=\"line\">  <span class=\"punctuation\">&#125;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;lint-staged&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;*.js&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;npx eslint --fix&quot;</span></span><br><span class=\"line\">  <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n\n<p>é…ç½®å¥½åï¼Œå½“ä½ æ‰§è¡Œ<code>git add .</code>åå°±å¯ä»¥ä½¿ç”¨<code>npx lint-staged</code>å‘½ä»¤æ¥æ ¡éªŒæš‚å­˜åŒºçš„ä»£ç æ–‡ä»¶äº†</p>\n<p>æœ‰äº›äººå¯èƒ½ä¼šè¯´ï¼Œè¿™ä¹ˆéº»çƒ¦ï¼Œé‚£æˆ‘è¿˜ä¸å¦‚ç›´æ¥åœ¨<code>git add .</code>ä¹‹å‰ä½¿ç”¨<code>npx eslint --fix .</code>è¿™ä¹Ÿä¸æ˜¯æ›´å¥½å—ï¼Ÿ</p>\n<p>æ–‡ç« å¼€å¤´ä¸€å¥è¯´äº†ï¼Œ<code>lint-staged</code>åªå¯¹æš‚å­˜åŒºçš„ä»£ç æ–‡ä»¶è¿›è¡Œ lintï¼Œæ‰§è¡Œæ•ˆç‡è¿œè¶…<code>npx eslint --fix .</code>å‘½ä»¤ï¼Œè¯¥å‘½ä»¤ä¼šå¯¹å…¨å±€çš„æ–‡ä»¶è¿›è¡Œæ ¡éªŒï¼Œä¸è¿‡æœ‰æ²¡æœ‰é—®é¢˜éƒ½è¦æ ¡éªŒä¸€é(å¦‚æœé¡¹ç›®å¾ˆå¤§ï¼Œé‚£ä¹ˆè¿™ä¸ªå·®è·å°±æ˜¾ç°äº†)</p>\n<p>å¦‚æœä¸€ä¸ªé¡¹ç›®æœ‰<code>å‡ ç™¾</code>æˆ–<code>ä¸Šåƒ</code>ä¸ªæ–‡ä»¶ï¼Œè€Œæˆ‘åªæ˜¯ä¿®æ”¹äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œæ¯”å¦‚è¯´ä¸€ä¸ªæ ‡ç‚¹ç¬¦å·æˆ–è€…æ˜¯å…¶å®ƒä¿®æ”¹ï¼Œé‚£ä¹ˆ<code>npx eslint --fix .</code>å¯èƒ½éœ€è¦æ ¡éªŒå¾ˆä¹…ï¼Œè€Œä½¿ç”¨<code>npx lint-staged</code>åˆ™åªéœ€è¦æ ¡éªŒè¿™ä¸ªæ–‡ä»¶å³å¯</p>\n<h3 id=\"é…åˆ-Husky-ä½¿ç”¨\"><a href=\"#é…åˆ-Husky-ä½¿ç”¨\" class=\"headerlink\" title=\"é…åˆ Husky ä½¿ç”¨\"></a>é…åˆ Husky ä½¿ç”¨</h3><p>å…³äºå¦‚ä½•ä½¿ç”¨ husky å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« : <a href=\"/article/Use-husky-manage-git-project.html\">ä½¿ç”¨ Husky(å“ˆå£«å¥‡)ç®¡ç† Git é¡¹ç›®</a></p>\n<p>æ·»åŠ  hook åæ‰§è¡Œ<code>git commit</code>ä¹‹å‰å°±ä¼šå¯¹æš‚å­˜åŒºçš„æ–‡ä»¶è¿›è¡Œæ ¡éªŒäº†</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npx husky add .husky/pre-commit <span class=\"string\">&#x27;npx lint-staged&#x27;</span></span><br></pre></td></tr></table></figure>\n",
            "tags": [
                "JavaScript",
                "Git"
            ]
        },
        {
            "id": "https://blog.imlete.cn/article/Service-Worker-Preferred-Request-Resource.html",
            "url": "https://blog.imlete.cn/article/Service-Worker-Preferred-Request-Resource.html",
            "title": "ä½¿ç”¨Service Workerä¼˜é€‰è¯·æ±‚èµ„æº",
            "date_published": "2022-03-20T17:54:13.000Z",
            "content_html": "<h2 id=\"å‰è¨€\"><a href=\"#å‰è¨€\" class=\"headerlink\" title=\"å‰è¨€\"></a>å‰è¨€</h2><p>å½“ä½ çš„ç½‘ç«™æˆ–åšå®¢æœ‰å¤šä¸ªéƒ¨ç½²ç‚¹æ—¶ï¼Œéƒ¨ç½²åœ¨æŸä¸ªå¹³å°çš„è®¿é—®é€Ÿåº¦æ¯”è¾ƒå¿«ï¼Œäºæ˜¯ä½ å°±æŠŠä½ çš„åŸŸåè§£æåˆ°äº†è¿™ä¸ªå¹³å°ä¸Šï¼Œä½†æœ‰æ—¶å€™è¿˜æ˜¯ä¼šå˜å¾—å¾ˆæ…¢ï¼Œè¿™æ—¶å…¶å®ƒç«™ç‚¹é€Ÿåº¦å¯èƒ½ä¼šå˜å¾—æ¯”ä½ å½“å‰ä½¿ç”¨çš„è¿˜å¿«ä¸€ç‚¹ï¼Œéš¾é“è¿˜æœ‰æ¥å›è§£æåŸŸåå—ï¼Ÿå¤ªéº»çƒ¦äº†</p>\n<p>æœ‰æ²¡æœ‰å¯ä»¥ç›´æ¥è¿”å›æœ€å¿«ç½‘ç«™èµ„æºçš„åŠæ³•å‘¢ï¼Ÿ</p>\n<ol>\n<li>ä½¿ç”¨åŸŸåç®¡ç†å¹³å°ï¼Œæœ‰äº›å¹³å°å¯ä»¥è§£æä¸åŒç½‘ç»œæˆ–åœ°åŒºçš„ç«™ç‚¹<br>ä¾‹å¦‚<strong>è…¾è®¯äº‘</strong>å¯ä»¥åŒºåˆ†è§£æå›½å†…ä¸‰å¤§è¿è¥å•†ã€å¢ƒå†…ã€å¢ƒå¤–ã€ç­‰ä¸€äº›è§£æé€‰é¡¹(ä¸å¤ªå¥½ç”¨ï¼Œè¿˜éœ€è¦è‡ªå·±æµ‹è¯•ï¼Œéš¾ä¸æˆæ±‚ä½¿ç”¨å…¶å®ƒè¿è¥å•†æ‰‹æœºçš„æœ‹å‹å¸®ä½ æµ‹ä¸€ä¸‹å¿«ä¸å¿«å˜›~)</li>\n<li>ä½¿ç”¨ js æ‹¦æˆªç½‘ç«™çš„æ‰€æœ‰è¯·æ±‚ï¼Œå¹¶ç¯¡æ”¹å°†è¯·æ±‚å‘é€åˆ°è‡ªå·±çš„æ‰€æœ‰ç«™ç‚¹ï¼Œè¿™äº›ç«™ç‚¹ä¸­å¦‚æœå“ªä¸ªç«™ç‚¹æœ€å¿«è¿”å›ï¼Œé‚£ä¹ˆå°±ç”¨æœ€å¿«è¿”å›çš„è¿™ä¸ªä¿¡æ¯ï¼Œä¸æ­¤åŒæ—¶å°†å…¶å®ƒçš„è¯·æ±‚å…¨éƒ¨åˆ‡æ–­</li>\n</ol>\n<h2 id=\"æ­£æ–‡\"><a href=\"#æ­£æ–‡\" class=\"headerlink\" title=\"æ­£æ–‡\"></a>æ­£æ–‡</h2><p>æœ¬æ–‡ä¼šè¯¦ç»†è¯´æ˜å¦‚ä½•<strong>ä½¿ç”¨ Service Worker ä¼˜é€‰è¯·æ±‚èµ„æº</strong>è®©ä½ çš„ç½‘ç«™æ¯”ä»¥å‰æ›´å¿«ï¼Œæ›´ç¨³å®š</p>\n<p><strong>Service Worker</strong>åœ¨æ¥ä¸‹æ¥çš„å†…å®¹ä¸­ç»Ÿä¸€ç§°å‘¼ä¸º<strong>sw</strong></p>\n<h3 id=\"Service-Worker\"><a href=\"#Service-Worker\" class=\"headerlink\" title=\"Service Worker\"></a>Service Worker</h3><blockquote>\n<p>æ›´è¯¦ç»†è¯·çœ‹<a href=\"https://developer.mozilla.org/zh-CN/docs/Web/API/Service_Worker_API\">https://developer.mozilla.org/zh-CN/docs/Web/API/Service_Worker_API</a></p>\n</blockquote>\n<p>Service workers æœ¬è´¨ä¸Šå……å½“ Web åº”ç”¨ç¨‹åºã€æµè§ˆå™¨ä¸ç½‘ç»œï¼ˆå¯ç”¨æ—¶ï¼‰ä¹‹é—´çš„ä»£ç†æœåŠ¡å™¨</p>\n<p>Service worker è¿è¡Œåœ¨ worker ä¸Šä¸‹æ–‡ï¼Œå› æ­¤å®ƒä¸èƒ½è®¿é—® DOMã€‚ç›¸å¯¹äºé©±åŠ¨åº”ç”¨çš„ä¸» JavaScript çº¿ç¨‹ï¼Œå®ƒè¿è¡Œåœ¨å…¶ä»–çº¿ç¨‹ä¸­ï¼Œæ‰€ä»¥ä¸ä¼šé€ æˆé˜»å¡ã€‚</p>\n<p>å‡ºäºå®‰å…¨è€ƒé‡ï¼ŒService workers åªèƒ½ç”± HTTPS æ‰¿è½½ï¼Œæ¯•ç«Ÿä¿®æ”¹ç½‘ç»œè¯·æ±‚çš„èƒ½åŠ›æš´éœ²ç»™ä¸­é—´äººæ”»å‡»ä¼šéå¸¸å±é™©ã€‚</p>\n<h3 id=\"æ³¨å†Œ\"><a href=\"#æ³¨å†Œ\" class=\"headerlink\" title=\"æ³¨å†Œ\"></a>æ³¨å†Œ</h3><p>æ³¨å†Œ sw å¾ˆç®€å•ï¼Œåªéœ€ä¸€è¡Œä»£ç å³å¯ï¼Œå¦‚æœæ³¨å†ŒæˆåŠŸï¼Œåˆ™ sw ä¼šè¢«ä¸‹è½½åˆ°å®¢æˆ·ç«¯å¹¶ä¸”å®‰è£…å’Œæ¿€æ´»ï¼Œè¿™ä¸€æ­¥ä»…ä»…æ˜¯æ³¨å†Œè€Œå·²ï¼Œå®Œæ•´çš„æ˜¯: ä¸‹è½½â€”&gt;å®‰è£…â€”&gt;æ¿€æ´»</p>\n<blockquote>\n<p>æ³¨æ„: sw çš„æ³¨å†Œæ—¥å¿—è®°å½•åœ¨ Chrome æµè§ˆå™¨ä¸­å¯ä»¥é€šè¿‡è®¿é—®<a href=\"chrome://serviceworker-internals\">chrome://serviceworker-internals</a>æŸ¥çœ‹</p>\n</blockquote>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">navigator.<span class=\"property\">serviceWorker</span>.<span class=\"title function_\">register</span>(<span class=\"string\">&#x27;/Service-Worker.js&#x27;</span>)</span><br></pre></td></tr></table></figure>\n\n<p>å…¶ä¸­<code>/Service-Worker.js</code>å¿…é¡»æ˜¯å½“å‰åŸŸä¸‹çš„ js æ–‡ä»¶ï¼Œä»–ä¸èƒ½æ˜¯å…¶å®ƒåŸŸä¸‹çš„ï¼Œå³ä½¿ js æ–‡ä»¶å†…çš„å†…å®¹å®Œå…¨ç›¸ç­‰ï¼Œé‚£ä¹Ÿä¸è¡Œ</p>\n<p>å¦‚æœä½ åªæƒ³åœ¨æŸä¸ªè·¯å¾„å†™ä½¿ç”¨ sw çš„è¯ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>scope</code>é€‰é¡¹ï¼Œå½“ç„¶<code>/Service-Worker.js</code>çš„ä½ç½®ä¹Ÿå¯ä»¥è‡ªå®šä¹‰(åªè¦æ˜¯åŒæºä¸”æ˜¯ https åè®®å°±å¯ä»¥)ï¼Œå¦‚ä¸‹åªæœ‰åœ¨<code>/article/</code>æ–‡ç« é¡µ sw æ‰å¯åŠ¨ï¼Œå…¶å®ƒè·¯å¾„å†™ sw ä¸è¿›è¡Œå¤„ç†</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">navigator.<span class=\"property\">serviceWorker</span>.<span class=\"title function_\">register</span>(<span class=\"string\">&#x27;/sw-test/Service-Worker.js&#x27;</span>, &#123; <span class=\"attr\">scope</span>: <span class=\"string\">&#x27;/article/&#x27;</span> &#125;)</span><br></pre></td></tr></table></figure>\n\n<p>å¹¶ä¸”å¿…é¡»æ˜¯ https åè®®ï¼Œå¦‚æœæ˜¯æœ¬åœ°<code>127.0.0.1</code>æˆ–<code>localhost</code>æ˜¯è¢«å…è®¸çš„</p>\n<p>è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„æ³¨å†Œä»£ç </p>\n<p>å°†å®‰è£…ä»£ç æ”¾ç½®åœ¨<code>&lt;head&gt;</code>ä¹‹å</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">  ;(<span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"keyword\">if</span> (navigator.<span class=\"property\">serviceWorker</span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">      navigator.<span class=\"property\">serviceWorker</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">        .<span class=\"title function_\">register</span>(<span class=\"string\">&#x27;/sw.js&#x27;</span>)</span></span><br><span class=\"line\"><span class=\"language-javascript\">        .<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">result</span>) =&gt;</span> &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">          <span class=\"comment\">// åˆ¤æ–­æ˜¯å¦å®‰è£…äº†sw</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">          <span class=\"keyword\">if</span> (<span class=\"variable language_\">localStorage</span>.<span class=\"title function_\">getItem</span>(<span class=\"string\">&#x27;installSW&#x27;</span>)) <span class=\"keyword\">return</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">          <span class=\"variable language_\">localStorage</span>.<span class=\"title function_\">setItem</span>(<span class=\"string\">&#x27;installSW&#x27;</span>, <span class=\"literal\">true</span>)</span></span><br><span class=\"line\"><span class=\"language-javascript\">          <span class=\"comment\">// è¿™é‡Œå°±ä¸ç”¨æ¸…ç†setIntervaläº†ï¼Œå› ä¸ºé¡µé¢åˆ·æ–°åå°±æ²¡æœ‰äº†</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">          <span class=\"keyword\">const</span> timer = <span class=\"built_in\">setInterval</span>(<span class=\"function\">() =&gt;</span> &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"comment\">// åˆ¤æ–­swå®‰è£…åï¼Œæ˜¯å¦å¤„äºæ¿€æ´»çŠ¶æ€ï¼Œæ¿€æ´»ååˆ·æ–°é¡µé¢</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"keyword\">if</span> (result.<span class=\"property\">active</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;activated&#x27;</span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">              <span class=\"built_in\">clearInterval</span>(timer)</span></span><br><span class=\"line\"><span class=\"language-javascript\">              <span class=\"title function_\">fetch</span>(<span class=\"variable language_\">window</span>.<span class=\"property\">location</span>.<span class=\"property\">href</span>)</span></span><br><span class=\"line\"><span class=\"language-javascript\">                .<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">res</span>) =&gt;</span> res.<span class=\"title function_\">text</span>())</span></span><br><span class=\"line\"><span class=\"language-javascript\">                .<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">text</span>) =&gt;</span> &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">                  <span class=\"variable language_\">document</span>.<span class=\"title function_\">open</span>()</span></span><br><span class=\"line\"><span class=\"language-javascript\">                  <span class=\"variable language_\">document</span>.<span class=\"title function_\">write</span>(text)</span></span><br><span class=\"line\"><span class=\"language-javascript\">                  <span class=\"variable language_\">document</span>.<span class=\"title function_\">close</span>()</span></span><br><span class=\"line\"><span class=\"language-javascript\">                &#125;)</span></span><br><span class=\"line\"><span class=\"language-javascript\">            &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\">          &#125;, <span class=\"number\">100</span>)</span></span><br><span class=\"line\"><span class=\"language-javascript\">        &#125;)</span></span><br><span class=\"line\"><span class=\"language-javascript\">        .<span class=\"title function_\">catch</span>(<span class=\"variable language_\">console</span>.<span class=\"property\">log</span>)</span></span><br><span class=\"line\"><span class=\"language-javascript\">    &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\">  &#125;)()</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"ç”Ÿå‘½å‘¨æœŸ\"><a href=\"#ç”Ÿå‘½å‘¨æœŸ\" class=\"headerlink\" title=\"ç”Ÿå‘½å‘¨æœŸ\"></a>ç”Ÿå‘½å‘¨æœŸ</h2><h3 id=\"installing-çŠ¶æ€\"><a href=\"#installing-çŠ¶æ€\" class=\"headerlink\" title=\"installing çŠ¶æ€\"></a>installing çŠ¶æ€</h3><p>å½“æ³¨å†ŒæˆåŠŸåä¼šè§¦å‘<strong>install</strong>äº‹ä»¶ï¼Œç„¶åè§¦å‘<strong>activate</strong>äº‹ä»¶ï¼Œæ­¤æ—¶å¦‚æœå†æ¬¡åˆ·æ–°é¡µé¢ï¼Œå®ƒä¿©éƒ½ä¸ä¼šè¢«è§¦å‘äº†</p>\n<p>ç›´åˆ°<code>/sw.js</code>å‘ç”Ÿäº†æ”¹å˜ï¼Œå®ƒå°±ä¼šè§¦å‘ä¸€æ¬¡ <strong>install</strong> (ä¸ä»…ä»…æ˜¯ä»£ç æ”¹å˜ï¼Œå“ªæ€•æ˜¯å¤šä¸€ä¸ªç©ºæ ¼æˆ–æ˜¯å°‘ä¸€ä¸ªç©ºæ ¼ï¼Œåˆæˆ–æ˜¯å†™ä¸€ä¸ªæ³¨é‡Šéƒ½ä¼šè¢«è§¦å‘)ï¼Œä½†æ˜¯åªæ‰§è¡Œäº†<strong>install</strong>äº‹ä»¶ï¼Œå¹¶æ²¡æœ‰æ‰§è¡Œ<strong>activate</strong>äº‹ä»¶</p>\n<h3 id=\"activing-çŠ¶æ€\"><a href=\"#activing-çŠ¶æ€\" class=\"headerlink\" title=\"activing çŠ¶æ€\"></a>activing çŠ¶æ€</h3><p>ä¸ºä»€ä¹ˆ<strong>activate</strong>äº‹ä»¶ä¸è§¦å‘äº†ï¼Ÿå› ä¸ºå·²ç»æœ‰ä¸€ä¸ª sw äº†ï¼Œå®ƒä¸€ç§å¤„äºç­‰å¾…çŠ¶æ€ï¼Œè‡³äºä»€ä¹ˆæ—¶å€™æ‰ä¼šè¢«è§¦å‘ï¼Œé‚£å°±æ˜¯ç­‰ä¹‹å‰çš„ sw åœæ­¢äº†æ‰ä¼šè§¦å‘<strong>activate</strong>äº‹ä»¶</p>\n<p>é‚£æœ‰æ²¡æœ‰åŠæ³•ä¸è®©å®ƒç­‰å¾…å‘¢ï¼Ÿç­”æ¡ˆæ˜¯: <strong>æœ‰</strong></p>\n<p>ä½¿ç”¨<code>skipWaiting()</code>è·³è¿‡ç­‰å¾…ï¼Œå®ƒè¿”å›ä¸€ä¸ª promise å¯¹è±¡(å¼‚æ­¥çš„)ï¼Œé˜²æ­¢è¿˜åœ¨æ‰§è¡Œ<code>skipWaiting()</code>çš„æ—¶å€™ç›´æ¥å°±è·³åˆ°<strong>activate</strong>äº‹ä»¶ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨<code>async/await</code>ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨<code>event.waitUntil(skipWaiting())</code>æ–¹æ³•æŠŠ<code>skipWaiting()</code>æ”¾åˆ°é‡Œé¢ï¼Œå’Œ<code>async/await</code>æ•ˆæœä¸€æ ·</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// sw.js</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// åœ¨swä¸­å¯ä»¥ä½¿ç”¨thisæˆ–æ˜¯selfè¡¨ç¤ºè‡ªèº«</span></span><br><span class=\"line\">self.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&#x27;install&#x27;</span>, <span class=\"keyword\">async</span> (event) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"comment\">// event.waitUntil(self.skipWaiting())</span></span><br><span class=\"line\">  <span class=\"keyword\">await</span> self.<span class=\"title function_\">skipWaiting</span>()</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n\n<p>è§¦å‘<strong>activate</strong>äº‹ä»¶å ï¼Œå½“å‰è¿™ä¸€æ¬¡ç½‘é¡µæ˜¯ä¸ä¼šè¢« sw ç®¡ç†çš„ï¼Œéœ€è¦ä¸‹æ¬¡é¡µé¢åˆ·æ–°æ‰ä¼šè¢« sw ç®¡ç†ï¼Œé‚£æ€ä¹ˆè®©å®ƒç«‹å³ç®¡ç†é¡µé¢å‘¢ï¼Ÿ</p>\n<blockquote>\n<p>æ›´è¯¦ç»†è¯·çœ‹:<br><a href=\"https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerGlobalScope/skipWaiting\">https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerGlobalScope/skipWaiting</a> &gt; <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Clients/claim\">https://developer.mozilla.org/en-US/docs/Web/API/Clients/claim</a></p>\n</blockquote>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">self.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&#x27;activate&#x27;</span>, <span class=\"keyword\">async</span> (event) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"comment\">// event.waitUntil(self.clients.claim())</span></span><br><span class=\"line\">  <span class=\"keyword\">await</span> self.<span class=\"property\">clients</span>.<span class=\"title function_\">claim</span>() <span class=\"comment\">// ç«‹å³ç®¡ç†é¡µé¢</span></span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"å®‰è£…\"><a href=\"#å®‰è£…\" class=\"headerlink\" title=\"å®‰è£…\"></a>å®‰è£…</h2><p>è¯¦ç»†ä¸Šé¢ç”Ÿå‘½å‘¨æœŸå·²ç»è¯¦ç»†è¯´æ˜äº†</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// sw.js</span></span><br><span class=\"line\">self.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&#x27;install&#x27;</span>, <span class=\"keyword\">async</span> (event) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"comment\">// event.waitUntil(self.skipWaiting())</span></span><br><span class=\"line\">  <span class=\"keyword\">await</span> self.<span class=\"title function_\">skipWaiting</span>()</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"æ•è·è¯·æ±‚\"><a href=\"#æ•è·è¯·æ±‚\" class=\"headerlink\" title=\"æ•è·è¯·æ±‚\"></a>æ•è·è¯·æ±‚</h2><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// sw.js</span></span><br><span class=\"line\">self.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&#x27;fetch&#x27;</span>, <span class=\"keyword\">async</span> (event) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"comment\">// æ‰€æœ‰è¯·æ±‚éƒ½å¾—è½¬åˆ° handleRequest å‡½æ•°å†…å¤„ç†</span></span><br><span class=\"line\">  <span class=\"title function_\">handleRequest</span>(event.<span class=\"property\">request</span>)</span><br><span class=\"line\">    <span class=\"comment\">// å¦‚æœ handleRequest è¯·æ±‚æˆåŠŸåˆ™å°†æ•°æ®å“åº”åˆ°ç½‘é¡µ</span></span><br><span class=\"line\">    .<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">result</span>) =&gt;</span> event.<span class=\"title function_\">respondWith</span>(result))</span><br><span class=\"line\">    <span class=\"comment\">// å¦‚æœ handleRequest è¯·æ±‚å¤±è´¥ï¼Œä»€ä¹ˆéƒ½ä¸åš(è¿™æ˜¯ç½‘é¡µè‡ªå·±èµ°è‡ªå·±çš„å®é™…è¯·æ±‚)</span></span><br><span class=\"line\">    .<span class=\"title function_\">catch</span>(<span class=\"function\">() =&gt;</span> <span class=\"number\">0</span>)</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// å¤„ç†è¯·æ±‚</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">handleRequest</span>(<span class=\"params\">req</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"title function_\">fetch</span>(req.<span class=\"property\">url</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>event.respondWith()</code>: ç»™æµè§ˆå™¨ä¸€ä¸ªå“åº”ï¼Œå› ä¸ºæˆ‘ä»¬å·²ç»ä½¿ç”¨<code>Fetch API</code>æ›¿æµè§ˆå™¨å‘é€äº†è¯·æ±‚ï¼Œå¹¶ä¸”å¾—åˆ°äº†ç»“æœå¹¶ä¸”è¿”å›ï¼Œé‚£ä¹ˆè‡ªç„¶æ˜¯è¦è¿”å›ç»™æµè§ˆå™¨å•¦</p>\n<p><a href=\"https://developer.mozilla.org/zh-CN/docs/Web/API/Fetch_API\">Fetch API</a>å¯ä»¥å’Œ<code>XMLHttpRequest</code>ä¸€æ ·ï¼Œå¯ä»¥å‘é€ä»»ä½•è¯·æ±‚</p>\n<blockquote>\n<p>å€¼å¾—ä¸€æçš„æ˜¯ä½¿ç”¨ Fetch API å‘é€è¯·æ±‚æ˜¯ä¼šå­˜åœ¨è·¨åŸŸé—®é¢˜çš„ï¼Œä¸€æ—¦è¢«è·¨åŸŸæ‹¦æˆªï¼Œé‚£ä¹ˆå°±ä¸Šé¢éƒ½æ²¡æœ‰è¿”å›ï¼Œä¼šå¯¼è‡´é¡µé¢æ˜¾ç¤ºä¸äº†è¯·æ±‚çš„å†…å®¹(ä¾‹å¦‚å›¾ç‰‡è¢«è·¨åŸŸæ‹¦æˆªäº†)ï¼Œè€Œ imgã€script æ ‡ç­¾å®ƒä»¬æ˜¯ä¸ä¼šå‘ç”Ÿè·¨åŸŸè¯·æ±‚é—®é¢˜çš„ï¼Œæ‰€ä»¥ä¸Šé¢ catch æ•è·å¼‚å¸¸ä¸€ä¸ª 0 å’Œ null å·®ä¸å¤š<br>æ—¢ç„¶æ²¡æœ‰ç”¨åˆ° event.respondWith é‚£è‡ªç„¶æ˜¯æ²¡æœ‰ç»™æµè§ˆå™¨è¿”å›æ•°æ®å•¦ï¼Œé‚£æµè§ˆå™¨å°±è‡ªå·±è¯·æ±‚(å¾ˆå¥½çš„é¿å…äº†è¿™ä¸ªé—®é¢˜)</p>\n</blockquote>\n<h2 id=\"ç¯¡æ”¹è¯·æ±‚\"><a href=\"#ç¯¡æ”¹è¯·æ±‚\" class=\"headerlink\" title=\"ç¯¡æ”¹è¯·æ±‚\"></a>ç¯¡æ”¹è¯·æ±‚</h2><p>ä¸Šé¢æˆ‘ä»¬éƒ½å¯ä»¥ä½¿ç”¨<code>Fetch API</code>æ›¿æµè§ˆå™¨å‘é€è¯·æ±‚äº†ï¼Œé‚£æ˜¯ä¸æ˜¯å¯ä»¥ç¯¡æ”¹å‘¢ï¼Ÿ</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// å¤„ç†è¯·æ±‚</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">handleRequest</span>(<span class=\"params\">req</span>) &#123;</span><br><span class=\"line\">  <span class=\"comment\">// ä»…ä»…åªæ˜¯ä¸¾ä¸ªä¾‹å­ï¼Œæ›´å¤šå¥‡å¦™çš„ç”¨æ³•ç­‰å¾…ä½ å»æ¢ç´¢</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> str = <span class=\"string\">&#x27;https://cdn.jsdelivr.net/npm/xhr-ajax/dist/&#x27;</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> url = req.<span class=\"property\">url</span>.<span class=\"title function_\">replace</span>(str + <span class=\"string\">&#x27;ajax.js&#x27;</span>, str + <span class=\"string\">&#x27;ajax.min.js&#x27;</span>)</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"title function_\">fetch</span>(url)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>å¦‚ä¸Šä»£ç ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°† ajax è¯·æ±‚çš„ç¬¬ä¸‰æ–¹åº“ js æ–‡ä»¶è¯·æ±‚å˜ä¸ºå‹ç¼©åçš„è¯·æ±‚ï¼Œå¹¶è¿”å›ç»™æµè§ˆå™¨(ç¯¡æ”¹æˆåŠŸ)</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// æ‰¹é‡è¯·æ±‚</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">handleRequest</span>(<span class=\"params\">req</span>) &#123;</span><br><span class=\"line\">  <span class=\"comment\">// å¯ä»¥æ˜¯å¤šä¸ª</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> urls = [</span><br><span class=\"line\">    <span class=\"string\">&quot;https://cdn.jsdelivr.net/npm/xhr-ajax/dist/ajax.min.js&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;https://unpkg.com/xhr-ajax/dist/ajax.min.js&quot;</span>,</span><br><span class=\"line\">  ];</span><br><span class=\"line\">  <span class=\"comment\">// ä¸­æ–­ä¸€ä¸ªæˆ–å¤šä¸ªè¯·æ±‚</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> controller = <span class=\"keyword\">new</span> <span class=\"title class_\">AbortController</span>();</span><br><span class=\"line\">  <span class=\"comment\">// å¯ä»¥ä¸­æ–­è¯·æ±‚</span></span><br><span class=\"line\">  <span class=\"comment\">// https://developer.mozilla.org/zh-CN/docs/Web/API/AbortController#%E5%B1%9E%E6%80%A7</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> signal = controller.<span class=\"property\">signal</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// éå†å°†æ‰€æœ‰çš„è¯·æ±‚åœ°å€è½¬æ¢ä¸ºpromise</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"title class_\">PromiseAll</span> = urls.<span class=\"title function_\">map</span>(<span class=\"function\">(<span class=\"params\">url</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"keyword\">async</span> (resolve, reject) =&gt; &#123;</span><br><span class=\"line\">      <span class=\"title function_\">fetch</span>(url, &#123; signal &#125;)</span><br><span class=\"line\">        .<span class=\"title function_\">then</span>(</span><br><span class=\"line\">          <span class=\"function\">(<span class=\"params\">res</span>) =&gt;</span></span><br><span class=\"line\">            <span class=\"keyword\">new</span> <span class=\"title class_\">Response</span>(<span class=\"keyword\">await</span> res.<span class=\"title function_\">arrayBuffer</span>(), &#123;</span><br><span class=\"line\">              <span class=\"attr\">status</span>: res.<span class=\"property\">status</span>,</span><br><span class=\"line\">              <span class=\"attr\">headers</span>: res.<span class=\"property\">headers</span>,</span><br><span class=\"line\">            &#125;)</span><br><span class=\"line\">        )</span><br><span class=\"line\">        .<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">res</span>) =&gt;</span> &#123;</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (res.<span class=\"property\">status</span> !== <span class=\"number\">200</span>) <span class=\"title function_\">reject</span>(<span class=\"literal\">null</span>);</span><br><span class=\"line\">          <span class=\"comment\">// åªè¦æœ‰ä¸€ä¸ªè¯·æ±‚æˆåŠŸè¿”å›é‚£ä¹ˆå°±æŠŠæ‰€æœ‰çš„è¯·æ±‚æ–­å¼€</span></span><br><span class=\"line\">          controller.<span class=\"title function_\">abort</span>(); <span class=\"comment\">// ä¸­æ–­</span></span><br><span class=\"line\">          <span class=\"title function_\">resolve</span>(res);</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        .<span class=\"title function_\">catch</span>(<span class=\"function\">() =&gt;</span> <span class=\"title function_\">reject</span>(<span class=\"literal\">null</span>));</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">  <span class=\"comment\">// ä½¿ç”¨ Promise.any å‘é€æ‰¹é‡è¯·æ±‚ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ï¼Œä¾‹å¦‚æ•°ç»„å°±æ˜¯ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡</span></span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"title class_\">Promise</span>.<span class=\"title function_\">any</span>(<span class=\"title class_\">PromiseAll</span>)</span><br><span class=\"line\">    .<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">res</span>) =&gt;</span> res)</span><br><span class=\"line\">    .<span class=\"title function_\">catch</span>(<span class=\"function\">() =&gt;</span> <span class=\"literal\">null</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>Promise.any å…·ä½“è¯·çœ‹: <a href=\"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise/any\">https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise/any</a><br>AbortController å…·ä½“è¯·çœ‹: <a href=\"https://developer.mozilla.org/zh-CN/docs/Web/API/AbortController\">https://developer.mozilla.org/zh-CN/docs/Web/API/AbortController</a></p>\n</blockquote>\n<p>åªè¦ä¼ å…¥çš„è¿­ä»£å¯¹è±¡ä¸­çš„ä»»ä½•ä¸€ä¸ª <code>promise</code> è¿”å›æˆåŠŸï¼ˆresolveï¼‰çŠ¶æ€ï¼Œé‚£ä¹ˆå®ƒå°±è¿”å›æˆåŠŸçŠ¶æ€ï¼Œå¦‚æœå…¶ä¸­çš„æ‰€æœ‰çš„ <code>promises</code> éƒ½å¤±è´¥ï¼Œé‚£ä¹ˆå°±ä¼šæŠŠæ‰€æœ‰çš„å¤±è´¥è¿”å›</p>\n<p>æ‰€ä»¥åªè¦<code>Promise.any</code>æœ‰ä¸€ä¸ªæˆåŠŸçŠ¶æ€çš„æ•°æ®è¿”å›ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æŠŠè¿™ä¸ªæ•°æ®å“åº”ç»™æµè§ˆå™¨ï¼Œè€Œå…¶å®ƒ çš„è¯·æ±‚å…¨éƒ¨åˆ‡æ–­ï¼Œè¿™æ ·å°±å¯ä»¥é«˜æ•ˆçš„åœ¨ä¸åŒåœ°åŒºå“åº”æœ€å¿«çš„èµ„æºç»™ç”¨æˆ·å•¦~</p>\n<p>è¿™ä¹Ÿæ˜¯æ­£æ–‡å¼€å§‹å‰æˆ‘ä»¬æ‰€éœ€è¦è§£å†³çš„é—®é¢˜</p>\n<h2 id=\"å®Œæ•´-sw-js-æ–‡ä»¶\"><a href=\"#å®Œæ•´-sw-js-æ–‡ä»¶\" class=\"headerlink\" title=\"å®Œæ•´ sw.js æ–‡ä»¶\"></a>å®Œæ•´ sw.js æ–‡ä»¶</h2><p>è¿™æ˜¯æˆ‘æ€»ç»“å†™å‡ºçš„ä¸€ä¸ª sw.js æ–‡ä»¶ï¼Œä½ åªéœ€è¦å°†ä¸‹é¢çš„<code>origin</code>æ•°ç»„æ”¹æˆä½ çš„åšå®¢åœ°å€å°±å¯ä»¥äº†ï¼Œå…¶å®ƒçš„å¯ä»¥ä¸ç”¨åŠ¨ï¼Œå¦‚æœä½ æƒ³æ·»åŠ æ–°ä¸œè¥¿ï¼Œé‚£å°±éšä¾¿ä½ å•¦~å“ˆå“ˆå“ˆ</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> origin = [<span class=\"string\">&#x27;https://blog.imlete.cn&#x27;</span>, <span class=\"string\">&#x27;https://lete114.github.io&#x27;</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> cdn = &#123;</span><br><span class=\"line\">  <span class=\"attr\">gh</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">jsdelivr</span>: <span class=\"string\">&#x27;https://cdn.jsdelivr.net/gh&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">fastly</span>: <span class=\"string\">&#x27;https://fastly.jsdelivr.net/gh&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">gcore</span>: <span class=\"string\">&#x27;https://gcore.jsdelivr.net/gh&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">testingcf</span>: <span class=\"string\">&#x27;https://testingcf.jsdelivr.net/gh&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">test1</span>: <span class=\"string\">&#x27;https://test1.jsdelivr.net/gh&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">tianli</span>: <span class=\"string\">&#x27;https://cdn1.tianli0.top/gh&#x27;</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">combine</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">jsdelivr</span>: <span class=\"string\">&#x27;https://cdn.jsdelivr.net/combine&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">fastly</span>: <span class=\"string\">&#x27;https://fastly.jsdelivr.net/combine&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">gcore</span>: <span class=\"string\">&#x27;https://gcore.jsdelivr.net/combine&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">testingcf</span>: <span class=\"string\">&#x27;https://testingcf.jsdelivr.net/combine&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">test1</span>: <span class=\"string\">&#x27;https://test1.jsdelivr.net/combine&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">tianli</span>: <span class=\"string\">&#x27;https://cdn1.tianli0.top/combine&#x27;</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">npm</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">jsdelivr</span>: <span class=\"string\">&#x27;https://cdn.jsdelivr.net/npm&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">fastly</span>: <span class=\"string\">&#x27;https://fastly.jsdelivr.net/npm&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">gcore</span>: <span class=\"string\">&#x27;https://gcore.jsdelivr.net/npm&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">testingcf</span>: <span class=\"string\">&#x27;https://testingcf.jsdelivr.net/npm&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">test1</span>: <span class=\"string\">&#x27;https://test1.jsdelivr.net/npm&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">unpkg</span>: <span class=\"string\">&#x27;https://unpkg.com&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">tianli</span>: <span class=\"string\">&#x27;https://cdn1.tianli0.top/npm&#x27;</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">self.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&#x27;install&#x27;</span>, <span class=\"keyword\">async</span> () =&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">await</span> self.<span class=\"title function_\">skipWaiting</span>()</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">self.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&#x27;activate&#x27;</span>, <span class=\"keyword\">async</span> () =&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">await</span> self.<span class=\"property\">clients</span>.<span class=\"title function_\">claim</span>()</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">self.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&#x27;fetch&#x27;</span>, <span class=\"keyword\">async</span> (event) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">    event.<span class=\"title function_\">respondWith</span>(<span class=\"title function_\">handleRequest</span>(event.<span class=\"property\">request</span>))</span><br><span class=\"line\">  &#125; <span class=\"keyword\">catch</span> (e) &#123;&#125;</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// è¿”å›å“åº”</span></span><br><span class=\"line\"><span class=\"keyword\">async</span> <span class=\"keyword\">function</span> <span class=\"title function_\">progress</span>(<span class=\"params\">res</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Response</span>(<span class=\"keyword\">await</span> res.<span class=\"title function_\">arrayBuffer</span>(), &#123;</span><br><span class=\"line\">    <span class=\"attr\">status</span>: res.<span class=\"property\">status</span>,</span><br><span class=\"line\">    <span class=\"attr\">headers</span>: res.<span class=\"property\">headers</span></span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">handleRequest</span>(<span class=\"params\">req</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> urls = []</span><br><span class=\"line\">  <span class=\"keyword\">const</span> urlStr = req.<span class=\"property\">url</span></span><br><span class=\"line\">  <span class=\"keyword\">let</span> urlObj = <span class=\"keyword\">new</span> <span class=\"title function_\">URL</span>(urlStr)</span><br><span class=\"line\">  <span class=\"comment\">// ä¸ºäº†è·å– cdn ç±»å‹</span></span><br><span class=\"line\">  <span class=\"comment\">// ä¾‹å¦‚è·å–gh (https://cdn.jsdelivr.net/gh)</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> path = urlObj.<span class=\"property\">pathname</span>.<span class=\"title function_\">split</span>(<span class=\"string\">&#x27;/&#x27;</span>)[<span class=\"number\">1</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// åŒ¹é… cdn</span></span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">const</span> type <span class=\"keyword\">in</span> cdn) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (type === path) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">for</span> (<span class=\"keyword\">const</span> key <span class=\"keyword\">in</span> cdn[type]) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">const</span> url = cdn[type][key] + urlObj.<span class=\"property\">pathname</span>.<span class=\"title function_\">replace</span>(<span class=\"string\">&#x27;/&#x27;</span> + path, <span class=\"string\">&#x27;&#x27;</span>)</span><br><span class=\"line\">        urls.<span class=\"title function_\">push</span>(url)</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// å¦‚æœä¸Šæ–¹ cdn éå† åŒ¹é…åˆ° cdn åˆ™ç›´æ¥ç»Ÿä¸€å‘é€è¯·æ±‚(ä¸ä¼šå¾€ä¸‹æ‰§è¡Œäº†)</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (urls.<span class=\"property\">length</span>) <span class=\"keyword\">return</span> <span class=\"title function_\">fetchAny</span>(urls)</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// å°†ç”¨æˆ·è®¿é—®çš„å½“å‰ç½‘ç«™ä¸æ‰€æœ‰æºç«™åˆå¹¶</span></span><br><span class=\"line\">  <span class=\"keyword\">let</span> origins = [...<span class=\"keyword\">new</span> <span class=\"title class_\">Set</span>([location.<span class=\"property\">origin</span>, ...origin])]</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// éå†åˆ¤æ–­å½“å‰è¯·æ±‚æ˜¯å¦æ˜¯æºç«™ä¸»æœº</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> is = origins.<span class=\"title function_\">find</span>(<span class=\"function\">(<span class=\"params\">i</span>) =&gt;</span> <span class=\"keyword\">new</span> <span class=\"title function_\">URL</span>(urlStr).<span class=\"property\">hostname</span> === <span class=\"keyword\">new</span> <span class=\"title function_\">URL</span>(i).<span class=\"property\">hostname</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// å¦‚æœæ˜¯æºç«™ï¼Œåˆ™ç«é€Ÿè·å–(ä¸ä¼šå¾€ä¸‹æ‰§è¡Œäº†)</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (is) &#123;</span><br><span class=\"line\">    origins = origins.<span class=\"title function_\">map</span>(<span class=\"function\">(<span class=\"params\">i</span>) =&gt;</span> i + urlObj.<span class=\"property\">pathname</span> + urlObj.<span class=\"property\">search</span>)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"title function_\">fetchAny</span>(origins)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"comment\">// æŠ›å‡ºå¼‚å¸¸æ˜¯ä¸ºäº†è®©swä¸æ‹¦æˆªè¯·æ±‚</span></span><br><span class=\"line\">  <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Error</span>(<span class=\"string\">&#x27;ä¸æ˜¯æºç«™&#x27;</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Promise.any çš„ polyfill</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">createPromiseAny</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"title class_\">Promise</span>.<span class=\"property\">any</span> = <span class=\"keyword\">function</span> (<span class=\"params\">promises</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">      promises = <span class=\"title class_\">Array</span>.<span class=\"title function_\">isArray</span>(promises) ? promises : []</span><br><span class=\"line\">      <span class=\"keyword\">let</span> len = promises.<span class=\"property\">length</span></span><br><span class=\"line\">      <span class=\"keyword\">let</span> errs = []</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (len === <span class=\"number\">0</span>) <span class=\"keyword\">return</span> <span class=\"title function_\">reject</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">AggregateError</span>(<span class=\"string\">&#x27;All promises were rejected&#x27;</span>))</span><br><span class=\"line\">      promises.<span class=\"title function_\">forEach</span>(<span class=\"function\">(<span class=\"params\">p</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!p <span class=\"keyword\">instanceof</span> <span class=\"title class_\">Promise</span>) <span class=\"keyword\">return</span> <span class=\"title function_\">reject</span>(p)</span><br><span class=\"line\">        p.<span class=\"title function_\">then</span>(</span><br><span class=\"line\">          <span class=\"function\">(<span class=\"params\">res</span>) =&gt;</span> <span class=\"title function_\">resolve</span>(res),</span><br><span class=\"line\">          <span class=\"function\">(<span class=\"params\">err</span>) =&gt;</span> &#123;</span><br><span class=\"line\">            len--</span><br><span class=\"line\">            errs.<span class=\"title function_\">push</span>(err)</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (len === <span class=\"number\">0</span>) <span class=\"title function_\">reject</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">AggregateError</span>(errs))</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        )</span><br><span class=\"line\">      &#125;)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// å‘é€æ‰€æœ‰è¯·æ±‚</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">fetchAny</span>(<span class=\"params\">urls</span>) &#123;</span><br><span class=\"line\">  <span class=\"comment\">// ä¸­æ–­ä¸€ä¸ªæˆ–å¤šä¸ªè¯·æ±‚</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> controller = <span class=\"keyword\">new</span> <span class=\"title class_\">AbortController</span>()</span><br><span class=\"line\">  <span class=\"keyword\">const</span> signal = controller.<span class=\"property\">signal</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// éå†å°†æ‰€æœ‰çš„è¯·æ±‚åœ°å€è½¬æ¢ä¸ºpromise</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"title class_\">PromiseAll</span> = urls.<span class=\"title function_\">map</span>(<span class=\"function\">(<span class=\"params\">url</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"title function_\">fetch</span>(url, &#123; signal &#125;)</span><br><span class=\"line\">        .<span class=\"title function_\">then</span>(progress)</span><br><span class=\"line\">        .<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">res</span>) =&gt;</span> &#123;</span><br><span class=\"line\">          <span class=\"keyword\">const</span> r = res.<span class=\"title function_\">clone</span>()</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (r.<span class=\"property\">status</span> !== <span class=\"number\">200</span>) <span class=\"title function_\">reject</span>(<span class=\"literal\">null</span>)</span><br><span class=\"line\">          controller.<span class=\"title function_\">abort</span>() <span class=\"comment\">// ä¸­æ–­</span></span><br><span class=\"line\">          <span class=\"title function_\">resolve</span>(r)</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        .<span class=\"title function_\">catch</span>(<span class=\"function\">() =&gt;</span> <span class=\"title function_\">reject</span>(<span class=\"literal\">null</span>))</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// åˆ¤æ–­æµè§ˆå™¨æ˜¯å¦æ”¯æŒ Promise.any</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (!<span class=\"title class_\">Promise</span>.<span class=\"property\">any</span>) <span class=\"title function_\">createPromiseAny</span>()</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// è°å…ˆè¿”å›&quot;æˆåŠŸçŠ¶æ€&quot;åˆ™è¿”å›è°çš„å†…å®¹ï¼Œå¦‚æœéƒ½è¿”å›&quot;å¤±è´¥çŠ¶æ€&quot;åˆ™è¿”å›null</span></span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"title class_\">Promise</span>.<span class=\"title function_\">any</span>(<span class=\"title class_\">PromiseAll</span>)</span><br><span class=\"line\">    .<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">res</span>) =&gt;</span> res)</span><br><span class=\"line\">    .<span class=\"title function_\">catch</span>(<span class=\"function\">() =&gt;</span> <span class=\"literal\">null</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n",
            "tags": [
                "JavaScript",
                "æ•™ç¨‹"
            ]
        },
        {
            "id": "https://blog.imlete.cn/article/Parse-get-url-string.html",
            "url": "https://blog.imlete.cn/article/Parse-get-url-string.html",
            "title": "NodeJS è§£æ GET è¯·æ±‚ url å­—ç¬¦ä¸²",
            "date_published": "2022-03-06T17:29:57.000Z",
            "content_html": "<h2 id=\"å‰è¨€\"><a href=\"#å‰è¨€\" class=\"headerlink\" title=\"å‰è¨€\"></a>å‰è¨€</h2><p>å½“ä½ ä½¿ç”¨<code>querystring.parse()</code>æˆ–è€…æ˜¯<code>url.parse()</code>æ—¶ä¼šå¾—åˆ°ä¸€ä¸ªè­¦å‘Š<code>@deprecated â€” since v11.0.0 - Use the WHATWG URL API.</code></p>\n<p>ç”±äº <code>url.parse()</code> æ–¹æ³•ä½¿ç”¨ä¸€ç§å®½æ¾çš„éæ ‡å‡†ç®—æ³•æ¥è§£æç½‘å€å­—ç¬¦ä¸²ï¼Œå› æ­¤å¯èƒ½ä¼šå¼•å…¥å®‰å…¨é—®é¢˜<br>å…·ä½“æ¥è¯´ï¼Œå·²ç»ç¡®å®šäº†ä¸»æœºåæ¬ºéª—ä»¥åŠç”¨æˆ·åå’Œå¯†ç å¤„ç†ä¸å½“çš„é—®é¢˜</p>\n<p><code>url.parse()</code>åœ¨<code>v11.0.0</code>å¼€å§‹è¢«æ‰“ä¸Š<code>@deprecated</code>æ³¨è§£(ä¹Ÿä¸çŸ¥é“å«åšæ³¨è§£åˆä¸åˆç†ï¼Œå¯èƒ½æ˜¯ java å†™å¤šäº†å§)ï¼Œåœ¨<code>v16.0.0</code>åè¢«å®Œå…¨ç§»é™¤ï¼ŒåŒæ—¶è¿˜ä¸€å¹¶ç§»é™¤çš„æœ‰<code>url.format()</code> <code>url.resolve()</code></p>\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * åœ¨ querystring çš„ TS æºç å¼€å¤´å·²ç»è¢«æ‰“ä¸Šäº† <span class=\"doctag\">@deprecated</span> å…·ä½“è¯´æ˜æ—¶å€™è¢«å®Œå…¨ç§»é™¤ç›®å‰è¿˜ä¸å¾—è€ŒçŸ¥</span></span><br><span class=\"line\"><span class=\"comment\"> * éƒ¨åˆ†æ³¨é‡Šå·²è¢«æˆ‘è¢«åˆ é™¤</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@deprecated</span> <span class=\"variable\">Legacy</span></span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@see</span> [source](https://github.com/nodejs/node/blob/v17.0.0/lib/querystring.js)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">declare</span> <span class=\"variable language_\">module</span> <span class=\"string\">&quot;querystring&quot;</span> &#123;&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight ts\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">declare</span> <span class=\"variable language_\">module</span> <span class=\"string\">&quot;url&quot;</span> &#123;</span><br><span class=\"line\">  <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">   * åœ¨ url çš„ TS æºç é‡Œ parse() å·²ç»è¢«æ‰“ä¸Šäº† <span class=\"doctag\">@deprecated</span> ä»v11.0.0å¼€å§‹ï¼Œåˆ°v16.0.0è¢«ç§»é™¤</span></span><br><span class=\"line\"><span class=\"comment\">   * éƒ¨åˆ†æ³¨é‡Šå·²è¢«æˆ‘è¢«åˆ é™¤</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@since</span> v0.1.25</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@deprecated</span> Legacy: Use the WHATWG URL API instead.</span></span><br><span class=\"line\"><span class=\"comment\">   * <span class=\"doctag\">@param</span> urlString The URL string to parse.</span></span><br><span class=\"line\"><span class=\"comment\">   * éƒ¨åˆ†æ³¨é‡Šå·²è¢«æˆ‘è¢«åˆ é™¤</span></span><br><span class=\"line\"><span class=\"comment\">   */</span></span><br><span class=\"line\">  <span class=\"keyword\">function</span> <span class=\"title function_\">parse</span>(<span class=\"params\">urlString: <span class=\"built_in\">string</span></span>): <span class=\"title class_\">UrlWithStringQuery</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"ä¸ºä»€ä¹ˆï¼Ÿ\"><a href=\"#ä¸ºä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆï¼Ÿ\"></a>ä¸ºä»€ä¹ˆï¼Ÿ</h2><p>è¿™æ˜¯å› ä¸º nodejs çš„<code>url.parse</code>æ–¹æ³•é‡‡ç”¨çš„ä¼ ç»Ÿçš„<code>urlObject</code>ï¼Œä¸ç¬¦åˆ<a href=\"https://url.spec.whatwg.org/#goals\">URL æ ‡å‡†</a>,å› æ­¤è¢«å¼ƒç”¨</p>\n<p><a href=\"https://developer.mozilla.org/zh-CN/docs/Glossary/WHATWG\">WHATWG</a> æ˜¯ <em>(Web Hypertext Application Technology Working GroupWeb è¶…æ–‡æœ¬åº”ç”¨ç¨‹åºæŠ€æœ¯å·¥ä½œç»„)</em></p>\n<h2 id=\"ä½¿ç”¨-URL\"><a href=\"#ä½¿ç”¨-URL\" class=\"headerlink\" title=\"ä½¿ç”¨ URL\"></a>ä½¿ç”¨ URL</h2><p>ä½¿ç”¨ URL ç±»å¯¹ url è¿›è¡Œæ“ä½œï¼Œ<a href=\"https://nodejs.org/api/url.html#url_the_whatwg_url_api\">è¯¦ç»†æ–‡æ¡£è§</a>(å¯å°†åŸŸååçš„ org æ”¹ä¸º cn çœ‹ä¸­æ–‡æ–‡æ¡£)</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> urlStr = <span class=\"string\">&quot;https://example.org/foo?name=zhangsan&amp;age=18&quot;</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> url = <span class=\"keyword\">new</span> <span class=\"title function_\">URL</span>(urlStr);</span><br><span class=\"line\"><span class=\"comment\">// searchParams ç”¨çš„æ˜¯ URLSearchParams API</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> name = url.<span class=\"property\">searchParams</span>.<span class=\"title function_\">get</span>(<span class=\"string\">&quot;name&quot;</span>);</span><br><span class=\"line\"><span class=\"keyword\">const</span> age = url.<span class=\"property\">searchParams</span>.<span class=\"title function_\">get</span>(<span class=\"string\">&quot;age&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(name); <span class=\"comment\">// zhangsan</span></span><br><span class=\"line\"><span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(age); <span class=\"comment\">// 18</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"æ­£æ–‡\"><a href=\"#æ­£æ–‡\" class=\"headerlink\" title=\"æ­£æ–‡\"></a>æ­£æ–‡</h2><p>å‰é¢è„†çš®äº†é‚£ä¹ˆå¤šå†…å®¹ï¼Œç°åœ¨æ‰æ˜¯æœ¬æ–‡çš„ä¸»è¦å†…å®¹</p>\n<p>æˆ‘ä»¬å¯ä»¥è¿™ä¹ˆå†™æ¥è§£æ get è¯·æ±‚çš„å‚æ•°<br>è®¿é—®: <code>http://localhost:3000/foo?name=zhangsan&amp;age=18</code></p>\n<blockquote>\n<p>å› ä¸ºæˆ‘æ¯”è¾ƒæ‡’ï¼Œæˆ‘å°±ä¸å†™é‚£ä¹ˆå¤šç¤ºä¾‹ä»£ç äº†ï¼Œå…¨éƒ¨å¡åˆ°ä¸€ä¸ªä»£ç ç¤ºä¾‹é‡Œï¼Œå¤§å®¶å‹‰å¼ºçœ‹ä¸€ä¸‹æ³¨é‡Šå§<br>ä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘å°è£…æˆäº†ä¸€ä¸ªåº“ï¼Œå¯ä»¥è·å–POSTã€GETè¯·æ±‚çš„å‚æ•°ï¼Œè§‰å¾—å¯ä»¥çš„è¯å¯ä»¥ç‚¹ä¸ªstarâœ¨æ”¯æŒä¸€ä¸‹ğŸ˜<br>é¡¹ç›®åœ°å€: <a href=\"https://github.com/Lete114/Body-Data\">Body-Data: https://github.com/Lete114/Body-Data</a></p>\n</blockquote>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> http = <span class=\"built_in\">require</span>(<span class=\"string\">&quot;http&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> server = http.<span class=\"title function_\">createServer</span>(<span class=\"function\">(<span class=\"params\">req, res</span>) =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (req.<span class=\"property\">url</span> === <span class=\"string\">&quot;/favicon.ico&quot;</span>) <span class=\"keyword\">return</span> res.<span class=\"title function_\">end</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// req.urlå«é—®å·å‰é¢çš„å†…å®¹: /foo?name=zhangsan&amp;age=18</span></span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(req.<span class=\"property\">url</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// ä¹Ÿå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä¸¤è¡Œä»£ç ç§»é™¤ ?&quot;é—®å·&quot; å‰é¢çš„å†…å®¹</span></span><br><span class=\"line\">  <span class=\"comment\">//   const index = url.indexOf(&#x27;?&#x27;) + 1</span></span><br><span class=\"line\">  <span class=\"comment\">//   const string = url.substring(index)</span></span><br><span class=\"line\">  <span class=\"comment\">//   const query = new URLSearchParams(string);</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// è¿™æ˜¯ä¸ºäº†è§£æå‡ºsearchï¼Œsearchä¸å« ?&quot;é—®å·&quot; å‰é¢çš„å†…å®¹</span></span><br><span class=\"line\">  <span class=\"comment\">// ä¹Ÿå°±æ˜¯ name=zhangsan&amp;age=18</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> url = <span class=\"keyword\">new</span> <span class=\"title function_\">URL</span>(req.<span class=\"property\">url</span>, <span class=\"string\">`http://<span class=\"subst\">$&#123;req.headers.host&#125;</span>/`</span>);</span><br><span class=\"line\">  <span class=\"keyword\">const</span> query = <span class=\"keyword\">new</span> <span class=\"title class_\">URLSearchParams</span>(url.<span class=\"property\">search</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(query.<span class=\"title function_\">get</span>(<span class=\"string\">&quot;name&quot;</span>)); <span class=\"comment\">// zhangsan</span></span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(query.<span class=\"title function_\">entries</span>()); <span class=\"comment\">// URLSearchParams Iterator &#123; [ &#x27;name&#x27;, &#x27;zhangsan&#x27; ], [ &#x27;age&#x27;, &#x27;18&#x27; ] &#125;</span></span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(query.<span class=\"title function_\">keys</span>()); <span class=\"comment\">// URLSearchParams Iterator &#123; &#x27;name&#x27;, &#x27;age&#x27; &#125;</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// å®šä¹‰ä¸€ä¸ªç©ºå¯¹è±¡</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> params1 = &#123;&#125;;</span><br><span class=\"line\">  <span class=\"comment\">// å¦‚æœforå¾ªç¯å†…åªæœ‰1è¡Œä»£ç æ˜¯å¯ä»¥ç®€å†™æˆ1è¡Œçš„ï¼Œå¦‚ä¸‹</span></span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">const</span> i <span class=\"keyword\">of</span> query.<span class=\"title function_\">keys</span>()) params1[i] = query.<span class=\"title function_\">get</span>(i);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// ä½¿ç”¨entries()ä¹Ÿå¯ä»¥</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> params2 = &#123;&#125;;</span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">const</span> i <span class=\"keyword\">of</span> query.<span class=\"title function_\">entries</span>()) params2[i[<span class=\"number\">0</span>]] = i[<span class=\"number\">1</span>];</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// ä½¿ç”¨ Object.fromEntries()</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> params3 = <span class=\"title class_\">Object</span>.<span class=\"title function_\">fromEntries</span>(query);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(params1); <span class=\"comment\">// &#123; name: &#x27;zhangsan&#x27;, age: &#x27;18&#x27; &#125;</span></span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(params2); <span class=\"comment\">// &#123; name: &#x27;zhangsan&#x27;, age: &#x27;18&#x27; &#125;</span></span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(params3); <span class=\"comment\">// &#123; name: &#x27;zhangsan&#x27;, age: &#x27;18&#x27; &#125;</span></span><br><span class=\"line\"></span><br><span class=\"line\">  res.<span class=\"title function_\">end</span>(<span class=\"title class_\">JSON</span>.<span class=\"title function_\">stringify</span>(params3));</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">server.<span class=\"title function_\">listen</span>(<span class=\"number\">3000</span>);</span><br></pre></td></tr></table></figure>\n",
            "tags": [
                "JavaScript",
                "Node"
            ]
        },
        {
            "id": "https://blog.imlete.cn/article/async-await-error-handling.html",
            "url": "https://blog.imlete.cn/article/async-await-error-handling.html",
            "title": "å¦‚ä½•ä¼˜é›…çš„å¤„ç†async/awaité”™è¯¯ä¿¡æ¯",
            "date_published": "2021-11-12T16:42:37.000Z",
            "content_html": "<h2 id=\"åºŸè¯\"><a href=\"#åºŸè¯\" class=\"headerlink\" title=\"åºŸè¯\"></a>åºŸè¯</h2><p>åœ¨å®é™…å¼€å‘ä¸­ï¼Œç”¨åˆ°äº†ä¸€äº›å¼‚æ­¥å‡½æ•°æˆ–æ˜¯è¯·æ±‚ã€‚ä½ å¯èƒ½ä¼šå†™<code>.then()</code>å’Œ<code>.catch()</code>æ¥å¤„ç†å¼‚æ­¥çš„æˆåŠŸä¸å¤±è´¥<br>é‚£ä¹ˆå¦‚æœè¿™ä¸ª<code>.then()</code>é‡Œåˆæœ‰ä¸€ä¸ªè¯·æ±‚ï¼Œé‚£ä¹ˆæ—¶ä¸æ—¶åˆå¾—å†™<code>.then()</code>å’Œ<code>.catch()</code>ï¼Œé‚£ä¹ˆå¾ˆæœ‰å¯èƒ½<code>.catch()</code>é‡Œä¹Ÿæœ‰å‘¢ï¼Ÿ</p>\n<blockquote>\n<p>è¿™é‡Œå°±ä¸å¤šè¯´ä»€ä¹ˆå›è°ƒåœ°ç‹±çš„é—®é¢˜äº†<br>ä½ å¯èƒ½å°±ä¼šç”¨<code>async</code>å’Œ<code>await</code>æ¥å¤„ç†å¼‚æ­¥è¯·æ±‚ï¼Œä½†è¿™ä¹Ÿå°±ä¼šéšç€äº§ç”Ÿä¸€ä¸ªé—®é¢˜ï¼Œé‚£å°±æ˜¯<code>await</code>å®ƒæ— æ³•æ•è·å¼‚æ­¥è¯·æ±‚çš„é”™è¯¯å•Š</p>\n</blockquote>\n<p>è¿™æ—¶ä½ åˆæƒ³åˆ°ï¼Œé‚£æˆ‘åŒ…ä¸€å±‚<code>try...catch</code>ä¸å°±å¥½äº†å—ï¼Ÿ<br>ä½†æ˜¯è¿™ä»…ä»…åªèƒ½å¤„ç†å½“å‰è¿™ä¸ªæ–¹æ³•çš„é”™è¯¯ï¼Œå¦‚æœè¿™ä¸ªæ–¹æ³•é‡Œåˆå¤šä¸ªè¯·æ±‚æˆ–è€…è¯´æ˜¯å…¶ä»–åŒæ­¥ä»£ç äº§ç”Ÿçš„é—®é¢˜ï¼Œé”™è¯¯ä¹Ÿåªèƒ½å®šä½åˆ°è¿™ä¸ªæ–¹æ³•ã€‚<br><code>try...catch</code>å¯¹ä»£ç çš„å¯è¯»æ€§ä¸æ˜¯å¾ˆå‹å¥½(ä¸ªäººè§‰å¾—)</p>\n<blockquote>\n<p>å¦‚æœä½ è§‰å¾—ä¸Šé¢æ‰€è¯´çš„ï¼Œä½ è§‰å¾—å¾ˆ okï¼Œå°±æ˜¯è¦ç”¨ä¸Šé¢è¯´çš„<code>try...catch</code>è¿˜æ˜¯<code>.then()</code>å’Œ<code>.catch()</code>ï¼Œå°±éšä¾¿ä½ <br>èåœé’èœï¼Œå„æœ‰æ‰€çˆ±(ä½ æƒ³ç”¨å•¥å°±ç”¨å•¥)</p>\n</blockquote>\n<h2 id=\"æ­£æ–‡\"><a href=\"#æ­£æ–‡\" class=\"headerlink\" title=\"æ­£æ–‡\"></a>æ­£æ–‡</h2><p>ç°åœ¨æœ‰å¦‚ä¸‹ä»£ç :</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// æˆåŠŸ</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">Success</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">setTimeout</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"title function_\">resolve</span>(<span class=\"string\">&quot;Run Success&quot;</span>);</span><br><span class=\"line\">    &#125;, <span class=\"number\">500</span>);</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// å¤±è´¥</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">UnSuccess</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">setTimeout</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"title function_\">reject</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">Error</span>(<span class=\"string\">&quot;Run Error&quot;</span>));</span><br><span class=\"line\">    &#125;, <span class=\"number\">500</span>);</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">async</span> <span class=\"keyword\">function</span> <span class=\"title function_\">run</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;start&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">const</span> result = <span class=\"keyword\">await</span> <span class=\"title class_\">Success</span>();</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;result:&quot;</span>, result);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;end&quot;</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"title function_\">run</span>();</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"then-catch\"><a href=\"#then-catch\" class=\"headerlink\" title=\"then-catch\"></a>then-catch</h2><p>ç”¨<code>.then()</code>å’Œ<code>.catch()</code>æ¥å¤„ç†</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">async</span> <span class=\"keyword\">function</span> <span class=\"title function_\">run</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;start&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"title class_\">UnSuccess</span>()</span><br><span class=\"line\">    .<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">res</span>) =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;result:&quot;</span>, res);</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    .<span class=\"title function_\">catch</span>(<span class=\"function\">(<span class=\"params\">err</span>) =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;å‘ç”Ÿäº†é”™è¯¯ï¼&quot;</span>);</span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(err);</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    .<span class=\"title function_\">then</span>(<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;end&quot;</span>);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"try-catch\"><a href=\"#try-catch\" class=\"headerlink\" title=\"try-catch\"></a>try-catch</h2><p>ç”¨<code>try...catch</code>æ¥å¤„ç†</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">async</span> <span class=\"keyword\">function</span> <span class=\"title function_\">run</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;start&quot;</span>);</span><br><span class=\"line\">    <span class=\"keyword\">const</span> result = <span class=\"keyword\">await</span> <span class=\"title class_\">UnSuccess</span>();</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;result:&quot;</span>, result);</span><br><span class=\"line\">  &#125; <span class=\"keyword\">catch</span> (err) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;å‘ç”Ÿäº†é”™è¯¯ï¼&quot;</span>);</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(err);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;end&quot;</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"title function_\">run</span>();</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"then-catch-ç»“æ„èµ‹å€¼\"><a href=\"#then-catch-ç»“æ„èµ‹å€¼\" class=\"headerlink\" title=\"then-catch ç»“æ„èµ‹å€¼\"></a>then-catch ç»“æ„èµ‹å€¼</h2><p><code>.then()</code>å’Œ<code>.catch()</code>è”åˆ<code>ç»“æ„èµ‹å€¼</code>æ¥å¤„ç†</p>\n<blockquote>\n<p>è¿™ç§æ–¹å¼ä»…ä»…æ˜¯ç®€åŒ–äº†<code>.then()</code>å’Œ<code>.catch()</code>æ–¹å¼è€Œå·²</p>\n</blockquote>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">async</span> <span class=\"keyword\">function</span> <span class=\"title function_\">run</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;start&quot;</span>);</span><br><span class=\"line\">  <span class=\"keyword\">const</span> [err, result] = <span class=\"keyword\">await</span> <span class=\"title class_\">UnSuccess</span>()</span><br><span class=\"line\">    .<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">result</span>) =&gt;</span> [<span class=\"literal\">null</span>, result])</span><br><span class=\"line\">    .<span class=\"title function_\">catch</span>(<span class=\"function\">(<span class=\"params\">err</span>) =&gt;</span> [err, <span class=\"literal\">null</span>]);</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (err) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;å‘ç”Ÿäº†é”™è¯¯ï¼&quot;</span>);</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(err);</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;result:&quot;</span>, result);</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;end&quot;</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"title function_\">run</span>();</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"å°è£…-then-catch-ç»“æ„èµ‹å€¼\"><a href=\"#å°è£…-then-catch-ç»“æ„èµ‹å€¼\" class=\"headerlink\" title=\"å°è£… then-catch ç»“æ„èµ‹å€¼\"></a>å°è£… then-catch ç»“æ„èµ‹å€¼</h2><p>ç®€å•çš„å°è£…ä»¥ä¸‹å°±å¯ç”¨åœ¨å¾ˆå¤šåœ°æ–¹è¿›è¡Œå¤ç”¨äº†</p>\n<blockquote>\n<p>æ ¹å‰é¢çš„ä»£ç å¯¹æ¯”æ—¶ä¸æ—¶å¥½äº†å¾ˆå¤šï¼Ÿ</p>\n</blockquote>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Promiseå‡½æ•°é”™è¯¯å¤„ç†</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> &#123;<span class=\"type\">Function</span>&#125; asyncFn è¿™æ˜¯ä¸€ä¸ªPromiseå‡½æ•°</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@returns</span> &#123;<span class=\"type\">Array</span>&#125; [err,result]</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">AsyncHandling</span>(<span class=\"params\">asyncFn</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"title function_\">asyncFn</span>()</span><br><span class=\"line\">    .<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">result</span>) =&gt;</span> [<span class=\"literal\">null</span>, result])</span><br><span class=\"line\">    .<span class=\"title function_\">catch</span>(<span class=\"function\">(<span class=\"params\">err</span>) =&gt;</span> [err, <span class=\"literal\">null</span>]);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">async</span> <span class=\"keyword\">function</span> <span class=\"title function_\">run</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;start&quot;</span>);</span><br><span class=\"line\">  <span class=\"keyword\">const</span> [err, result] = <span class=\"keyword\">await</span> <span class=\"title class_\">AsyncHandling</span>(<span class=\"title class_\">UnSuccess</span>);</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (err) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;å‘ç”Ÿäº†é”™è¯¯ï¼&quot;</span>);</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(err);</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;result:&quot;</span>, result);</span><br><span class=\"line\">  <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;end&quot;</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"title function_\">run</span>();</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h2><p>ä¸ç®¡ä½ ç”¨ä»€ä¹ˆæ–¹å¼éƒ½å¯ç”¨ï¼Œçœ‹ä½ å–œæ¬¢ä»€ä¹ˆé£æ ¼çš„ç¼–ç æ–¹å¼<br>æ­¤ç¯‡æ–‡ç« åªæ˜¯æä¾›æ›´å¤šçš„æ–¹å¼æ¥è§£å†³å®é™…å¼€å‘ä¸­çš„é—®é¢˜<br>å¦‚æœä½ æœ‰æ›´å¥½çš„æ–¹å¼æ¬¢è¿ç•™è¨€è¯„è®º</p>\n",
            "tags": [
                "è®°å½•",
                "JavaScript"
            ]
        }
    ]
}