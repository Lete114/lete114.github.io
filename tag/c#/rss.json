{
    "version": "https://jsonfeed.org/version/1",
    "title": "Lete乐特 's Blog • All posts by \"c#\" tag",
    "description": "我相信我可以，但我一直在路上，所以我有无限的可能！！",
    "home_page_url": "https://blog.imlete.cn",
    "items": [
        {
            "id": "https://blog.imlete.cn/article/C-Get-ForIcon.html",
            "url": "https://blog.imlete.cn/article/C-Get-ForIcon.html",
            "title": "C#获取软件ico图标",
            "date_published": "2021-08-10T19:53:46.000Z",
            "content_html": "<p>我个人是比较喜欢封装一些需要安装在电脑上的软件的，封装后就是绿色版(携带版)<br>无需安装，即点即用，非常的方便</p>\n<blockquote>\n<p>例如：</p>\n<ol>\n<li>pr、ps(虽然很大，但是出门在外，做一些小处理还是比较方便的，不需要在别人的电脑上安装即可使用，插 U 盘就可以)</li>\n<li>Chrome、有道翻译、Linux 连接工具 FTP、投屏软件、网易云音乐、某些录屏软件、火绒弹窗拦截、火绒剑、文件粉碎、鲁大师(去除无用功能，只保留主要功能) 一些小工具等</li>\n</ol>\n</blockquote>\n<p>在封装的时候如何获取相应软件的图标呢？(有些软件是包含在安装目录里的)，因为自己身为程序员，这种小事就自己动动手写嘛<br>之前有学过 C#的一些开发经验，所有就打算写一个</p>\n<p>废话也不多说了，直接看正文</p>\n<h2 id=\"正文\"><a href=\"#正文\" class=\"headerlink\" title=\"正文\"></a>正文</h2><p>打开 IDE Visual Studio 我的是 2012 的(Visual Studio 2012)</p>\n<p>直接点击左边的新建项目<br><img src=\"/img/C-Get-ForIcon/1.png\" alt=\"\"><br><img src=\"/img/C-Get-ForIcon/2.png\" alt=\"\"></p>\n<h3 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h3><p>创建完成后，第一时间肯定是先修改标题名啦(这里我就不截那么多图了)<br>然后再右边的<code>解决方案资源管理器</code>里将 Form1.cs 重命名为<code>ForIcon.cs</code><br>注意右下角有很多选项，我先修改了软件标题信息</p>\n<table>\n<thead>\n<tr>\n<th>属性名</th>\n<th>属性值</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>(Name)</td>\n<td>ForIcon</td>\n<td>用于处理代码中对象的昵称</td>\n</tr>\n<tr>\n<td>Text</td>\n<td>获取软件 ico 图标</td>\n<td>软件名称</td>\n</tr>\n<tr>\n<td>TopMost</td>\n<td>True</td>\n<td>软件是否处于最顶层</td>\n</tr>\n<tr>\n<td>StarPositon</td>\n<td>CenterScreen</td>\n<td>运行软件时，软件出现的位置</td>\n</tr>\n<tr>\n<td>MinimizeBox</td>\n<td>False</td>\n<td>是否显示最小化按钮</td>\n</tr>\n<tr>\n<td>MaximizeBox</td>\n<td>False</td>\n<td>是否显示最大化按钮</td>\n</tr>\n<tr>\n<td>Icon</td>\n<td>(图片路径)</td>\n<td>软件图标</td>\n</tr>\n<tr>\n<td>FormBorderStyle</td>\n<td>FixedDialog</td>\n<td>软件外观变化(FixedDialog: 禁止用户调整软件边框大小)</td>\n</tr>\n<tr>\n<td>AllowDrop</td>\n<td>True</td>\n<td>是否允许用户拖动文件到软件中，获取数据<code>重点</code></td>\n</tr>\n</tbody></table>\n<p><img src=\"/img/C-Get-ForIcon/3.png\" alt=\"\"></p>\n<h3 id=\"添加事件\"><a href=\"#添加事件\" class=\"headerlink\" title=\"添加事件\"></a>添加事件</h3><p>点击属性旁边的那个小闪电图标<br>找到<code>DragDrop</code>和<code>DragEnter</code>并在它俩的属性值处双击，跳入事件方法中<br><img src=\"/img/C-Get-ForIcon/4.png\" alt=\"\"></p>\n<p>这时会跳到代码里，并且会自动创建两个方法(注释是我写的，并不是自动生成的)<br>此时<code>DragDrop</code>和<code>DragEnter</code>的属性值都会绑定这两个方法</p>\n<figure class=\"highlight c#\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">using</span> System;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Collections.Generic;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.ComponentModel;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Data;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Drawing;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Linq;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Text;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Threading.Tasks;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Windows.Forms;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">namespace</span> <span class=\"title\">ForIcon</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">partial</span> <span class=\"keyword\">class</span> <span class=\"title\">ForIcon</span> : <span class=\"title\">Form</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">ForIcon</span>()</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            InitializeComponent();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 拖入事件(拖入后松开鼠标时执行)</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">ForIcon_DragDrop</span>(<span class=\"params\"><span class=\"built_in\">object</span> sender, DragEventArgs e</span>)</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 拖入事件(拖入时执行)</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">ForIcon_DragEnter</span>(<span class=\"params\"><span class=\"built_in\">object</span> sender, DragEventArgs e</span>)</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"编码\"><a href=\"#编码\" class=\"headerlink\" title=\"编码\"></a>编码</h3><figure class=\"highlight c#\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">using</span> System;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Collections.Generic;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.ComponentModel;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Data;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Drawing;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Linq;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Text;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Threading.Tasks;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Windows.Forms;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">namespace</span> <span class=\"title\">ForIcon</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">partial</span> <span class=\"keyword\">class</span> <span class=\"title\">ForIcon</span> : <span class=\"title\">Form</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">ForIcon</span>()</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            InitializeComponent();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 拖入事件(拖入后松开鼠标时执行)</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">ForIcon_DragDrop</span>(<span class=\"params\"><span class=\"built_in\">object</span> sender, DragEventArgs e</span>)</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 获取拖入的文件路径</span></span><br><span class=\"line\">            <span class=\"built_in\">string</span> File_Path = ((System.Array)e.Data.GetData(DataFormats.FileDrop)).GetValue(<span class=\"number\">0</span>).ToString();</span><br><span class=\"line\">            <span class=\"comment\">// 判断后缀名</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (System.IO.Path.GetExtension(File_Path) != <span class=\"string\">&quot;.exe&quot;</span>) &#123;</span><br><span class=\"line\">                MessageBox.Show(<span class=\"string\">&quot;当前文件不是EXE文件~&quot;</span>, <span class=\"string\">&quot;警告&quot;</span>, MessageBoxButtons.OK, MessageBoxIcon.Warning);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                SaveFileDialog sfd = <span class=\"keyword\">new</span> SaveFileDialog(); <span class=\"comment\">// 保存文件对话框</span></span><br><span class=\"line\">                sfd.Filter = <span class=\"string\">&quot;|*.ico&quot;</span>; <span class=\"comment\">// 后缀名</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (sfd.ShowDialog() == DialogResult.OK) &#123; <span class=\"comment\">// 判断是否点击保存(未填写文件名则无效)</span></span><br><span class=\"line\">                    <span class=\"comment\">// 获取拖入文件的图标</span></span><br><span class=\"line\">                    Image img = Icon.ExtractAssociatedIcon(File_Path).ToBitmap();</span><br><span class=\"line\">                    img.Save(sfd.FileName);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 拖入事件(拖入时执行)</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">ForIcon_DragEnter</span>(<span class=\"params\"><span class=\"built_in\">object</span> sender, DragEventArgs e</span>)</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            e.Effect = DragDropEffects.All;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"添加控件\"><a href=\"#添加控件\" class=\"headerlink\" title=\"添加控件\"></a>添加控件</h3><p>其中我们只需要添加一段文字，提醒用户将文件拖入的信息提示即可，随后修改<code>label</code>属性信息就可用了<br>然后将<code>label</code>显示区域拉满软件窗口(这里的拉满指的是自动对焦的拉满，其实你把它全拉满都没问题，这只是我的个人习惯)看最后一张图</p>\n<table>\n<thead>\n<tr>\n<th>属性名</th>\n<th>属性值</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>(Name)</td>\n<td>msg</td>\n<td>用于处理代码中对象的昵称</td>\n</tr>\n<tr>\n<td>Text</td>\n<td>软件拖入…</td>\n<td>文本内容</td>\n</tr>\n<tr>\n<td>AutoSize</td>\n<td>False</td>\n<td>label 大小是否根据内容进行自动调整</td>\n</tr>\n<tr>\n<td>Font</td>\n<td>宋体, 10.2pt, style=Bold</td>\n<td>调整字体</td>\n</tr>\n<tr>\n<td>FontColor</td>\n<td>Red</td>\n<td>运行软件时，软件出现的位置</td>\n</tr>\n<tr>\n<td>TextAlign</td>\n<td>MiddleCenter</td>\n<td>内容显示再 label 中的哪个位置(MiddleCenter: 居中)</td>\n</tr>\n</tbody></table>\n<p><img src=\"/img/C-Get-ForIcon/5.png\" alt=\"\"><br><img src=\"/img/C-Get-ForIcon/6.png\" alt=\"\"></p>\n<h3 id=\"运行\"><a href=\"#运行\" class=\"headerlink\" title=\"运行\"></a>运行</h3><p>点击上方工具栏的启动按钮即可，然后找到你的项目存储路径(我的是： <code>D:\\Data\\C\\C#\\</code>)<br>打开项目名称再继续点击去找到<code>\\bin\\Debug</code>里面就会有打包好的.exe执行文件<br>我的完整路径是: <code>D:\\Data\\C\\C#\\ForIcon\\ForIcon\\bin\\Debug\\ForIcon.exe</code></p>\n",
            "tags": [
                "记录",
                "C#"
            ]
        },
        {
            "id": "https://blog.imlete.cn/article/2edfe4f5.html",
            "url": "https://blog.imlete.cn/article/2edfe4f5.html",
            "title": "C#获取鼠标当前颜色RGB、获取鼠标当前HEX值、获取鼠标当前坐标(源码)",
            "date_published": "2020-04-30T12:49:18.000Z",
            "content_html": "<p><strong>Lete 乐特自制实用工具(C# - .NET Framework4.5)</strong><br><br><br><img src=\"/img/C/RGB.gif\" alt=\"\"></p>\n<span id=\"more\"></span>\n\n<p>由于上次使用 Java 编写的实用工具<a href=\"https://lete114.github.io/article/986f7d9c.html\">https://lete114.github.io/article/986f7d9c.html</a><br></p>\n<h3 id=\"Java-写窗体程序的优缺点\"><a href=\"#Java-写窗体程序的优缺点\" class=\"headerlink\" title=\"Java 写窗体程序的优缺点\"></a>Java 写窗体程序的优缺点</h3><blockquote>\n<p>优点：</p>\n<blockquote>\n<ol>\n<li>可跨平台</li>\n</ol>\n</blockquote>\n</blockquote>\n<blockquote>\n<p>缺点：<br></p>\n<blockquote>\n<ol>\n<li>Java 程序依赖 JVM(Java 虚拟机)</li>\n<li>由于 JVM 是存储在 jre 下的(而 Java 程序又依赖<code>JVM(Java 虚拟机)</code>)jre 占用内存高达 200MB</li>\n</ol>\n</blockquote>\n</blockquote>\n<h3 id=\"C-写窗体程序的优缺点\"><a href=\"#C-写窗体程序的优缺点\" class=\"headerlink\" title=\"C#写窗体程序的优缺点\"></a>C#写窗体程序的优缺点</h3><p>由于 Java 程序不便于携带，这次我使用 C#编写<br></p>\n<blockquote>\n<p>优点：</p>\n<blockquote>\n<ol>\n<li>体积小(小于 1MB)</li>\n<li>便于携带</li>\n<li>便于编写(随意拖动按钮图标等)</li>\n</ol>\n</blockquote>\n</blockquote>\n<blockquote>\n<p>缺点：</p>\n<blockquote>\n<ol>\n<li>C#依赖 .NET Framework<br>(这个不要紧，大多数电脑都会装有 .NET Framework，玩游戏的应该需要装游戏运行库，运行库里就包含有 .NET Framework)</li>\n</ol>\n</blockquote>\n</blockquote>\n<br>\n\n<p><code>FormMain.cs</code></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">using</span> System;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Collections.Generic;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.ComponentModel;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Data;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Drawing;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Linq;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Runtime.InteropServices;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Text;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Threading.Tasks;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Windows.Forms;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">namespace</span> <span class=\"title\">Delete</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">partial</span> <span class=\"keyword\">class</span> <span class=\"title\">FormMain</span> : <span class=\"title\">Form</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">FormMain</span>()</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            InitializeComponent();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        [<span class=\"meta\">DllImport(<span class=\"string\">&quot;user32.dll&quot;</span>)</span>]<span class=\"comment\">//取设备场景</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">extern</span> IntPtr <span class=\"title\">GetDC</span>(<span class=\"params\">IntPtr hwnd</span>)</span>;<span class=\"comment\">//返回设备场景句柄</span></span><br><span class=\"line\">        [<span class=\"meta\">DllImport(<span class=\"string\">&quot;gdi32.dll&quot;</span>)</span>]<span class=\"comment\">//取指定点颜色</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">extern</span> <span class=\"built_in\">int</span> <span class=\"title\">GetPixel</span>(<span class=\"params\">IntPtr hdc, Point p</span>)</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 单击乐特</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">lete_Click</span>(<span class=\"params\"><span class=\"built_in\">object</span> sender, EventArgs e</span>)</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            System.Diagnostics.Process.Start(<span class=\"string\">&quot;http://lete114.github.io/&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// 窗体加载事件</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">LeteTools_Load</span>(<span class=\"params\"><span class=\"built_in\">object</span> sender, EventArgs e</span>)</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.tm.Enabled = <span class=\"literal\">true</span>;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.tm.Interval = <span class=\"number\">1</span>;<span class=\"comment\">//timer控件的执行频率</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//计时器</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">tm_Tick</span>(<span class=\"params\"><span class=\"built_in\">object</span> sender, EventArgs e</span>)</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 计时器</span></span><br><span class=\"line\">            Timer tim = <span class=\"keyword\">new</span> Timer();</span><br><span class=\"line\">            tim.Interval = <span class=\"number\">1</span>;</span><br><span class=\"line\">            tim.Tick += <span class=\"built_in\">delegate</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"comment\">//获取RGB鼠标当前位置颜色</span></span><br><span class=\"line\">                Point p = <span class=\"keyword\">new</span> Point(MousePosition.X, MousePosition.Y);<span class=\"comment\">//取置顶点坐标</span></span><br><span class=\"line\">                IntPtr hdc = GetDC(<span class=\"keyword\">new</span> IntPtr(<span class=\"number\">0</span>));<span class=\"comment\">//取到设备场景(0就是全屏的设备场景)</span></span><br><span class=\"line\">                <span class=\"built_in\">int</span> c = GetPixel(hdc, p);<span class=\"comment\">//取指定点颜色</span></span><br><span class=\"line\">                <span class=\"built_in\">int</span> r = (c &amp; <span class=\"number\">0xFF</span>);<span class=\"comment\">//转换R</span></span><br><span class=\"line\">                <span class=\"built_in\">int</span> g = (c &amp; <span class=\"number\">0xFF00</span>) / <span class=\"number\">256</span>;<span class=\"comment\">//转换G</span></span><br><span class=\"line\">                <span class=\"built_in\">int</span> b = (c &amp; <span class=\"number\">0xFF0000</span>) / <span class=\"number\">65536</span>;<span class=\"comment\">//转换B</span></span><br><span class=\"line\">                <span class=\"comment\">//RGB.BackColor = Color.FromArgb(r, g, b);</span></span><br><span class=\"line\">                lblR255.Text = r.ToString();</span><br><span class=\"line\">                lblG255.Text = g.ToString();</span><br><span class=\"line\">                lblB255.Text = b.ToString();</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"comment\">// 用主类实例化，调用convertRGBToHex方法，传入RGB</span></span><br><span class=\"line\">                FormMain lt = <span class=\"keyword\">new</span> FormMain();</span><br><span class=\"line\">                lblVHEX.Text = lt.convertRGBToHex(r, g, b);</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"comment\">// 鼠标坐标</span></span><br><span class=\"line\">                <span class=\"comment\">//方法1：</span></span><br><span class=\"line\">                <span class=\"comment\">//lblVX.Text = Cursor.Position.X.ToString();</span></span><br><span class=\"line\">                <span class=\"comment\">//lblVY.Text = Cursor.Position.Y.ToString();</span></span><br><span class=\"line\">                <span class=\"comment\">//方法2：</span></span><br><span class=\"line\">                lblVX.Text = Control.MousePosition.X.ToString();</span><br><span class=\"line\">                lblVY.Text = Control.MousePosition.Y.ToString();</span><br><span class=\"line\"></span><br><span class=\"line\">            &#125;;</span><br><span class=\"line\">            tim.Start();</span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 计算HEX值</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">convertRGBToHex</span>(<span class=\"params\"><span class=\"built_in\">int</span> r, <span class=\"built_in\">int</span> g, <span class=\"built_in\">int</span> b</span>)</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            String rFString, rSString, gFString, gSString, bFString, bSString, result;</span><br><span class=\"line\">            <span class=\"built_in\">int</span> red, green, blue;</span><br><span class=\"line\">            <span class=\"built_in\">int</span> rred, rgreen, rblue;</span><br><span class=\"line\">            red = r / <span class=\"number\">16</span>;</span><br><span class=\"line\">            rred = r % <span class=\"number\">16</span>;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (red == <span class=\"number\">10</span>) rFString = <span class=\"string\">&quot;A&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (red == <span class=\"number\">11</span>) rFString = <span class=\"string\">&quot;B&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (red == <span class=\"number\">12</span>) rFString = <span class=\"string\">&quot;C&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (red == <span class=\"number\">13</span>) rFString = <span class=\"string\">&quot;D&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (red == <span class=\"number\">14</span>) rFString = <span class=\"string\">&quot;E&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (red == <span class=\"number\">15</span>) rFString = <span class=\"string\">&quot;F&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> rFString = red.ToString();</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (rred == <span class=\"number\">10</span>) rSString = <span class=\"string\">&quot;A&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (rred == <span class=\"number\">11</span>) rSString = <span class=\"string\">&quot;B&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (rred == <span class=\"number\">12</span>) rSString = <span class=\"string\">&quot;C&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (rred == <span class=\"number\">13</span>) rSString = <span class=\"string\">&quot;D&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (rred == <span class=\"number\">14</span>) rSString = <span class=\"string\">&quot;E&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (rred == <span class=\"number\">15</span>) rSString = <span class=\"string\">&quot;F&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> rSString = rred.ToString();</span><br><span class=\"line\"></span><br><span class=\"line\">            rFString = rFString + rSString;</span><br><span class=\"line\"></span><br><span class=\"line\">            green = g / <span class=\"number\">16</span>;</span><br><span class=\"line\">            rgreen = g % <span class=\"number\">16</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (green == <span class=\"number\">10</span>) gFString = <span class=\"string\">&quot;A&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (green == <span class=\"number\">11</span>) gFString = <span class=\"string\">&quot;B&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (green == <span class=\"number\">12</span>) gFString = <span class=\"string\">&quot;C&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (green == <span class=\"number\">13</span>) gFString = <span class=\"string\">&quot;D&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (green == <span class=\"number\">14</span>) gFString = <span class=\"string\">&quot;E&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (green == <span class=\"number\">15</span>) gFString = <span class=\"string\">&quot;F&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> gFString = green.ToString();</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (rgreen == <span class=\"number\">10</span>) gSString = <span class=\"string\">&quot;A&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (rgreen == <span class=\"number\">11</span>) gSString = <span class=\"string\">&quot;B&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (rgreen == <span class=\"number\">12</span>) gSString = <span class=\"string\">&quot;C&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (rgreen == <span class=\"number\">13</span>) gSString = <span class=\"string\">&quot;D&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (rgreen == <span class=\"number\">14</span>) gSString = <span class=\"string\">&quot;E&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (rgreen == <span class=\"number\">15</span>) gSString = <span class=\"string\">&quot;F&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> gSString = rgreen.ToString();</span><br><span class=\"line\"></span><br><span class=\"line\">            gFString = gFString + gSString;</span><br><span class=\"line\"></span><br><span class=\"line\">            blue = b / <span class=\"number\">16</span>;</span><br><span class=\"line\">            rblue = b % <span class=\"number\">16</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (blue == <span class=\"number\">10</span>) bFString = <span class=\"string\">&quot;A&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (blue == <span class=\"number\">11</span>) bFString = <span class=\"string\">&quot;B&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (blue == <span class=\"number\">12</span>) bFString = <span class=\"string\">&quot;C&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (blue == <span class=\"number\">13</span>) bFString = <span class=\"string\">&quot;D&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (blue == <span class=\"number\">14</span>) bFString = <span class=\"string\">&quot;E&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (blue == <span class=\"number\">15</span>) bFString = <span class=\"string\">&quot;F&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> bFString = blue.ToString();</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (rblue == <span class=\"number\">10</span>) bSString = <span class=\"string\">&quot;A&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (rblue == <span class=\"number\">11</span>) bSString = <span class=\"string\">&quot;B&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (rblue == <span class=\"number\">12</span>) bSString = <span class=\"string\">&quot;C&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (rblue == <span class=\"number\">13</span>) bSString = <span class=\"string\">&quot;D&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (rblue == <span class=\"number\">14</span>) bSString = <span class=\"string\">&quot;E&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (rblue == <span class=\"number\">15</span>) bSString = <span class=\"string\">&quot;F&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> bSString = rblue.ToString();</span><br><span class=\"line\">            bFString = bFString + bSString;</span><br><span class=\"line\">            result = <span class=\"string\">&quot;#&quot;</span> + rFString + gFString + bFString;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> result;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 进入删除窗体</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">Zhu_Click</span>(<span class=\"params\"><span class=\"built_in\">object</span> sender, EventArgs e</span>)</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            Delete m = <span class=\"keyword\">new</span> Delete();</span><br><span class=\"line\">            m.Show();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p><code>Delete.cs</code></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">using</span> System;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Collections.Generic;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.ComponentModel;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Data;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Drawing;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.IO;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Linq;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Text;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Threading.Tasks;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Windows.Forms;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">namespace</span> <span class=\"title\">Delete</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">partial</span> <span class=\"keyword\">class</span> <span class=\"title\">Delete</span> : <span class=\"title\">Form</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Delete</span>()</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            InitializeComponent();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 按钮</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">btnDelete_Click</span>(<span class=\"params\"><span class=\"built_in\">object</span> sender, EventArgs e</span>)</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 获取路径</span></span><br><span class=\"line\">            <span class=\"built_in\">string</span> str = txtPath.Text;</span><br><span class=\"line\">            str.Replace(<span class=\"string\">&quot;\\\\&quot;</span>, <span class=\"string\">&quot;/&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (str.Equals(<span class=\"string\">&quot;&quot;</span>))</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                MessageBox.Show(<span class=\"string\">&quot;路径不能为空！&quot;</span>, <span class=\"string\">&quot;提示&quot;</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (str.Equals(<span class=\"string\">&quot;Q:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;W:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;E:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;R:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;T:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;Y:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;U:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;I:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;O:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;P:\\\\&quot;</span>)|| str.Equals(<span class=\"string\">&quot;A:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;S:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;D:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;G:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;H:\\\\&quot;</span>)|| str.Equals(<span class=\"string\">&quot;J:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;K:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;L:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;Z:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;X:\\\\&quot;</span>)|| str.Equals(<span class=\"string\">&quot;C:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;C:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;V:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;B:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;N:\\\\&quot;</span>)|| str.Equals(<span class=\"string\">&quot;M:\\\\&quot;</span>))</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                MessageBox.Show(<span class=\"string\">&quot;路径不能为盘符！&quot;</span>, <span class=\"string\">&quot;提示&quot;</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">else</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                getPath(str);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 窗体加载事件</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">Main_Load</span>(<span class=\"params\"><span class=\"built_in\">object</span> sender, EventArgs e</span>)</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// 浏览</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">btnLL_Click</span>(<span class=\"params\"><span class=\"built_in\">object</span> sender, EventArgs e</span>)</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            FolderBrowserDialog f = <span class=\"keyword\">new</span> FolderBrowserDialog();</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (f.ShowDialog() == DialogResult.OK)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                String DirPath = f.SelectedPath;</span><br><span class=\"line\">                <span class=\"keyword\">this</span>.txtPath.Text = DirPath;<span class=\"comment\">//G:\\新建文件夹</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">static</span> List&lt;<span class=\"built_in\">string</span>&gt; list = <span class=\"keyword\">new</span> List&lt;<span class=\"built_in\">string</span>&gt;();<span class=\"comment\">//定义list变量</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> List&lt;<span class=\"built_in\">string</span>&gt; <span class=\"title\">getPath</span>(<span class=\"params\"><span class=\"built_in\">string</span> path</span>)</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 获取子目录</span></span><br><span class=\"line\">            DirectoryInfo dir = <span class=\"keyword\">new</span> DirectoryInfo(path);</span><br><span class=\"line\">            FileInfo[] fil = dir.GetFiles();</span><br><span class=\"line\">            DirectoryInfo[] dii = dir.GetDirectories();</span><br><span class=\"line\">            <span class=\"keyword\">foreach</span> (FileInfo f <span class=\"keyword\">in</span> fil)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                list.Add(f.FullName);<span class=\"comment\">//添加文件的路径到列表</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"comment\">//获取子文件夹内的文件列表，递归遍历</span></span><br><span class=\"line\">            <span class=\"keyword\">foreach</span> (DirectoryInfo d <span class=\"keyword\">in</span> dii)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                getPath(d.FullName);</span><br><span class=\"line\">                list.Add(d.FullName);<span class=\"comment\">//添加文件夹的路径到列表</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// 删除空目录</span></span><br><span class=\"line\">            <span class=\"comment\"><span class=\"doctag\">///</span> 删除掉空文件夹</span></span><br><span class=\"line\">            <span class=\"comment\"><span class=\"doctag\">///</span> 所有没有子“文件系统”的都将被删除</span></span><br><span class=\"line\">            DirectoryInfo[] subdirs = dir.GetDirectories(<span class=\"string\">&quot;*.*&quot;</span>, SearchOption.AllDirectories);</span><br><span class=\"line\">            <span class=\"keyword\">foreach</span> (DirectoryInfo subdir <span class=\"keyword\">in</span> subdirs)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                FileSystemInfo[] subFiles = subdir.GetFileSystemInfos();</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (subFiles.Count() == <span class=\"number\">0</span>)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    subdir.Delete();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> list;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p><code>Program.cs</code></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">using</span> System;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Collections.Generic;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Linq;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Threading.Tasks;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Windows.Forms;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">namespace</span> <span class=\"title\">Delete</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">class</span> <span class=\"title\">Program</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 应用程序的主入口点。</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">        [<span class=\"meta\">STAThread</span>]</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Main</span>()</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            Application.EnableVisualStyles();</span><br><span class=\"line\">            Application.SetCompatibleTextRenderingDefault(<span class=\"literal\">false</span>);</span><br><span class=\"line\">            Application.Run(<span class=\"keyword\">new</span> FormMain());</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<br>\n\n<h3 id=\"下载地址\"><a href=\"#下载地址\" class=\"headerlink\" title=\"下载地址\"></a>下载地址</h3><p>这里顺便推荐个云盘<code>曲奇云盘</code><a href=\"https://quqi.com\">https://quqi.com</a>用了有几个月了还不错<br><br>同样和百度云一样送<code>2T</code>空间，晚了可能就没有了，关键是<code>不限速</code></p>\n<p>曲奇云盘：<a href=\"https://quqi.gblhgk.com/s/47889/mAxdzF3Auy0rAN0t\">https://quqi.gblhgk.com/s/47889/mAxdzF3Auy0rAN0t</a></p>\n<p>Github：<a href=\"https://github.com/lete114/C.Tools\">https://github.com/lete114/C.Tools</a></p>\n<p>Gitee：<a href=\"https://gitee.com/lete114/C.Tools\">https://github.com/lete114/C.Tools</a></p>\n<br>\n\n<h3 id=\"【Lete-乐特个人博客】：https-lete114-now-sh\"><a href=\"#【Lete-乐特个人博客】：https-lete114-now-sh\" class=\"headerlink\" title=\"【Lete 乐特个人博客】：https://lete114.now.sh\"></a>【Lete 乐特个人博客】：<a href=\"https://lete114.now.sh\">https://lete114.now.sh</a></h3>",
            "tags": [
                "软件",
                "C#"
            ]
        },
        {
            "id": "https://blog.imlete.cn/article/e4698d02.html",
            "url": "https://blog.imlete.cn/article/e4698d02.html",
            "title": "C#删除指定目录空文件夹(源码)",
            "date_published": "2020-04-28T10:57:30.000Z",
            "content_html": "<p><strong>Lete乐特自制删除指定目录空文件夹工具(C# - .NET Framework4.5)</strong><br><br></p>\n<p>卸载软件的时候有些软件只删除程序，并不删除文件夹<br>以前不会编程，网上找教程大部分都是bat文件的教程<br>(放到想要删除的目录下运行，但这只能删除这个目录下的空目录，不能删除这个目录下空目录的子目录)<br>为了方便自己就动手写了一个</p>\n<p><img src=\"/img/C/Delete.gif\" alt=\"\"></p>\n<span id=\"more\"></span>\n\n<p><code>Main.cs</code></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">using</span> System;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Collections.Generic;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.ComponentModel;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Data;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Drawing;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.IO;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Linq;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Text;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Threading.Tasks;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Windows.Forms;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">namespace</span> <span class=\"title\">Delete</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">partial</span> <span class=\"keyword\">class</span> <span class=\"title\">Main</span> : <span class=\"title\">Form</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Main</span>()</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            InitializeComponent();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 浏览</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">btnLL_Click</span>(<span class=\"params\"><span class=\"built_in\">object</span> sender, EventArgs e</span>)</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            FolderBrowserDialog f = <span class=\"keyword\">new</span> FolderBrowserDialog();</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (f.ShowDialog() == DialogResult.OK)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                String DirPath = f.SelectedPath;</span><br><span class=\"line\">                <span class=\"keyword\">this</span>.txtPath.Text = DirPath;<span class=\"comment\">//G:\\新建文件夹</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 开始</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">btnDelete_Click</span>(<span class=\"params\"><span class=\"built_in\">object</span> sender, EventArgs e</span>)</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 获取路径</span></span><br><span class=\"line\">            <span class=\"built_in\">string</span> str = txtPath.Text;</span><br><span class=\"line\">            str.Replace(<span class=\"string\">&quot;\\\\&quot;</span>, <span class=\"string\">&quot;/&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (str.Equals(<span class=\"string\">&quot;&quot;</span>))</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                MessageBox.Show(<span class=\"string\">&quot;路径不能为空！&quot;</span>, <span class=\"string\">&quot;提示&quot;</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (str.Equals(<span class=\"string\">&quot;Q:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;W:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;E:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;R:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;T:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;Y:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;U:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;I:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;O:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;P:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;A:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;S:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;D:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;G:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;H:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;J:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;K:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;L:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;Z:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;X:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;C:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;C:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;V:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;B:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;N:\\\\&quot;</span>) || str.Equals(<span class=\"string\">&quot;M:\\\\&quot;</span>))</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                MessageBox.Show(<span class=\"string\">&quot;路径不能为盘符！&quot;</span>, <span class=\"string\">&quot;提示&quot;</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">else</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                getPath(str);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">static</span> List&lt;<span class=\"built_in\">string</span>&gt; list = <span class=\"keyword\">new</span> List&lt;<span class=\"built_in\">string</span>&gt;();<span class=\"comment\">//定义list变量</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> List&lt;<span class=\"built_in\">string</span>&gt; <span class=\"title\">getPath</span>(<span class=\"params\"><span class=\"built_in\">string</span> path</span>)</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 获取子目录</span></span><br><span class=\"line\">            DirectoryInfo dir = <span class=\"keyword\">new</span> DirectoryInfo(path);</span><br><span class=\"line\">            FileInfo[] fil = dir.GetFiles();</span><br><span class=\"line\">            DirectoryInfo[] dii = dir.GetDirectories();</span><br><span class=\"line\">            <span class=\"keyword\">foreach</span> (FileInfo f <span class=\"keyword\">in</span> fil)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                list.Add(f.FullName);<span class=\"comment\">//添加文件的路径到列表</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"comment\">//获取子文件夹内的文件列表，递归遍历</span></span><br><span class=\"line\">            <span class=\"keyword\">foreach</span> (DirectoryInfo d <span class=\"keyword\">in</span> dii)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                getPath(d.FullName);</span><br><span class=\"line\">                list.Add(d.FullName);<span class=\"comment\">//添加文件夹的路径到列表</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// 删除空目录</span></span><br><span class=\"line\">            <span class=\"comment\"><span class=\"doctag\">///</span> 删除掉空文件夹</span></span><br><span class=\"line\">            <span class=\"comment\"><span class=\"doctag\">///</span> 所有没有子“文件系统”的都将被删除</span></span><br><span class=\"line\">            DirectoryInfo[] subdirs = dir.GetDirectories(<span class=\"string\">&quot;*.*&quot;</span>, SearchOption.AllDirectories);</span><br><span class=\"line\">            <span class=\"keyword\">foreach</span> (DirectoryInfo subdir <span class=\"keyword\">in</span> subdirs)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                FileSystemInfo[] subFiles = subdir.GetFileSystemInfos();</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (subFiles.Count() == <span class=\"number\">0</span>)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    subdir.Delete();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">return</span> list;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        </span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 文本框</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">txtPath_Click</span>(<span class=\"params\"><span class=\"built_in\">object</span> sender, EventArgs e</span>)</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            FolderBrowserDialog f = <span class=\"keyword\">new</span> FolderBrowserDialog();</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (f.ShowDialog() == DialogResult.OK)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                String DirPath = f.SelectedPath;</span><br><span class=\"line\">                <span class=\"keyword\">this</span>.txtPath.Text = DirPath;<span class=\"comment\">//G:\\新建文件夹</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 乐特 s&#x27; Blog</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">lblLete_Click</span>(<span class=\"params\"><span class=\"built_in\">object</span> sender, EventArgs e</span>)</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            System.Diagnostics.Process.Start(<span class=\"string\">&quot;http://lete114.github.io/&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>Program.cs</code></p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">using</span> System;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Collections.Generic;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Linq;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Threading.Tasks;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Windows.Forms;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">namespace</span> <span class=\"title\">Delete</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">class</span> <span class=\"title\">Program</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 应用程序的主入口点。</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">        [<span class=\"meta\">STAThread</span>]</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Main</span>()</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            Application.EnableVisualStyles();</span><br><span class=\"line\">            Application.SetCompatibleTextRenderingDefault(<span class=\"literal\">false</span>);</span><br><span class=\"line\">            Application.Run(<span class=\"keyword\">new</span> Main());</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<br>\n\n<h3 id=\"下载地址\"><a href=\"#下载地址\" class=\"headerlink\" title=\"下载地址\"></a>下载地址</h3><p>这里顺便推荐个云盘<code>曲奇云盘</code><a href=\"https://quqi.com\">https://quqi.com</a>用了有几个月了还不错<br><br>同样和百度云一样送2T空间，晚了可能就没有了，关键是<code>不限速</code></p>\n<p>曲奇云盘：<a href=\"https://quqi.gblhgk.com/s/47889/zZ9iap4ZScYMyf5p\">https://quqi.gblhgk.com/s/47889/zZ9iap4ZScYMyf5p</a></p>\n<p>Github：<a href=\"https://github.com/lete114/Delete.Tools\">https://github.com/lete114/Delete.Tools</a></p>\n<p>Gitee：<a href=\"https://gitee.com/lete114/Delete.Tools\">https://github.com/lete114/Delete.Tools</a></p>\n<br>\n\n<h3 id=\"【Lete乐特个人博客】：https-lete114-now-sh\"><a href=\"#【Lete乐特个人博客】：https-lete114-now-sh\" class=\"headerlink\" title=\"【Lete乐特个人博客】：https://lete114.now.sh\"></a>【Lete乐特个人博客】：<a href=\"https://lete114.now.sh\">https://lete114.now.sh</a></h3>",
            "tags": [
                "软件",
                "C#"
            ]
        }
    ]
}