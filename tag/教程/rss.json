{
    "version": "https://jsonfeed.org/version/1",
    "title": "Lete乐特 's Blog • All posts by \"教程\" tag",
    "description": "我相信我可以，但我一直在路上，所以我有无限的可能！！",
    "home_page_url": "https://blog.imlete.cn",
    "items": [
        {
            "id": "https://blog.imlete.cn/article/webpack-on-demand-loading-principle.html",
            "url": "https://blog.imlete.cn/article/webpack-on-demand-loading-principle.html",
            "title": "webpack 按需加载原理",
            "date_published": "2022-10-15T10:45:51.000Z",
            "content_html": "<blockquote>\n<p>本文不会带你去阅读 <code>build</code> 后的源码，而是告诉你它是怎么做到的，原理是什么，怎么实现，如何自己动手做一个按需加载模块，如果不想听本文 BB，可直接一步到页脚，获取完整代码 <a href=\"#完整的按需加载代码\">#完整的按需加载代码</a></p>\n</blockquote>\n<h2 id=\"准备\"><a href=\"#准备\" class=\"headerlink\" title=\"准备\"></a>准备</h2><p>如果你想阅读源码，你可以根据下面的结构去创建，然后自己打包阅读源码</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// webpack.config.js</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> path = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;path&#x27;</span>)</span><br><span class=\"line\"><span class=\"keyword\">const</span> mode = <span class=\"string\">&#x27;production&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = &#123;</span><br><span class=\"line\">  mode,</span><br><span class=\"line\">  <span class=\"attr\">entry</span>: <span class=\"string\">&#x27;./src/index.js&#x27;</span>,</span><br><span class=\"line\">  <span class=\"attr\">output</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">path</span>: path.<span class=\"title function_\">join</span>(__dirname, <span class=\"string\">&#x27;dist&#x27;</span>),</span><br><span class=\"line\">    <span class=\"attr\">filename</span>: <span class=\"string\">&#x27;main.js&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">chunkFilename</span>: <span class=\"string\">&#x27;[name].js&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">libraryTarget</span>: <span class=\"string\">&#x27;umd&#x27;</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">optimization</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">minimize</span>: <span class=\"literal\">false</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// src/test.js</span></span><br><span class=\"line\"><span class=\"variable language_\">module</span>.<span class=\"property\">exports</span> = <span class=\"string\">&#x27;test&#x27;</span></span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// src/index.js</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 当调用 window 的 init 方法时触发加载 test.js ，加载完成后输出结果</span></span><br><span class=\"line\"><span class=\"variable language_\">window</span>.<span class=\"property\">init</span> = <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"title function_\">import</span>(<span class=\"comment\">/* webpackChunkName: &quot;test&quot; */</span> <span class=\"string\">&#x27;./test&#x27;</span>).<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">r</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(r)</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"import-干了什么\"><a href=\"#import-干了什么\" class=\"headerlink\" title=\"import() 干了什么\"></a>import() 干了什么</h2><p>其实 webpack 就是把 <code>import()</code> 动态导入的模块打包成了一个文件，而其中的 <code>webpackChunkName</code> 注释就是定义打包后这个动态模块的 js 文件，上方指定命名为 <code>test</code>，则打包结果为 <code>test.js</code>,如果没有写 <code>webpackChunkName</code> 那么 webpack 会自动定义随机的文件名(当然这不是随机的，它是根据文件中的内容进行 hash 推算的，只要内容没变，他就一直是这个名字，这段感兴趣的可以自己去阅读源码)</p>\n<h2 id=\"如何获取-url\"><a href=\"#如何获取-url\" class=\"headerlink\" title=\"如何获取 url\"></a>如何获取 url</h2><p>我在没看打包结果的源码时，我是这样想的，既然要加载，那么一定是通过 <code>script</code> 标签<br>因为引入是多变的，比如通过本地引入，或是 cdn 引入，又或者是其它方式，而 webpack 它是无法判断引入方式的，那么该如何获取 js 文件的 url 地址呢？</p>\n<p>拦截请求：<br>不过 <code>script</code> 发出的请求是浏览器发送的，并不像 <code>xhr</code> 一样可以包装一层进行 hook 拦截<br>于是我又想到了 <code>Service Workers</code> 的 <code>fetch</code> 事件，不过 webpack 怎么可能干这种事，这就属于入侵式修改了，不合理</p>\n<p>思来想去，我实在是想不到有啥办法了，于是我就去看了源码，万万没想到啊，居然是用 <a href=\"https://developer.mozilla.org/zh-CN/docs/Web/API/Document/currentScript\">document.currentScript</a> 属性，我居然把这给忘了:(</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 获取当前 script 标签的 src 属性</span></span><br><span class=\"line\"><span class=\"variable language_\">document</span>.<span class=\"property\">currentScript</span>.<span class=\"property\">src</span></span><br></pre></td></tr></table></figure>\n\n<p>webpack 源码里还写了一个获取当前 script 标签的代码</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 获取到所有的 script 标签</span></span><br><span class=\"line\"><span class=\"keyword\">var</span> scripts = <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementsByTagName</span>(<span class=\"string\">&#x27;script&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\">// 如果有，这通过下表获取</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> (scripts.<span class=\"property\">length</span>) scriptUrl = scripts[scripts.<span class=\"property\">length</span> - <span class=\"number\">1</span>].<span class=\"property\">src</span></span><br></pre></td></tr></table></figure>\n\n<p>原理是什么呢？，大家都知道，html 是从上往下解析的，当解析到 script 标签时，浏览器会阻塞页面渲染，等待下载完当前 js 并执行完成后才会继续往下解析，(除非你给当前 script 标签使用了 <code>async</code> 或 <code>defer</code> 属性，至于这俩属性的作用，可自行网上搜索)这时使用 <code>document.getElementsByTagName(&#39;script&#39;)</code> 获取页面上的 script 标签则只会获取到已经解析的 script 标签，所以当前的 script 标签它一定是最后一个 script 标签，就可以通过 <code>length - 1</code> 获取啦</p>\n<p>既然得到了 url，那么就可以加载 js 了，只需要把当前的 js 文件名改成需要加载的 js 文件名，也就是前面所说的 <code>webpackChunkName</code></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">let</span> scriptUrl</span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"variable language_\">document</span>.<span class=\"property\">currentScript</span>) scriptUrl = <span class=\"variable language_\">document</span>.<span class=\"property\">currentScript</span>.<span class=\"property\">src</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> (!scriptUrl) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> scripts = <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementsByTagName</span>(<span class=\"string\">&#x27;script&#x27;</span>)</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (scripts.<span class=\"property\">length</span>) scriptUrl = scripts[scripts.<span class=\"property\">length</span> - <span class=\"number\">1</span>].<span class=\"property\">src</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">if</span> (!scriptUrl) <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Error</span>(<span class=\"string\">&#x27;Automatic publicPath is not supported in this browser&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\">// 结果以下几个 replace() 即可得到 url</span></span><br><span class=\"line\">scriptUrl = scriptUrl</span><br><span class=\"line\">  .<span class=\"title function_\">replace</span>(<span class=\"regexp\">/#.*$/</span>, <span class=\"string\">&#x27;&#x27;</span>) <span class=\"comment\">// 去除锚点</span></span><br><span class=\"line\">  .<span class=\"title function_\">replace</span>(<span class=\"regexp\">/\\?.*$/</span>, <span class=\"string\">&#x27;&#x27;</span>) <span class=\"comment\">// 去除参数</span></span><br><span class=\"line\">  .<span class=\"title function_\">replace</span>(<span class=\"regexp\">/\\/[^/]+$/</span>, <span class=\"string\">&#x27;/&#x27;</span>) <span class=\"comment\">// 去除文件名</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"如何加载\"><a href=\"#如何加载\" class=\"headerlink\" title=\"如何加载\"></a>如何加载</h2><p>因为在上一步我们已经得到 url，此时只需要拼接上 <code>webpackChunkName</code> 的文件名就可以加载指定的 js 了</p>\n<p>那么<code>webpackChunkName</code>是怎么来的呢？<br>如果你用的是 webpack，那么它已经帮你做好了，反之则得自己写，其实很简单</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 定义一个对象，里面写好动态加载的js文件名即可</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> map = &#123; <span class=\"attr\">admin</span>: <span class=\"string\">&#x27;discuss.admin.js&#x27;</span> &#125;</span><br></pre></td></tr></table></figure>\n\n<p>然后通过 js 动态创建 script 标签加载 js 即可，最后加上一个 <code>onload</code> 事件，等待加载成功后自行代码即可</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// chunk: js 文件名</span></span><br><span class=\"line\"><span class=\"comment\">// callback: 回调函数，当js加载完成后执行</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">loadScript</span> = (<span class=\"params\">chunk, callback</span>) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> script = <span class=\"variable language_\">document</span>.<span class=\"title function_\">createElement</span>(<span class=\"string\">&#x27;script&#x27;</span>)</span><br><span class=\"line\">  script.<span class=\"property\">src</span> = scriptUrl + map[chunk]</span><br><span class=\"line\">  script.<span class=\"property\">onload</span> = <span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 执行完成后及时释放，让系统回收内存，毕竟我们只需要加载一次即可</span></span><br><span class=\"line\">    script.<span class=\"property\">onload</span> = <span class=\"literal\">null</span></span><br><span class=\"line\">    <span class=\"title function_\">callback</span>()</span><br><span class=\"line\">    <span class=\"comment\">// 删掉动态加载的 script 标签 dom 元素(不会对程序照成影响)</span></span><br><span class=\"line\">    script.<span class=\"property\">parentNode</span> &amp;&amp; script.<span class=\"property\">parentNode</span>.<span class=\"title function_\">removeChild</span>(script)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"variable language_\">document</span>.<span class=\"property\">head</span>.<span class=\"title function_\">appendChild</span>(script)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>最后还有一个问题需要解决，那就是避免在多次执行<code>window.init()</code>时触发多次加载，导致多次请求，照成不必要的请求，以及浪费流量带宽</p>\n<p>既然已经加载，那么就留个标记，表示这个 url 已经加载过了，下载执行不要不要继续创建 script 标签即可</p>\n<p>定义一个数组用来储存已经加载过的动态 js，<code>const chunks = []</code> 在动态创建 script 标签之前将文件名<code>push()</code>进去数组里即可</p>\n<h2 id=\"完整的按需加载代码\"><a href=\"#完整的按需加载代码\" class=\"headerlink\" title=\"完整的按需加载代码\"></a>完整的按需加载代码</h2><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// source: https://github.com/discussjs/discuss/blob/dc345810e6696f1282fca65df039b2186b1f34d1/src/client/lib/import.js</span></span><br><span class=\"line\"><span class=\"keyword\">let</span> scriptUrl</span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"variable language_\">document</span>.<span class=\"property\">currentScript</span>) scriptUrl = <span class=\"variable language_\">document</span>.<span class=\"property\">currentScript</span>.<span class=\"property\">src</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> (!scriptUrl) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> scripts = <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementsByTagName</span>(<span class=\"string\">&#x27;script&#x27;</span>)</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (scripts.<span class=\"property\">length</span>) scriptUrl = scripts[scripts.<span class=\"property\">length</span> - <span class=\"number\">1</span>].<span class=\"property\">src</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">if</span> (!scriptUrl) <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Error</span>(<span class=\"string\">&#x27;Automatic publicPath is not supported in this browser&#x27;</span>)</span><br><span class=\"line\">scriptUrl = scriptUrl</span><br><span class=\"line\">  .<span class=\"title function_\">replace</span>(<span class=\"regexp\">/#.*$/</span>, <span class=\"string\">&#x27;&#x27;</span>) <span class=\"comment\">// 去除锚点</span></span><br><span class=\"line\">  .<span class=\"title function_\">replace</span>(<span class=\"regexp\">/\\?.*$/</span>, <span class=\"string\">&#x27;&#x27;</span>) <span class=\"comment\">// 去除参数</span></span><br><span class=\"line\">  .<span class=\"title function_\">replace</span>(<span class=\"regexp\">/\\/[^/]+$/</span>, <span class=\"string\">&#x27;/&#x27;</span>) <span class=\"comment\">// 去除文件名</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 未来避免于其它js产生全局变量冲突，你可以定义为一个其它比较复杂的变量名</span></span><br><span class=\"line\"><span class=\"variable language_\">window</span>.<span class=\"property\">chunks</span> = []</span><br><span class=\"line\"><span class=\"keyword\">const</span> map = &#123; <span class=\"attr\">admin</span>: <span class=\"string\">&#x27;discuss.admin.js&#x27;</span> &#125;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">loadScript</span> = (<span class=\"params\">chunk, callback</span>) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"comment\">// 如果存在，则直接执行回调</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"variable language_\">window</span>.<span class=\"property\">chunks</span>.<span class=\"title function_\">includes</span>(chunk)) <span class=\"keyword\">return</span> <span class=\"title function_\">callback</span>()</span><br><span class=\"line\">  <span class=\"comment\">// 如果上方判断没有成立，则push到数组里，下次执行就会立即执行回调不必再向下执行代码</span></span><br><span class=\"line\">  <span class=\"variable language_\">window</span>.<span class=\"property\">chunks</span>.<span class=\"title function_\">push</span>(chunk)</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">const</span> script = <span class=\"variable language_\">document</span>.<span class=\"title function_\">createElement</span>(<span class=\"string\">&#x27;script&#x27;</span>)</span><br><span class=\"line\">  script.<span class=\"property\">src</span> = scriptUrl + map[chunk]</span><br><span class=\"line\">  script.<span class=\"property\">onload</span> = <span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">    script.<span class=\"property\">onload</span> = <span class=\"literal\">null</span></span><br><span class=\"line\">    <span class=\"title function_\">callback</span>()</span><br><span class=\"line\">    script.<span class=\"property\">parentNode</span> &amp;&amp; script.<span class=\"property\">parentNode</span>.<span class=\"title function_\">removeChild</span>(script)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"variable language_\">document</span>.<span class=\"property\">head</span>.<span class=\"title function_\">appendChild</span>(script)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> loadScript</span><br></pre></td></tr></table></figure>\n",
            "tags": [
                "JavaScript",
                "教程"
            ]
        },
        {
            "id": "https://blog.imlete.cn/article/Service-Worker-Preferred-Request-Resource.html",
            "url": "https://blog.imlete.cn/article/Service-Worker-Preferred-Request-Resource.html",
            "title": "使用Service Worker优选请求资源",
            "date_published": "2022-03-20T17:54:13.000Z",
            "content_html": "<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>当你的网站或博客有多个部署点时，部署在某个平台的访问速度比较快，于是你就把你的域名解析到了这个平台上，但有时候还是会变得很慢，这时其它站点速度可能会变得比你当前使用的还快一点，难道还有来回解析域名吗？太麻烦了</p>\n<p>有没有可以直接返回最快网站资源的办法呢？</p>\n<ol>\n<li>使用域名管理平台，有些平台可以解析不同网络或地区的站点<br>例如<strong>腾讯云</strong>可以区分解析国内三大运营商、境内、境外、等一些解析选项(不太好用，还需要自己测试，难不成求使用其它运营商手机的朋友帮你测一下快不快嘛~)</li>\n<li>使用 js 拦截网站的所有请求，并篡改将请求发送到自己的所有站点，这些站点中如果哪个站点最快返回，那么就用最快返回的这个信息，与此同时将其它的请求全部切断</li>\n</ol>\n<h2 id=\"正文\"><a href=\"#正文\" class=\"headerlink\" title=\"正文\"></a>正文</h2><p>本文会详细说明如何<strong>使用 Service Worker 优选请求资源</strong>让你的网站比以前更快，更稳定</p>\n<p><strong>Service Worker</strong>在接下来的内容中统一称呼为<strong>sw</strong></p>\n<h3 id=\"Service-Worker\"><a href=\"#Service-Worker\" class=\"headerlink\" title=\"Service Worker\"></a>Service Worker</h3><blockquote>\n<p>更详细请看<a href=\"https://developer.mozilla.org/zh-CN/docs/Web/API/Service_Worker_API\">https://developer.mozilla.org/zh-CN/docs/Web/API/Service_Worker_API</a></p>\n</blockquote>\n<p>Service workers 本质上充当 Web 应用程序、浏览器与网络（可用时）之间的代理服务器</p>\n<p>Service worker 运行在 worker 上下文，因此它不能访问 DOM。相对于驱动应用的主 JavaScript 线程，它运行在其他线程中，所以不会造成阻塞。</p>\n<p>出于安全考量，Service workers 只能由 HTTPS 承载，毕竟修改网络请求的能力暴露给中间人攻击会非常危险。</p>\n<h3 id=\"注册\"><a href=\"#注册\" class=\"headerlink\" title=\"注册\"></a>注册</h3><p>注册 sw 很简单，只需一行代码即可，如果注册成功，则 sw 会被下载到客户端并且安装和激活，这一步仅仅是注册而已，完整的是: 下载—&gt;安装—&gt;激活</p>\n<blockquote>\n<p>注意: sw 的注册日志记录在 Chrome 浏览器中可以通过访问<a href=\"chrome://serviceworker-internals\">chrome://serviceworker-internals</a>查看</p>\n</blockquote>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">navigator.<span class=\"property\">serviceWorker</span>.<span class=\"title function_\">register</span>(<span class=\"string\">&#x27;/Service-Worker.js&#x27;</span>)</span><br></pre></td></tr></table></figure>\n\n<p>其中<code>/Service-Worker.js</code>必须是当前域下的 js 文件，他不能是其它域下的，即使 js 文件内的内容完全相等，那也不行</p>\n<p>如果你只想在某个路径写使用 sw 的话，你可以使用<code>scope</code>选项，当然<code>/Service-Worker.js</code>的位置也可以自定义(只要是同源且是 https 协议就可以)，如下只有在<code>/article/</code>文章页 sw 才启动，其它路径写 sw 不进行处理</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">navigator.<span class=\"property\">serviceWorker</span>.<span class=\"title function_\">register</span>(<span class=\"string\">&#x27;/sw-test/Service-Worker.js&#x27;</span>, &#123; <span class=\"attr\">scope</span>: <span class=\"string\">&#x27;/article/&#x27;</span> &#125;)</span><br></pre></td></tr></table></figure>\n\n<p>并且必须是 https 协议，如果是本地<code>127.0.0.1</code>或<code>localhost</code>是被允许的</p>\n<p>这是一个完整的注册代码</p>\n<p>将安装代码放置在<code>&lt;head&gt;</code>之后</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">  ;(<span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"keyword\">if</span> (navigator.<span class=\"property\">serviceWorker</span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">      navigator.<span class=\"property\">serviceWorker</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">        .<span class=\"title function_\">register</span>(<span class=\"string\">&#x27;/sw.js&#x27;</span>)</span></span><br><span class=\"line\"><span class=\"language-javascript\">        .<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">result</span>) =&gt;</span> &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">          <span class=\"comment\">// 判断是否安装了sw</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">          <span class=\"keyword\">if</span> (<span class=\"variable language_\">localStorage</span>.<span class=\"title function_\">getItem</span>(<span class=\"string\">&#x27;installSW&#x27;</span>)) <span class=\"keyword\">return</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">          <span class=\"variable language_\">localStorage</span>.<span class=\"title function_\">setItem</span>(<span class=\"string\">&#x27;installSW&#x27;</span>, <span class=\"literal\">true</span>)</span></span><br><span class=\"line\"><span class=\"language-javascript\">          <span class=\"comment\">// 这里就不用清理setInterval了，因为页面刷新后就没有了</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">          <span class=\"keyword\">const</span> timer = <span class=\"built_in\">setInterval</span>(<span class=\"function\">() =&gt;</span> &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"comment\">// 判断sw安装后，是否处于激活状态，激活后刷新页面</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"keyword\">if</span> (result.<span class=\"property\">active</span>.<span class=\"property\">state</span> === <span class=\"string\">&#x27;activated&#x27;</span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">              <span class=\"built_in\">clearInterval</span>(timer)</span></span><br><span class=\"line\"><span class=\"language-javascript\">              <span class=\"title function_\">fetch</span>(<span class=\"variable language_\">window</span>.<span class=\"property\">location</span>.<span class=\"property\">href</span>)</span></span><br><span class=\"line\"><span class=\"language-javascript\">                .<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">res</span>) =&gt;</span> res.<span class=\"title function_\">text</span>())</span></span><br><span class=\"line\"><span class=\"language-javascript\">                .<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">text</span>) =&gt;</span> &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">                  <span class=\"variable language_\">document</span>.<span class=\"title function_\">open</span>()</span></span><br><span class=\"line\"><span class=\"language-javascript\">                  <span class=\"variable language_\">document</span>.<span class=\"title function_\">write</span>(text)</span></span><br><span class=\"line\"><span class=\"language-javascript\">                  <span class=\"variable language_\">document</span>.<span class=\"title function_\">close</span>()</span></span><br><span class=\"line\"><span class=\"language-javascript\">                &#125;)</span></span><br><span class=\"line\"><span class=\"language-javascript\">            &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\">          &#125;, <span class=\"number\">100</span>)</span></span><br><span class=\"line\"><span class=\"language-javascript\">        &#125;)</span></span><br><span class=\"line\"><span class=\"language-javascript\">        .<span class=\"title function_\">catch</span>(<span class=\"variable language_\">console</span>.<span class=\"property\">log</span>)</span></span><br><span class=\"line\"><span class=\"language-javascript\">    &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\">  &#125;)()</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"生命周期\"><a href=\"#生命周期\" class=\"headerlink\" title=\"生命周期\"></a>生命周期</h2><h3 id=\"installing-状态\"><a href=\"#installing-状态\" class=\"headerlink\" title=\"installing 状态\"></a>installing 状态</h3><p>当注册成功后会触发<strong>install</strong>事件，然后触发<strong>activate</strong>事件，此时如果再次刷新页面，它俩都不会被触发了</p>\n<p>直到<code>/sw.js</code>发生了改变，它就会触发一次 <strong>install</strong> (不仅仅是代码改变，哪怕是多一个空格或是少一个空格，又或是写一个注释都会被触发)，但是只执行了<strong>install</strong>事件，并没有执行<strong>activate</strong>事件</p>\n<h3 id=\"activing-状态\"><a href=\"#activing-状态\" class=\"headerlink\" title=\"activing 状态\"></a>activing 状态</h3><p>为什么<strong>activate</strong>事件不触发了？因为已经有一个 sw 了，它一种处于等待状态，至于什么时候才会被触发，那就是等之前的 sw 停止了才会触发<strong>activate</strong>事件</p>\n<p>那有没有办法不让它等待呢？答案是: <strong>有</strong></p>\n<p>使用<code>skipWaiting()</code>跳过等待，它返回一个 promise 对象(异步的)，防止还在执行<code>skipWaiting()</code>的时候直接就跳到<strong>activate</strong>事件，我们需要使用<code>async/await</code>，也可以使用<code>event.waitUntil(skipWaiting())</code>方法把<code>skipWaiting()</code>放到里面，和<code>async/await</code>效果一样</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// sw.js</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 在sw中可以使用this或是self表示自身</span></span><br><span class=\"line\">self.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&#x27;install&#x27;</span>, <span class=\"keyword\">async</span> (event) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"comment\">// event.waitUntil(self.skipWaiting())</span></span><br><span class=\"line\">  <span class=\"keyword\">await</span> self.<span class=\"title function_\">skipWaiting</span>()</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n\n<p>触发<strong>activate</strong>事件后 ，当前这一次网页是不会被 sw 管理的，需要下次页面刷新才会被 sw 管理，那怎么让它立即管理页面呢？</p>\n<blockquote>\n<p>更详细请看:<br><a href=\"https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerGlobalScope/skipWaiting\">https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerGlobalScope/skipWaiting</a> &gt; <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Clients/claim\">https://developer.mozilla.org/en-US/docs/Web/API/Clients/claim</a></p>\n</blockquote>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">self.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&#x27;activate&#x27;</span>, <span class=\"keyword\">async</span> (event) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"comment\">// event.waitUntil(self.clients.claim())</span></span><br><span class=\"line\">  <span class=\"keyword\">await</span> self.<span class=\"property\">clients</span>.<span class=\"title function_\">claim</span>() <span class=\"comment\">// 立即管理页面</span></span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h2><p>详细上面生命周期已经详细说明了</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// sw.js</span></span><br><span class=\"line\">self.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&#x27;install&#x27;</span>, <span class=\"keyword\">async</span> (event) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"comment\">// event.waitUntil(self.skipWaiting())</span></span><br><span class=\"line\">  <span class=\"keyword\">await</span> self.<span class=\"title function_\">skipWaiting</span>()</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"捕获请求\"><a href=\"#捕获请求\" class=\"headerlink\" title=\"捕获请求\"></a>捕获请求</h2><figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// sw.js</span></span><br><span class=\"line\">self.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&#x27;fetch&#x27;</span>, <span class=\"keyword\">async</span> (event) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"comment\">// 所有请求都得转到 handleRequest 函数内处理</span></span><br><span class=\"line\">  <span class=\"title function_\">handleRequest</span>(event.<span class=\"property\">request</span>)</span><br><span class=\"line\">    <span class=\"comment\">// 如果 handleRequest 请求成功则将数据响应到网页</span></span><br><span class=\"line\">    .<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">result</span>) =&gt;</span> event.<span class=\"title function_\">respondWith</span>(result))</span><br><span class=\"line\">    <span class=\"comment\">// 如果 handleRequest 请求失败，什么都不做(这是网页自己走自己的实际请求)</span></span><br><span class=\"line\">    .<span class=\"title function_\">catch</span>(<span class=\"function\">() =&gt;</span> <span class=\"number\">0</span>)</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 处理请求</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">handleRequest</span>(<span class=\"params\">req</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"title function_\">fetch</span>(req.<span class=\"property\">url</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>event.respondWith()</code>: 给浏览器一个响应，因为我们已经使用<code>Fetch API</code>替浏览器发送了请求，并且得到了结果并且返回，那么自然是要返回给浏览器啦</p>\n<p><a href=\"https://developer.mozilla.org/zh-CN/docs/Web/API/Fetch_API\">Fetch API</a>可以和<code>XMLHttpRequest</code>一样，可以发送任何请求</p>\n<blockquote>\n<p>值得一提的是使用 Fetch API 发送请求是会存在跨域问题的，一旦被跨域拦截，那么就上面都没有返回，会导致页面显示不了请求的内容(例如图片被跨域拦截了)，而 img、script 标签它们是不会发生跨域请求问题的，所以上面 catch 捕获异常一个 0 和 null 差不多<br>既然没有用到 event.respondWith 那自然是没有给浏览器返回数据啦，那浏览器就自己请求(很好的避免了这个问题)</p>\n</blockquote>\n<h2 id=\"篡改请求\"><a href=\"#篡改请求\" class=\"headerlink\" title=\"篡改请求\"></a>篡改请求</h2><p>上面我们都可以使用<code>Fetch API</code>替浏览器发送请求了，那是不是可以篡改呢？</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 处理请求</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">handleRequest</span>(<span class=\"params\">req</span>) &#123;</span><br><span class=\"line\">  <span class=\"comment\">// 仅仅只是举个例子，更多奇妙的用法等待你去探索</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> str = <span class=\"string\">&#x27;https://cdn.jsdelivr.net/npm/xhr-ajax/dist/&#x27;</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> url = req.<span class=\"property\">url</span>.<span class=\"title function_\">replace</span>(str + <span class=\"string\">&#x27;ajax.js&#x27;</span>, str + <span class=\"string\">&#x27;ajax.min.js&#x27;</span>)</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"title function_\">fetch</span>(url)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>如上代码，我们就可以将 ajax 请求的第三方库 js 文件请求变为压缩后的请求，并返回给浏览器(篡改成功)</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 批量请求</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">handleRequest</span>(<span class=\"params\">req</span>) &#123;</span><br><span class=\"line\">  <span class=\"comment\">// 可以是多个</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> urls = [</span><br><span class=\"line\">    <span class=\"string\">&quot;https://cdn.jsdelivr.net/npm/xhr-ajax/dist/ajax.min.js&quot;</span>,</span><br><span class=\"line\">    <span class=\"string\">&quot;https://unpkg.com/xhr-ajax/dist/ajax.min.js&quot;</span>,</span><br><span class=\"line\">  ];</span><br><span class=\"line\">  <span class=\"comment\">// 中断一个或多个请求</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> controller = <span class=\"keyword\">new</span> <span class=\"title class_\">AbortController</span>();</span><br><span class=\"line\">  <span class=\"comment\">// 可以中断请求</span></span><br><span class=\"line\">  <span class=\"comment\">// https://developer.mozilla.org/zh-CN/docs/Web/API/AbortController#%E5%B1%9E%E6%80%A7</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> signal = controller.<span class=\"property\">signal</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// 遍历将所有的请求地址转换为promise</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"title class_\">PromiseAll</span> = urls.<span class=\"title function_\">map</span>(<span class=\"function\">(<span class=\"params\">url</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"keyword\">async</span> (resolve, reject) =&gt; &#123;</span><br><span class=\"line\">      <span class=\"title function_\">fetch</span>(url, &#123; signal &#125;)</span><br><span class=\"line\">        .<span class=\"title function_\">then</span>(</span><br><span class=\"line\">          <span class=\"function\">(<span class=\"params\">res</span>) =&gt;</span></span><br><span class=\"line\">            <span class=\"keyword\">new</span> <span class=\"title class_\">Response</span>(<span class=\"keyword\">await</span> res.<span class=\"title function_\">arrayBuffer</span>(), &#123;</span><br><span class=\"line\">              <span class=\"attr\">status</span>: res.<span class=\"property\">status</span>,</span><br><span class=\"line\">              <span class=\"attr\">headers</span>: res.<span class=\"property\">headers</span>,</span><br><span class=\"line\">            &#125;)</span><br><span class=\"line\">        )</span><br><span class=\"line\">        .<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">res</span>) =&gt;</span> &#123;</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (res.<span class=\"property\">status</span> !== <span class=\"number\">200</span>) <span class=\"title function_\">reject</span>(<span class=\"literal\">null</span>);</span><br><span class=\"line\">          <span class=\"comment\">// 只要有一个请求成功返回那么就把所有的请求断开</span></span><br><span class=\"line\">          controller.<span class=\"title function_\">abort</span>(); <span class=\"comment\">// 中断</span></span><br><span class=\"line\">          <span class=\"title function_\">resolve</span>(res);</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        .<span class=\"title function_\">catch</span>(<span class=\"function\">() =&gt;</span> <span class=\"title function_\">reject</span>(<span class=\"literal\">null</span>));</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">  <span class=\"comment\">// 使用 Promise.any 发送批量请求，它接收一个可迭代对象，例如数组就是一个可迭代对象</span></span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"title class_\">Promise</span>.<span class=\"title function_\">any</span>(<span class=\"title class_\">PromiseAll</span>)</span><br><span class=\"line\">    .<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">res</span>) =&gt;</span> res)</span><br><span class=\"line\">    .<span class=\"title function_\">catch</span>(<span class=\"function\">() =&gt;</span> <span class=\"literal\">null</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>Promise.any 具体请看: <a href=\"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise/any\">https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise/any</a><br>AbortController 具体请看: <a href=\"https://developer.mozilla.org/zh-CN/docs/Web/API/AbortController\">https://developer.mozilla.org/zh-CN/docs/Web/API/AbortController</a></p>\n</blockquote>\n<p>只要传入的迭代对象中的任何一个 <code>promise</code> 返回成功（resolve）状态，那么它就返回成功状态，如果其中的所有的 <code>promises</code> 都失败，那么就会把所有的失败返回</p>\n<p>所以只要<code>Promise.any</code>有一个成功状态的数据返回，那么我们就把这个数据响应给浏览器，而其它 的请求全部切断，这样就可以高效的在不同地区响应最快的资源给用户啦~</p>\n<p>这也是正文开始前我们所需要解决的问题</p>\n<h2 id=\"完整-sw-js-文件\"><a href=\"#完整-sw-js-文件\" class=\"headerlink\" title=\"完整 sw.js 文件\"></a>完整 sw.js 文件</h2><p>这是我总结写出的一个 sw.js 文件，你只需要将下面的<code>origin</code>数组改成你的博客地址就可以了，其它的可以不用动，如果你想添加新东西，那就随便你啦~哈哈哈</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> origin = [<span class=\"string\">&#x27;https://blog.imlete.cn&#x27;</span>, <span class=\"string\">&#x27;https://lete114.github.io&#x27;</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> cdn = &#123;</span><br><span class=\"line\">  <span class=\"attr\">gh</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">jsdelivr</span>: <span class=\"string\">&#x27;https://cdn.jsdelivr.net/gh&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">fastly</span>: <span class=\"string\">&#x27;https://fastly.jsdelivr.net/gh&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">gcore</span>: <span class=\"string\">&#x27;https://gcore.jsdelivr.net/gh&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">testingcf</span>: <span class=\"string\">&#x27;https://testingcf.jsdelivr.net/gh&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">test1</span>: <span class=\"string\">&#x27;https://test1.jsdelivr.net/gh&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">tianli</span>: <span class=\"string\">&#x27;https://cdn1.tianli0.top/gh&#x27;</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">combine</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">jsdelivr</span>: <span class=\"string\">&#x27;https://cdn.jsdelivr.net/combine&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">fastly</span>: <span class=\"string\">&#x27;https://fastly.jsdelivr.net/combine&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">gcore</span>: <span class=\"string\">&#x27;https://gcore.jsdelivr.net/combine&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">testingcf</span>: <span class=\"string\">&#x27;https://testingcf.jsdelivr.net/combine&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">test1</span>: <span class=\"string\">&#x27;https://test1.jsdelivr.net/combine&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">tianli</span>: <span class=\"string\">&#x27;https://cdn1.tianli0.top/combine&#x27;</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">npm</span>: &#123;</span><br><span class=\"line\">    <span class=\"attr\">jsdelivr</span>: <span class=\"string\">&#x27;https://cdn.jsdelivr.net/npm&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">fastly</span>: <span class=\"string\">&#x27;https://fastly.jsdelivr.net/npm&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">gcore</span>: <span class=\"string\">&#x27;https://gcore.jsdelivr.net/npm&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">testingcf</span>: <span class=\"string\">&#x27;https://testingcf.jsdelivr.net/npm&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">test1</span>: <span class=\"string\">&#x27;https://test1.jsdelivr.net/npm&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">unpkg</span>: <span class=\"string\">&#x27;https://unpkg.com&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">tianli</span>: <span class=\"string\">&#x27;https://cdn1.tianli0.top/npm&#x27;</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">self.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&#x27;install&#x27;</span>, <span class=\"keyword\">async</span> () =&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">await</span> self.<span class=\"title function_\">skipWaiting</span>()</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">self.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&#x27;activate&#x27;</span>, <span class=\"keyword\">async</span> () =&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">await</span> self.<span class=\"property\">clients</span>.<span class=\"title function_\">claim</span>()</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">self.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&#x27;fetch&#x27;</span>, <span class=\"keyword\">async</span> (event) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">    event.<span class=\"title function_\">respondWith</span>(<span class=\"title function_\">handleRequest</span>(event.<span class=\"property\">request</span>))</span><br><span class=\"line\">  &#125; <span class=\"keyword\">catch</span> (e) &#123;&#125;</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 返回响应</span></span><br><span class=\"line\"><span class=\"keyword\">async</span> <span class=\"keyword\">function</span> <span class=\"title function_\">progress</span>(<span class=\"params\">res</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Response</span>(<span class=\"keyword\">await</span> res.<span class=\"title function_\">arrayBuffer</span>(), &#123;</span><br><span class=\"line\">    <span class=\"attr\">status</span>: res.<span class=\"property\">status</span>,</span><br><span class=\"line\">    <span class=\"attr\">headers</span>: res.<span class=\"property\">headers</span></span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">handleRequest</span>(<span class=\"params\">req</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> urls = []</span><br><span class=\"line\">  <span class=\"keyword\">const</span> urlStr = req.<span class=\"property\">url</span></span><br><span class=\"line\">  <span class=\"keyword\">let</span> urlObj = <span class=\"keyword\">new</span> <span class=\"title function_\">URL</span>(urlStr)</span><br><span class=\"line\">  <span class=\"comment\">// 为了获取 cdn 类型</span></span><br><span class=\"line\">  <span class=\"comment\">// 例如获取gh (https://cdn.jsdelivr.net/gh)</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> path = urlObj.<span class=\"property\">pathname</span>.<span class=\"title function_\">split</span>(<span class=\"string\">&#x27;/&#x27;</span>)[<span class=\"number\">1</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// 匹配 cdn</span></span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">const</span> type <span class=\"keyword\">in</span> cdn) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (type === path) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">for</span> (<span class=\"keyword\">const</span> key <span class=\"keyword\">in</span> cdn[type]) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">const</span> url = cdn[type][key] + urlObj.<span class=\"property\">pathname</span>.<span class=\"title function_\">replace</span>(<span class=\"string\">&#x27;/&#x27;</span> + path, <span class=\"string\">&#x27;&#x27;</span>)</span><br><span class=\"line\">        urls.<span class=\"title function_\">push</span>(url)</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// 如果上方 cdn 遍历 匹配到 cdn 则直接统一发送请求(不会往下执行了)</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (urls.<span class=\"property\">length</span>) <span class=\"keyword\">return</span> <span class=\"title function_\">fetchAny</span>(urls)</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// 将用户访问的当前网站与所有源站合并</span></span><br><span class=\"line\">  <span class=\"keyword\">let</span> origins = [...<span class=\"keyword\">new</span> <span class=\"title class_\">Set</span>([location.<span class=\"property\">origin</span>, ...origin])]</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// 遍历判断当前请求是否是源站主机</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> is = origins.<span class=\"title function_\">find</span>(<span class=\"function\">(<span class=\"params\">i</span>) =&gt;</span> <span class=\"keyword\">new</span> <span class=\"title function_\">URL</span>(urlStr).<span class=\"property\">hostname</span> === <span class=\"keyword\">new</span> <span class=\"title function_\">URL</span>(i).<span class=\"property\">hostname</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// 如果是源站，则竞速获取(不会往下执行了)</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (is) &#123;</span><br><span class=\"line\">    origins = origins.<span class=\"title function_\">map</span>(<span class=\"function\">(<span class=\"params\">i</span>) =&gt;</span> i + urlObj.<span class=\"property\">pathname</span> + urlObj.<span class=\"property\">search</span>)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"title function_\">fetchAny</span>(origins)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"comment\">// 抛出异常是为了让sw不拦截请求</span></span><br><span class=\"line\">  <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Error</span>(<span class=\"string\">&#x27;不是源站&#x27;</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Promise.any 的 polyfill</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">createPromiseAny</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"title class_\">Promise</span>.<span class=\"property\">any</span> = <span class=\"keyword\">function</span> (<span class=\"params\">promises</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">      promises = <span class=\"title class_\">Array</span>.<span class=\"title function_\">isArray</span>(promises) ? promises : []</span><br><span class=\"line\">      <span class=\"keyword\">let</span> len = promises.<span class=\"property\">length</span></span><br><span class=\"line\">      <span class=\"keyword\">let</span> errs = []</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (len === <span class=\"number\">0</span>) <span class=\"keyword\">return</span> <span class=\"title function_\">reject</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">AggregateError</span>(<span class=\"string\">&#x27;All promises were rejected&#x27;</span>))</span><br><span class=\"line\">      promises.<span class=\"title function_\">forEach</span>(<span class=\"function\">(<span class=\"params\">p</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!p <span class=\"keyword\">instanceof</span> <span class=\"title class_\">Promise</span>) <span class=\"keyword\">return</span> <span class=\"title function_\">reject</span>(p)</span><br><span class=\"line\">        p.<span class=\"title function_\">then</span>(</span><br><span class=\"line\">          <span class=\"function\">(<span class=\"params\">res</span>) =&gt;</span> <span class=\"title function_\">resolve</span>(res),</span><br><span class=\"line\">          <span class=\"function\">(<span class=\"params\">err</span>) =&gt;</span> &#123;</span><br><span class=\"line\">            len--</span><br><span class=\"line\">            errs.<span class=\"title function_\">push</span>(err)</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (len === <span class=\"number\">0</span>) <span class=\"title function_\">reject</span>(<span class=\"keyword\">new</span> <span class=\"title class_\">AggregateError</span>(errs))</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        )</span><br><span class=\"line\">      &#125;)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 发送所有请求</span></span><br><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">fetchAny</span>(<span class=\"params\">urls</span>) &#123;</span><br><span class=\"line\">  <span class=\"comment\">// 中断一个或多个请求</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> controller = <span class=\"keyword\">new</span> <span class=\"title class_\">AbortController</span>()</span><br><span class=\"line\">  <span class=\"keyword\">const</span> signal = controller.<span class=\"property\">signal</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// 遍历将所有的请求地址转换为promise</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> <span class=\"title class_\">PromiseAll</span> = urls.<span class=\"title function_\">map</span>(<span class=\"function\">(<span class=\"params\">url</span>) =&gt;</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> <span class=\"title class_\">Promise</span>(<span class=\"function\">(<span class=\"params\">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"title function_\">fetch</span>(url, &#123; signal &#125;)</span><br><span class=\"line\">        .<span class=\"title function_\">then</span>(progress)</span><br><span class=\"line\">        .<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">res</span>) =&gt;</span> &#123;</span><br><span class=\"line\">          <span class=\"keyword\">const</span> r = res.<span class=\"title function_\">clone</span>()</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (r.<span class=\"property\">status</span> !== <span class=\"number\">200</span>) <span class=\"title function_\">reject</span>(<span class=\"literal\">null</span>)</span><br><span class=\"line\">          controller.<span class=\"title function_\">abort</span>() <span class=\"comment\">// 中断</span></span><br><span class=\"line\">          <span class=\"title function_\">resolve</span>(r)</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">        .<span class=\"title function_\">catch</span>(<span class=\"function\">() =&gt;</span> <span class=\"title function_\">reject</span>(<span class=\"literal\">null</span>))</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// 判断浏览器是否支持 Promise.any</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (!<span class=\"title class_\">Promise</span>.<span class=\"property\">any</span>) <span class=\"title function_\">createPromiseAny</span>()</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// 谁先返回&quot;成功状态&quot;则返回谁的内容，如果都返回&quot;失败状态&quot;则返回null</span></span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"title class_\">Promise</span>.<span class=\"title function_\">any</span>(<span class=\"title class_\">PromiseAll</span>)</span><br><span class=\"line\">    .<span class=\"title function_\">then</span>(<span class=\"function\">(<span class=\"params\">res</span>) =&gt;</span> res)</span><br><span class=\"line\">    .<span class=\"title function_\">catch</span>(<span class=\"function\">() =&gt;</span> <span class=\"literal\">null</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n",
            "tags": [
                "JavaScript",
                "教程"
            ]
        },
        {
            "id": "https://blog.imlete.cn/article/Google-Voice-Protect.html",
            "url": "https://blog.imlete.cn/article/Google-Voice-Protect.html",
            "title": "Google Voice 如何保号",
            "date_published": "2021-03-01T14:01:27.000Z",
            "content_html": "<p>Google Voice 如何保号 ？此篇文章不进行注册环节<br>国人注册的话还是免了吧，除非你已经有了一个美国号码，并且有一个美国 ip 才能注册<br>如果你是想用<code>textnow</code>进行验证的话，目前 textnow 已经不能接收到 Google Voice 的验证码了<br>我建议使用万能的淘宝 10 几块钱就能买到(我自己就是淘宝买的号)</p>\n<ol>\n<li>买到之后<blockquote>\n<p>修改密码<br>修改辅助邮箱(你觉得还不够就绑定一个电话号码)<br>删除之前登陆过的设备<br>最后转号(当然在已得到号后就转号也可以，不转号也行)</p>\n</blockquote>\n</li>\n</ol>\n<p>关于如何转号我也不多 bb 了，话题已经扯很远了</p>\n<h2 id=\"正文\"><a href=\"#正文\" class=\"headerlink\" title=\"正文\"></a>正文</h2><ol>\n<li>关于谷歌回收<blockquote>\n<p>谷歌政策目前是 6 个月不用（收短信不算用，必须是发短信或则打电话才算用）谷歌语音 Google voice 会被回收，政策有变动，所以这个要以谷歌政策官方通知为准，一般回收前一个月内每周都会有邮件通知，所以应多注意谷歌邮箱邮件</p>\n</blockquote>\n</li>\n<li>关于如何发短信和打电话这个不用教吧</li>\n</ol>\n<p>如果你有空的话可以手动随便输入一个美国号电话号码发一条或几条短信就可以了<br>(或者到接码平台复制一个美国号码发几条短信，然后自己再去核对就也是可以的)<br>关于扣费问题因该是给<code>美国或者加拿大</code>手机号发短信和打电话是<code>免费</code>的<br>拨打/发送其他地区号码就会收费，咱们用 Google Voice<code>又不是为了打电话</code>，只是为了注册国外网站或者产品用的，因为大陆手机号注册国外网站多多少少肯定是有一点限制的</p>\n<p>像我这样的(程序员)肯定是要用全自动的啦~~</p>\n<h2 id=\"发送订阅短信\"><a href=\"#发送订阅短信\" class=\"headerlink\" title=\"发送订阅短信\"></a>发送订阅短信</h2><p>发送短信内容:<code>JOIN</code>到<code>22122</code>这个电话号码，这个号码会每月发送两条短信给你，但只是收短信，可能会保不了号<br><img src=\"/img/Google-Voice-Protect/GV1.png\" alt=\"22122-JOIN\"></p>\n<h2 id=\"回复订阅短信\"><a href=\"#回复订阅短信\" class=\"headerlink\" title=\"回复订阅短信\"></a>回复订阅短信</h2><ol>\n<li>打开 GoogleVoice 的设置，把<code>将短信转发到电子邮件地址</code>打开<br><img src=\"/img/Google-Voice-Protect/GV2.png\" alt=\"22122-JOIN\"></li>\n<li>打开谷歌邮箱<a href=\"https://mail.google.com/\">https://mail.google.com/</a><br>点击搜索栏右边的下拉图标，展开，创建过滤规则<code>@txt.voice.google.com</code><br><img src=\"/img/Google-Voice-Protect/GV3.png\" alt=\"22122-JOIN\"><br><img src=\"/img/Google-Voice-Protect/GV4.png\" alt=\"22122-JOIN\"></li>\n<li>打开谷歌 appsScript：<a href=\"https://script.google.com/home\">https://script.google.com/home</a><br>选择左上角的新建项目，输入如下代码，修改自己的信息后保存</li>\n</ol>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">AutoReply</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> labelObj = <span class=\"title class_\">GmailApp</span>.<span class=\"title function_\">getUserLabelByName</span>(<span class=\"string\">&quot;AutoReply&quot;</span>); <span class=\"comment\">//这里面的AutoReply填过滤条件规则的标签</span></span><br><span class=\"line\">  <span class=\"keyword\">var</span> gmailThreads;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> messages;</span><br><span class=\"line\">  <span class=\"keyword\">var</span> sender;</span><br><span class=\"line\">  <span class=\"comment\">//获取我们上面指定归档里面的未读邮件，然后读取，回复，删除</span></span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> gg = <span class=\"number\">0</span>; gg &lt; labelObj.<span class=\"title function_\">getUnreadCount</span>(); gg++) &#123;</span><br><span class=\"line\">    gmailThreads = labelObj.<span class=\"title function_\">getThreads</span>()[gg];</span><br><span class=\"line\">    messages = gmailThreads.<span class=\"title function_\">getMessages</span>();</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> ii = <span class=\"number\">0</span>; ii &lt; messages.<span class=\"property\">length</span>; ii++) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (messages[ii].<span class=\"title function_\">isUnread</span>()) &#123;</span><br><span class=\"line\">        sender = messages[ii].<span class=\"title function_\">getFrom</span>();</span><br><span class=\"line\">        <span class=\"title class_\">MailApp</span>.<span class=\"title function_\">sendEmail</span>(</span><br><span class=\"line\">          sender,</span><br><span class=\"line\">          <span class=\"string\">&quot;Auto Reply&quot;</span>,</span><br><span class=\"line\">          <span class=\"string\">&quot;你好，您的来信已收到，主人将会尽快回复您。———来自机器人回复。&quot;</span></span><br><span class=\"line\">        ); <span class=\"comment\">//回复邮件</span></span><br><span class=\"line\">        messages[ii].<span class=\"title function_\">markRead</span>(); <span class=\"comment\">//标记为已读</span></span><br><span class=\"line\">        messages[ii].<span class=\"title function_\">moveToTrash</span>(); <span class=\"comment\">//删除邮件</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ol start=\"4\">\n<li>点击左侧的触发器，然后右下角添加触发器，按如下图设置就可以了<br><img src=\"/img/Google-Voice-Protect/GV5.png\" alt=\"22122-JOIN\"></li>\n</ol>\n<p>到此处即已经完成了，接下来我们到 GoogleVoice 向<code>22122</code>发一条信息测试一下<br>可以看出我发送了 test1 和 test2 触发了两次(只得到了一条回复，延迟的原有稍后就会再收到一条，我这只截到了一条)<br>此处的 test1 和 test2 只是测试，前面已经发送<code>JONI</code>订阅了<br>每月会自动发送两条短信到号上，触发器就会自动回复，达到保号的目的<br><img src=\"/img/Google-Voice-Protect/GV6.png\" alt=\"22122-JOIN\"></p>\n",
            "tags": [
                "记录",
                "教程"
            ]
        },
        {
            "id": "https://blog.imlete.cn/article/hexo-seo-autopush.html",
            "url": "https://blog.imlete.cn/article/hexo-seo-autopush.html",
            "title": "Hexo 每天自动提交网站url到搜索引擎",
            "date_published": "2020-12-02T19:31:38.000Z",
            "content_html": "<p>百度收录很蛋疼<br>在此之前用过<a href=\"https://www.antmoe.com/\">@小康</a>写的<code>hexo-baidupush</code>很不错。</p>\n<p>由于Bing和Google只爬sitemap.xml收录已经很快了，但总是爬sitemap.xml效率肯定没Api提交的快。<br>自己写了Bing的定时自动提交，目前还不支持Google定时自动提交，因为Google的API提交方式很鸡肋</p>\n<blockquote>\n<p>Google indexing API有两个问题</p>\n<ol>\n<li>账户安全密钥不能被泄露(谷歌只支持这种提交方式，对于没有后台的hexo来说是很致命的)</li>\n<li>API提交只能使用json，而这个json格式只能包含一个网站url链接<br>不能多url放到一个json里，所以需要多次请求提交(baidu、bing、只需一次请求)</li>\n</ol>\n</blockquote>\n<p>Google 最优提交方案是本地提交(能解决以上两个问题)<br>如果你有什么好的处理方案欢迎与我交流</p>\n<h2 id=\"正文\"><a href=\"#正文\" class=\"headerlink\" title=\"正文\"></a>正文</h2><h3 id=\"安装插件\"><a href=\"#安装插件\" class=\"headerlink\" title=\"安装插件\"></a>安装插件</h3><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i hexo-seo-autopush --save</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h3><p>在hexo 的config.yml里添加</p>\n<p>hexo-seo-autopush配置</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># enable: 开启/关闭 推送</span></span><br><span class=\"line\"><span class=\"comment\"># count: 每次提交最新的10篇文章</span></span><br><span class=\"line\"><span class=\"comment\"># https://github.com/lete114/hexo-seo-autopush</span></span><br><span class=\"line\"><span class=\"attr\">hexo_seo_autopush:</span></span><br><span class=\"line\">  <span class=\"attr\">baidu:</span></span><br><span class=\"line\">    <span class=\"attr\">enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">    <span class=\"attr\">count:</span> <span class=\"number\">100</span></span><br><span class=\"line\">  <span class=\"attr\">bing:</span></span><br><span class=\"line\">    <span class=\"attr\">enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">    <span class=\"attr\">count:</span> <span class=\"number\">10</span></span><br><span class=\"line\">  <span class=\"attr\">google:</span></span><br><span class=\"line\">    <span class=\"attr\">enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\">    <span class=\"attr\">count:</span> <span class=\"number\">10</span></span><br><span class=\"line\">    <span class=\"attr\">google_file:</span> <span class=\"string\">google_service_account.json</span> <span class=\"comment\"># 谷歌服务账户</span></span><br></pre></td></tr></table></figure>\n<p>添加<code>Google Push</code>配置和解决push后没有GitHub Actions <code>.github\\workflows\\AutoPush.yml</code>文件的问题</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Deployment</span></span><br><span class=\"line\"><span class=\"comment\">## Docs: https://hexo.io/docs/one-command-deployment</span></span><br><span class=\"line\"><span class=\"attr\">deploy:</span></span><br><span class=\"line\">   <span class=\"bullet\">-</span> <span class=\"attr\">type:</span> <span class=\"string\">git</span></span><br><span class=\"line\">     <span class=\"attr\">repo:</span> <span class=\"string\">https://github.com/lete114/Test.git</span></span><br><span class=\"line\">     <span class=\"attr\">branch:</span> <span class=\"string\">main</span></span><br><span class=\"line\">     <span class=\"attr\">ignore_hidden:</span> <span class=\"literal\">false</span>  <span class=\"comment\"># 忽略隐藏文件及文件夹(目录)</span></span><br><span class=\"line\">   <span class=\"bullet\">-</span> <span class=\"attr\">type:</span> <span class=\"string\">GooglePush</span> <span class=\"comment\"># 谷歌提交</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"获取站长平台密钥\"><a href=\"#获取站长平台密钥\" class=\"headerlink\" title=\"获取站长平台密钥\"></a>获取站长平台密钥</h3><h4 id=\"Baidu-Key\"><a href=\"#Baidu-Key\" class=\"headerlink\" title=\"Baidu Key\"></a>Baidu Key</h4><ol>\n<li>打开百度站长平台，点击左侧的普通收录<a href=\"https://ziyuan.baidu.com/\">https://ziyuan.baidu.com/</a><br><img src=\"/img/Hexo-seo-autopush/baidu.png\" alt=\"\"></li>\n</ol>\n<h4 id=\"Bing-Key\"><a href=\"#Bing-Key\" class=\"headerlink\" title=\"Bing Key\"></a>Bing Key</h4><ol>\n<li>打开Bing站长平台，<a href=\"https://www.bing.com/webmasters/home\">https://www.bing.com/webmasters/home</a></li>\n<li>点击右上角头像 旁边的齿轮，跟着下图操作<br><img src=\"/img/Hexo-seo-autopush/bing.png\" alt=\"\"></li>\n</ol>\n<h4 id=\"Google-Key\"><a href=\"#Google-Key\" class=\"headerlink\" title=\"Google Key\"></a>Google Key</h4><ol>\n<li>打开Google indexing API<a href=\"https://console.developers.google.com/flows/enableapi?apiid=indexing.googleapis.com&credential=client_key\">官网</a></li>\n<li>选择创建项目，点击继续</li>\n<li>点击转到凭据页面</li>\n<li>跟着如下图片步骤<br><img src=\"/img/Hexo-seo-autopush/GoogleProof.png\" alt=\"GoogleProof\"><br><img src=\"/img/Hexo-seo-autopush/GoogleAddProof.png\" alt=\"GoogleAddProof\"><br><img src=\"/img/Hexo-seo-autopush/GoogleNone.png\" alt=\"GoogleNone\"><br><img src=\"/img/Hexo-seo-autopush/GoogleKey.png\" alt=\"GoogleKey\"><br>json文件内的内容<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;type&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;service_account&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;project_id&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;elated-guild-298003&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;private_key_id&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;cf58d669c0e8c8e082b2c403ade5e2548078e384&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;private_key&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;-----BEGIN PRIVATE KEY-----\\nMIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQDEAJw89yeylRrA\\nB+bzOAfQQNgOCABIwEKCy5mMxWSaiXy2RktyCJWjMR2Pgz770NJgClQHPJjsFn0c\\nukHufpnuiX3VPlimLANPCRFdU/qp+yiaw4quIhYF1UZJkhmhL30anghUcvi+r9hQ\\nw+RwcKrgA4EUzqUJaPdvjtzSoo315PPGfR91ASD5S8gE02yVI8igtYMX7v2x1JYR\\n7PwHJwOVemiM9lot8ilvoUbV4BU0vSlwFoxKMJAbEXTmJjEKQi9992rcMW0GzXO8\\ncHldUUtURXkt3VFjYTH27KhHiTkTXw+uZRBu1rkubDJkS8lGIWN7Fc/r4HMMCVTu\\nXPS6HbJ/AgMBAAECggEANSS7OBaFd3jRL3cVCiZLjA5A5pEJzq/+eKtOn2oYDISx\\nwVRO+YTVWdGj47kg1zM4D11NikbGaeDxHFxuKwW9o/04lpyYebneTcw2Hpl6EiOs\\nz0WssOlCEmPQ8nrAI0GWiKSHuqoPwtg37TIoGsqZsjKRCby759DDokZYnm3/0sc+\\niEllT0ZyBZhGDzyguVLEdCIR2P02q/hQzLyd6ejWGGwZebImbGoILhmuOjVrco0p\\nV0JbrrNskjM5Epe7w+CpGftEASJ7Dxa8oj0qIT6cyAipra2AZAGnG9jrLcWpJuhu\\nvNeDIFnTfpNEac+khXZZE2++MIQfTX9wGJc8tox2vQKBgQD6yiNvAL7sxExiy6ER\\ntLtFQ3bvmMpKRFGvFOyPOtMbmjZ3D1GEtNNKGH4v1TI+tncEy7Q5Dm7nWwpi8yvL\\nbh8xKghelAc/CU1nw0xDEDCkMbAwpFg5A5ZDImy3LZsQh0kNXniIMy1vMSt5yLKS\\n80gXQKGCxG8t3rP8Qd/2a55g1QKBgQDIExP1nG9sHJaigmitEUwr0Ow6Shqr56Me\\nd7995gaV1oLWWCQzrXt/viWkb1W5ZGIxzcWNWz99m4CbvqfewRr598Eenald0csN\\nVcIEk+0C+6KqA+jU9Tfs2zow/C7JuKULP2N++o0EoSz/ngokP7f1yLOYbr507v/R\\n0cLElQBQAwKBgAbxDWYHKUG4dTzO0hiBXiWepm4fVooTtgcYlyunvywmapeFDwaT\\nUr3cS7HbPtbJiiXR1Z02rw8sT+9JN88brzVXKoAjrMer5D6ZA0Vf71i8H1pZUi/R\\nz5jwHP48/uvIMtdx4/gxInLPc5qdWYQDw90Q5ueNtF4aqfSzhhV2CR45AoGBAJN9\\nPOF6iMjx6jmyWOf8MGK8iOgPaMoA4Ea9j/SHdaNPlvPb1hQid0AcNDObv14Dmj+M\\nqW0jLxKxZ4VobufPAsvyz/J51zjKRx11cqldQwNH7QnYB/O1MZzxn1wtC3C5JTG9\\ncONSYFJhXoKxRliigEI3ye089jnNVdifAS1ZiflxAoGBANTX1fEMEeNuYU0v3rtd\\n5CkPZg4TNZ+y2MGl5xR1LdIgrJ8c9xKoW4rpp7SsOIvHpWX494f90D7o9uFEGSQ4\\nyQK53jVzJ0ekGV5BdPF3n3/2j2VEqFLHi7LL4CJSxr6ci7OfBoHOGE8odhevQCCK\\njnFzEin0QsBEgIC73fBh6XcH\\n-----END PRIVATE KEY-----\\n&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;client_email&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;googleindexing@elated-guild-298003.iam.gserviceaccount.com&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;client_id&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;103034240916368863393&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;auth_uri&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;https://accounts.google.com/o/oauth2/auth&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;token_uri&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;https://oauth2.googleapis.com/token&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;auth_provider_x509_cert_url&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;https://www.googleapis.com/oauth2/v1/certs&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;client_x509_cert_url&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;https://www.googleapis.com/robot/v1/metadata/x509/googleindexing%40elated-guild-298003.iam.gserviceaccount.com&quot;</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure></li>\n<li>打开<a href=\"https://search.google.com/search-console\">谷歌站长平台</a><br><img src=\"/img/Hexo-seo-autopush/GoogleAddUser.png\" alt=\"GoogleAddUser\"><br><img src=\"/img/Hexo-seo-autopush/GoogleAddEmail.png\" alt=\"GoogleAddEmail\"></li>\n</ol>\n<h3 id=\"配置博客仓库\"><a href=\"#配置博客仓库\" class=\"headerlink\" title=\"配置博客仓库\"></a>配置博客仓库</h3><ol>\n<li>Name必须是<code>baidu_token</code>和<code>bing_apikey</code>(不区分大小写)<br><img src=\"/img/Hexo-seo-autopush/Secrets.png\" alt=\"Secrets\"></li>\n<li>添加完成后<br><img src=\"/img/Hexo-seo-autopush/Secrets-token.png\" alt=\"Secrets-token\"></li>\n</ol>\n<h3 id=\"谷歌的一些问题\"><a href=\"#谷歌的一些问题\" class=\"headerlink\" title=\"谷歌的一些问题\"></a>谷歌的一些问题</h3><p>触发谷歌提交的命令是<code>hexo d</code></p>\n<p>由于谷歌需要配合Google indexing API平台提供的json进行提交，而这个json格式不能泄露<br>为防止json泄露只能本地提交，将json放到hexo根目录可自定义重命名(必须对应插件的配置)</p>\n<blockquote>\n<p>如果你的使用Github Actions自动部署的话请把仓库设置为私有<br><img src=\"/img/Hexo-seo-autopush/GoogleConfig.png\" alt=\"GoogleConfig\"></p>\n</blockquote>\n<h3 id=\"提交成功返回状态码\"><a href=\"#提交成功返回状态码\" class=\"headerlink\" title=\"提交成功返回状态码\"></a>提交成功返回状态码</h3><p>以上步骤完成后即可<code>hexo d</code>部署了</p>\n<ol>\n<li>看看Github仓库是否上传成功<br><img src=\"/img/Hexo-seo-autopush/code.png\" alt=\"\"></li>\n<li>点击<code>Actions</code>查看是否执行<br><img src=\"/img/Hexo-seo-autopush/Actions.png\" alt=\"\"></li>\n<li>点击<code>Auto Push</code>—-&gt;<code>build</code>—–&gt;点击第2步<code>自动提交</code><br>如图43行<br><img src=\"/img/Hexo-seo-autopush/build.png\" alt=\"\"><figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// baidu返回的结果</span></span><br><span class=\"line\"><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">\t<span class=\"attr\">&quot;remain&quot;</span><span class=\"punctuation\">:</span> <span class=\"number\">2060</span><span class=\"punctuation\">,</span>  <span class=\"comment\">// 表示当天剩余的可推送url条数</span></span><br><span class=\"line\">\t<span class=\"attr\">&quot;success&quot;</span><span class=\"punctuation\">:</span> <span class=\"number\">47</span>    <span class=\"comment\">// 成功推送的url条数</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span> </span><br><span class=\"line\"><span class=\"comment\">// bing返回结果(错误)</span></span><br><span class=\"line\"><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">\t<span class=\"attr\">&quot;ErrorCode&quot;</span><span class=\"punctuation\">:</span> <span class=\"number\">2</span><span class=\"punctuation\">,</span>  <span class=\"comment\">// 错误 </span></span><br><span class=\"line\">\t<span class=\"attr\">&quot;Message&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;ERROR!!! Quota remaining for today: 2, Submitted: 47&quot;</span></span><br><span class=\"line\">    <span class=\"comment\">// Message：表示 你目前只剩2个url推送，而你现在推送的是47条url</span></span><br><span class=\"line\">    <span class=\"comment\">// bing新用户开始每日只有10个推送额，据我了解连续推送10天(这我也不确定)</span></span><br><span class=\"line\">    <span class=\"comment\">// 如果出现这个错误的话，你就只能先手动添加等系统给你分配额了(分配9999)</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br><span class=\"line\"><span class=\"comment\">// bing返回结果(成功)</span></span><br><span class=\"line\"><span class=\"punctuation\">&#123;</span><span class=\"attr\">&quot;d&quot;</span><span class=\"punctuation\">:</span><span class=\"keyword\">null</span><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure></li>\n<li>Google 返回状态码<br>成功返回<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Google response<span class=\"punctuation\">:</span>  <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">  urlNotificationMetadata<span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    url<span class=\"punctuation\">:</span> &#x27;https<span class=\"punctuation\">:</span><span class=\"comment\">//blog.lete114.top/article/hexo-seo-autopush.html&#x27;,</span></span><br><span class=\"line\">    latestUpdate<span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">      url<span class=\"punctuation\">:</span> &#x27;https<span class=\"punctuation\">:</span><span class=\"comment\">//blog.lete114.top/article/hexo-seo-autopush.html&#x27;,</span></span><br><span class=\"line\">      type<span class=\"punctuation\">:</span> &#x27;URL_UPDATED&#x27;<span class=\"punctuation\">,</span></span><br><span class=\"line\">      notifyTime<span class=\"punctuation\">:</span> &#x27;<span class=\"number\">2020</span><span class=\"number\">-12</span><span class=\"number\">-08</span>T02<span class=\"punctuation\">:</span><span class=\"number\">31</span><span class=\"punctuation\">:</span><span class=\"number\">32.871417693</span>Z&#x27;</span><br><span class=\"line\">    <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\">  <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n出现此错误需要<code>翻墙</code><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">FetchError: request to https://www.googleapis.com/oauth2/v4/token failed, reason: connect ETIMEDOUT 172.217.27.138:443</span><br><span class=\"line\">    at ClientRequest.&lt;anonymous&gt; (D:\\Lete\\GitHub\\Hexo-Butterfly\\node_modules\\node-fetch\\lib\\index.js:1461:11)</span><br><span class=\"line\">    at ClientRequest.emit (events.js:321:20)</span><br><span class=\"line\">    at TLSSocket.socketErrorListener (_http_client.js:426:9)</span><br><span class=\"line\">    at TLSSocket.emit (events.js:321:20)</span><br><span class=\"line\">    at emitErrorNT (internal/streams/destroy.js:92:8)</span><br><span class=\"line\">    at emitErrorAndCloseNT (internal/streams/destroy.js:60:3)</span><br><span class=\"line\">    at processTicksAndRejections (internal/process/task_queues.js:84:21) &#123;</span><br><span class=\"line\">  message: <span class=\"string\">&#x27;request to https://www.googleapis.com/oauth2/v4/token failed, reason: connect ETIMEDOUT 172.217.27.138:443&#x27;</span>,</span><br><span class=\"line\">  <span class=\"built_in\">type</span>: <span class=\"string\">&#x27;system&#x27;</span>,</span><br><span class=\"line\">  errno: <span class=\"string\">&#x27;ETIMEDOUT&#x27;</span>,</span><br><span class=\"line\">  code: <span class=\"string\">&#x27;ETIMEDOUT&#x27;</span>,</span><br><span class=\"line\">  config: &#123;</span><br><span class=\"line\">    method: <span class=\"string\">&#x27;POST&#x27;</span>,</span><br><span class=\"line\">    url: <span class=\"string\">&#x27;https://www.googleapis.com/oauth2/v4/token&#x27;</span>,</span><br><span class=\"line\">    data: &#123;</span><br><span class=\"line\">      grant_type: <span class=\"string\">&#x27;urn:ietf:params:oauth:grant-type:jwt-bearer&#x27;</span>,</span><br><span class=\"line\">      assertion: <span class=\"string\">&#x27;eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJnb29nbGVpbmRleGluZ0BzdGF0ZWx5LXRyYW5zaXQtMjk3NzE1LmlhbS5nc2VydmljZWFjY291bnQuY29tIiwic2NvcGUiOiJodHRwczovL3d3d</span></span><br></pre></td></tr></table></figure></li>\n</ol>\n",
            "tags": [
                "教程",
                "SEO",
                "Hexo"
            ]
        },
        {
            "id": "https://blog.imlete.cn/article/jsdelivr-video.html",
            "url": "https://blog.imlete.cn/article/jsdelivr-video.html",
            "title": "利用jsdelivr搭建视频床",
            "date_published": "2020-11-22T19:17:56.000Z",
            "content_html": "<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>相信很多人都用过图床，大部分都是利用jsdelivr当图床，从而得到一个免费的图床，并且自带CDN加速<br>但是有很多人想存储视频这么办呢？有没有视频床呢？把视频上传仓库后，jsdelivr是能抓取的，而且也能用<br>不过只能存储20MB以内的资源，并且jsdelivr不能解析视频类资源，打开视频格式的链接会自动下载，无法播放<br>那怎么办呢？只要你想就没有你做不到的，那么就在此记录一下过程，就不多说废话了，看正文 &lt;(￣︶￣)↗[GO!]</p>\n<h2 id=\"正文\"><a href=\"#正文\" class=\"headerlink\" title=\"正文\"></a>正文</h2><p>首先你得了解jsdelivr，他只加载20MB以内的资源，如果你的视频正好控制这一范围的话，你就可以使用默认的内容了<br>但是由于jsdelivr对视频资源的解析不友好，所以我们就得对视频资源做一定的处理</p>\n<p>用过QQ浏览器的都知道下载网页上的视频下来都是M3U8的视频格式，即使你不下载，只是看视频都会产生M3U8文件和TS文件</p>\n<h2 id=\"什么是M3U8、TS文件？\"><a href=\"#什么是M3U8、TS文件？\" class=\"headerlink\" title=\"什么是M3U8、TS文件？\"></a>什么是M3U8、TS文件？</h2><p><strong>M3U8</strong><br>M3U8是指UTF-8编码格式的M3U文件(M3U使用Latin-1字符集编码)<br>M3U文件是一个记录索引的纯文本文件，打开它时播放软件并不会播放它<br>而是根据它的索引找到对应的音视频文件的网络地址进行在线播放</p>\n<p><strong>TS</strong><br>ts是日本高清摄像机拍摄下进行的封装格式，全称为MPEG2-TS。ts即”Transport Stream”的缩写。<br>将一个视频文件(MP4)切片分为很多个TS文件，一个TS文件的视频时常可以自定义，比如切片为5秒<br>那么其他ts文件也是5秒，但是这个不是完全准确，也就是说会有误差，会产生4-7秒左右的ts视频文件</p>\n<p>那他是这么工作的呢？(以下图片是本地运行过程)</p>\n<p><img src=\"/img/Jsdelivr-Video/m3u8-ts.png\" alt=\"m3u8-ts\"></p>\n<h2 id=\"ffmpeg-工具\"><a href=\"#ffmpeg-工具\" class=\"headerlink\" title=\"ffmpeg 工具\"></a>ffmpeg 工具</h2><p>什么是ffmpeg在这里我就不再赘述了，感兴趣的可以自行搜索</p>\n<p>了解了M3U8和TS，我该怎么把视频切片呢?<br>使用ffmpeg 工具进行切片</p>\n<p>官网：<a href=\"https://ffmpeg.org/download.html\">https://ffmpeg.org/download.html</a></p>\n<p>下载解压后打开<code>bin</code>目录，在里面找到<code>ffmpeg.exe</code>复制到自己新建的一个文件夹里，再把想要切片的视频Copy进来</p>\n<h2 id=\"视频切片\"><a href=\"#视频切片\" class=\"headerlink\" title=\"视频切片\"></a>视频切片</h2><blockquote>\n<p>当前目录下有<br>Lete.mp4<br>ffmpeg.exe</p>\n</blockquote>\n<p>打开cmd，cd进入到刚刚新建的文件夹，关于怎么操作我就不多bb了<br>既然都用上Github，用jsdelivr加速了，你电脑里一定装了Git工具<br>在当前目录打开<code>Git Bash</code> 命令行</p>\n<p>(cmd不需要<code>./</code>)</p>\n<ol>\n<li>将mp4转成ts格式，1对1，转换后视频质量与大小无变化。(执行下方代码得到<code>Lete.ts</code>)<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./ffmpeg.exe -y -i Lete.mp4 -vcodec copy -acodec copy -vbsf h264_mp4toannexb Lete.ts</span><br></pre></td></tr></table></figure></li>\n<li>按时间隔分片，1对N，下面的5即<code>每个分片5秒</code>，自行修改<br><code>-segment_list Lete.m3u8</code>为切片后得到的m3u8文件<br><code>-segment_time 5 Lete%03d.ts</code>为切片后得到的ts文件名<code>5</code>代表每个ts文件5秒播放时常(有误差，不完全5秒)<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./ffmpeg -i Lete.ts -c copy -map 0 -f segment -segment_list Lete.m3u8 -segment_time 5 Lete%03d.ts</span><br></pre></td></tr></table></figure>\n\n</li>\n</ol>\n<p>这是你的文件了会有如下图文件<br><img src=\"/img/Jsdelivr-Video/1.png\" alt=\"\"></p>\n<p>将这几个文件push到仓库即可<br><img src=\"/img/Jsdelivr-Video/2.png\" alt=\"\"></p>\n<p>现在访问是m3u8是不可以播放视频的(会自动下载对吧)<br><span style='color:red'>注：由于我的GitHub仓库被官方人员禁止了，导致失效</span><br><a href=\"https://cdn.jsdelivr.net/gh/lete114/CDN2/video/4.m3u8\">https://cdn.jsdelivr.net/gh/lete114/CDN2/video/4.m3u8</a><br>访问文件也是不行的(乱码对吧)<br><a href=\"https://cdn.jsdelivr.net/gh/lete114/CDN2/video/4000.ts\">https://cdn.jsdelivr.net/gh/lete114/CDN2/video/4000.ts</a></p>\n<h2 id=\"HLS技术\"><a href=\"#HLS技术\" class=\"headerlink\" title=\"HLS技术\"></a>HLS技术</h2><p>什么是HLS技术？</p>\n<p>HLS (HTTP Live Streaming)是Apple的动态码率自适应技术。主要用于PC和Apple终端的音视频服务。<br>包括一个m3u(8)的索引文件，TS媒体分片文件和key加密串文件。(摘抄自百度百科)</p>\n<p>CDN：<a href=\"https://cdn.jsdelivr.net/npm/hls.js\">https://cdn.jsdelivr.net/npm/hls.js</a></p>\n<h2 id=\"视频播放\"><a href=\"#视频播放\" class=\"headerlink\" title=\"视频播放\"></a>视频播放</h2><p>使用video标签播放视频</p>\n<table>\n<thead>\n<tr>\n<th>属性</th>\n<th>值</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>autoplay</td>\n<td>autoplay</td>\n<td>如果出现该属性，则视频在就绪后马上播放。</td>\n</tr>\n<tr>\n<td>controls</td>\n<td>controls</td>\n<td>如果出现该属性，则向用户显示控件，比如播放按钮。</td>\n</tr>\n<tr>\n<td>height</td>\n<td>pixels</td>\n<td>设置视频播放器的高度。</td>\n</tr>\n<tr>\n<td>loop</td>\n<td>loop</td>\n<td>如果出现该属性，则当媒介文件完成播放后再次开始播放。</td>\n</tr>\n<tr>\n<td>muted</td>\n<td>muted</td>\n<td>规定视频的音频输出应该被静音。</td>\n</tr>\n<tr>\n<td>poster</td>\n<td>URL</td>\n<td>规定视频下载时显示的图像，或者在用户点击播放按钮前显示的图像。</td>\n</tr>\n<tr>\n<td>preload</td>\n<td>preload</td>\n<td>如果出现该属性，则视频在页面加载时进行加载，并预备播放。<br> 如果使用 “autoplay”，则忽略该属性。</td>\n</tr>\n<tr>\n<td>src</td>\n<td>url</td>\n<td>要播放的视频的 URL。</td>\n</tr>\n<tr>\n<td>width</td>\n<td>pixels</td>\n<td>设置视频播放器的宽度。</td>\n</tr>\n</tbody></table>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;https://cdn.jsdelivr.net/npm/hls.js&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">video</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;video&quot;</span> <span class=\"attr\">preload</span> <span class=\"attr\">muted</span> <span class=\"attr\">loop</span> <span class=\"attr\">autoplay</span> <span class=\"attr\">style</span>=<span class=\"string\">&quot;height: 100%;width: 100%;object-fit: cover;&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">video</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">  <span class=\"keyword\">var</span> video = <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(<span class=\"string\">&#x27;video&#x27;</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">  <span class=\"keyword\">var</span> videoSrc = <span class=\"string\">&#x27;https://cdn.jsdelivr.net/gh/lete114/CDN2/video/4.m3u8&#x27;</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">  <span class=\"keyword\">if</span> (<span class=\"title class_\">Hls</span>.<span class=\"title function_\">isSupported</span>()) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"keyword\">var</span> hls = <span class=\"keyword\">new</span> <span class=\"title class_\">Hls</span>();</span></span><br><span class=\"line\"><span class=\"language-javascript\">    hls.<span class=\"title function_\">loadSource</span>(videoSrc);</span></span><br><span class=\"line\"><span class=\"language-javascript\">    hls.<span class=\"title function_\">attachMedia</span>(video);</span></span><br><span class=\"line\"><span class=\"language-javascript\">    hls.<span class=\"title function_\">on</span>(<span class=\"title class_\">Hls</span>.<span class=\"property\">Events</span>.<span class=\"property\">MANIFEST_PARSED</span>, <span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">      video.<span class=\"title function_\">play</span>();</span></span><br><span class=\"line\"><span class=\"language-javascript\">    &#125;);</span></span><br><span class=\"line\"><span class=\"language-javascript\">  &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"效果\"><a href=\"#效果\" class=\"headerlink\" title=\"效果\"></a>效果</h2><script src=\"https://cdn.jsdelivr.net/npm/hls.js\"></script>\n<video id=\"video\" preload muted loop autoplay style=\"height: 100%;width: 100%;object-fit: cover;\">\n</video>\n<script>\n  var video = document.getElementById('video');\n  var videoSrc = 'https://cdn.jsdelivr.net/gh/lete114/CDN2/video/4.m3u8';\n  if (Hls.isSupported()) {\n    var hls = new Hls();\n    hls.loadSource(videoSrc);\n    hls.attachMedia(video);\n    hls.on(Hls.Events.MANIFEST_PARSED, function() {\n      video.play();\n    });\n  }\n</script>\n\n",
            "tags": [
                "记录",
                "教程",
                "jsdelivr"
            ]
        },
        {
            "id": "https://blog.imlete.cn/article/Hexo-Artalk.html",
            "url": "https://blog.imlete.cn/article/Hexo-Artalk.html",
            "title": "Hexo-添加Artalk评论教程",
            "date_published": "2020-09-30T13:28:21.000Z",
            "content_html": "<style>\n  #emoji *{\n      margin: 0 !important;\n  }\n</style>\n\n<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p><a href=\"https://github.com/qwqcode/Artalk\">Artalk</a>是一款简洁有趣的自托管评论系统<br>之前用过Valine评论系统，<a href=\"/article/Valine-LeanCloud-Config.html\">相关文章</a><br>Artalk整体UI上与Vlaine大致相同，相信很对人看到Artalk需要服务器就劝退了很多人</p>\n<p>但是需要服务器或者虚拟主机(只需要有PHP环境的就可以)，这一点就劝退了很多兄伙伴<br>网上有很多白嫖的虚拟主机，但谁知道他们会不会跑路呢？(数据信息得不到保障)<br>当然也有白嫖服务的教程，但是有很对限制</p>\n<p>那咱们这些白嫖怪该怎么办呢？如何获得免费且又安全的虚拟主机呢？<br>不要怕，继续往下看就对了</p>\n<h2 id=\"Valine\"><a href=\"#Valine\" class=\"headerlink\" title=\"Valine\"></a>Valine</h2><ol>\n<li><p>优点</p>\n<blockquote>\n<ul>\n<li>白嫖怪的福利</li>\n<li>服务器抗揍</li>\n<li>自定义表情包</li>\n</ul>\n</blockquote>\n</li>\n<li><p>缺点</p>\n<blockquote>\n<ul>\n<li>安全性(常被恶意刷评论和广告骚扰等)</li>\n<li>LeanCloud开发版应用服务器每天必须睡眠8h，服务器运行超过16h后会强行关闭服务器睡眠</li>\n<li>appId和appKey外露</li>\n</ul>\n</blockquote>\n</li>\n</ol>\n<h2 id=\"Artalk\"><a href=\"#Artalk\" class=\"headerlink\" title=\"Artalk\"></a>Artalk</h2><ol>\n<li><p>优点</p>\n<blockquote>\n<ul>\n<li>轻量</li>\n<li>支持 SMTP / 阿里云DM(Http API)</li>\n<li>管理员防冒</li>\n<li>提交频繁验证码</li>\n<li><del>MySql</del>（无需 SQL 数据库，JSON 文件存储数据）</li>\n</ul>\n</blockquote>\n</li>\n<li><p>缺点</p>\n<blockquote>\n<ul>\n<li>需要虚拟主机或服务器(PHP7.1.X)</li>\n<li>不知道自己服务器或主机抗揍不抗揍(但比Valine安全)</li>\n</ul>\n</blockquote>\n</li>\n</ol>\n<h2 id=\"正文\"><a href=\"#正文\" class=\"headerlink\" title=\"正文\"></a>正文</h2><p>废话说了挺多，现在就开始吧！<br>图片我就不截图了，将就看吧(字挺多，我自己看我自己都烦)</p>\n<ol>\n<li><p>我们下白嫖一台虚拟主机<br>官网：<a href=\"https://www.gearhost.com/\">https://www.gearhost.com/</a><br>注册我就不多说了</p>\n</li>\n<li><p>注册成功后登陆<br>登陆地址：<a href=\"https://my.gearhost.com/account/signup\">https://my.gearhost.com/account/signup</a></p>\n</li>\n<li><p>登陆后点击右上角的<code>Add CloudSite</code>(创建应用程序)<br>输入一个应用程序昵称，然后选择第一个<code>Free</code>(免费) 滑倒最底部<code>Create CloudSite</code>(创建)<br>坐等构建成功，点击应用程序昵称进入</p>\n</li>\n<li><p>进去后点击<code>Publish</code>往下滑动，有几个选项(提交程序代码的方式)，我选择的是git<br><code>Git URL</code>:git的仓库地址<br><code>Username</code>:用户名<br><code>Password</code>:密码<br>到<a href=\"https://github.com/qwqcode/Artalk-API-PHP\">Artalk仓库</a>克隆</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git <span class=\"built_in\">clone</span> https://github.com/qwqcode/ArtalkServerPhp.git</span><br><span class=\"line\">composer install</span><br><span class=\"line\">php -r <span class=\"string\">&quot;copy(&#x27;Config.example.php&#x27;, &#x27;Config.php&#x27;);&quot;</span></span><br></pre></td></tr></table></figure>\n<p>以上步骤需要有<a href=\"https://www.php.net/\">php</a>环境和<a href=\"https://getcomposer.org/download/\">composer</a><br>如果你不想安装这些乱七八糟的东西，这里有个已经打包好了的<del><a href=\"https://656e-env-13021289878.tcb.qcloud.la/Artalk.zip\">Artalk</a></del>(已经不推荐使用了，你可以使用<a href=\"https://discuss.js.org\">Discuss</a>)<br>包里的Config.php有个<code>跨域限制</code>就是你同意哪些域名可以调用你的Atralk评论(填直接域名网站就好了)<br>根据系统下面提示进行提交代码就可以了<br><img src=\"/img/Hexo-Artalk/Git-gearhost.png\" alt=\"\"></p>\n</li>\n<li><p>点击<code>Publish</code>旁边的<code>Config</code>下面的<code>PHP Version</code>改为7.1<br>滑倒最下面修改<code>Virtual Directories</code>内容<br><code>site\\wwwroot\\public</code>然后点击<code>Save Configuration</code>保存配置即可(由于Artalk的入口在public文件夹下所以，修改默认运行路径)<br><img src=\"/img/Hexo-Artalk/Config-gearhost.png\" alt=\"\"></p>\n</li>\n<li><p>想自定义域名的话就选择<code>Domains</code>这里我就不演示了</p>\n</li>\n<li><p>主题修改<br>由于每个主题都不一样，我这里以Yilia主题为例(Yilia主题被我改过<code>Yilia-Pro</code>，所以如果你的主题也是Yilia主题的话可能和我的不一样)<br>新建<code>themes/Yilia-Pro/layout/_partial/comment/Artalk.ejs</code>粘贴如下(没有就自己建，由于表情包过多我就省略了)<br>相关配置可以看<a href=\"https://github.com/qwqcode/Artalk/blob/master/types/artalk-config.d.ts\">https://github.com/qwqcode/Artalk/blob/master/types/artalk-config.d.ts</a></p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">href</span>=<span class=\"string\">&quot;https://cdn.jsdelivr.net/gh/monsterxcn/Artalk@master/dist/Artalk.css&quot;</span> <span class=\"attr\">rel</span>=<span class=\"string\">&quot;stylesheet&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;ArtalkComments&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;https://cdn.jsdelivr.net/gh/monsterxcn/Artalk@master/dist/Artalk.js&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">  <span class=\"keyword\">new</span> <span class=\"title class_\">Artalk</span>(&#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">      <span class=\"attr\">el</span>: <span class=\"string\">&quot;#ArtalkComments&quot;</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">      <span class=\"attr\">placeholder</span>: <span class=\"string\">&quot;开车不规范，亲人两行泪&quot;</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">      <span class=\"attr\">noComment</span>: <span class=\"string\">&quot;快来搬沙发！&quot;</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">      <span class=\"attr\">defaultAvatar</span>: <span class=\"string\">&quot;mp&quot;</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">      <span class=\"attr\">pageKey</span>: location.<span class=\"property\">pathname</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">      <span class=\"attr\">serverUrl</span>: <span class=\"string\">&quot;http://lete114.gearhostpreview.com/&quot;</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">      <span class=\"attr\">readMore</span>: &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">          <span class=\"attr\">pageSize</span>: <span class=\"number\">10</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">          <span class=\"attr\">autoLoad</span>: !<span class=\"number\">1</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">      &#125;,</span></span><br><span class=\"line\"><span class=\"language-javascript\">      <span class=\"attr\">gravatar</span>: &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">          <span class=\"attr\">cdn</span>: <span class=\"string\">&quot;https://dn-qiniu-avatar.qbox.me/avatar/&quot;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">      &#125;,</span></span><br><span class=\"line\"><span class=\"language-javascript\">      <span class=\"attr\">emoticons</span>: &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">          <span class=\"string\">&quot;滑稽&quot;</span>: &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"string\">&quot;inputType&quot;</span>: <span class=\"string\">&quot;image&quot;</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"string\">&quot;container&quot;</span>: &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"string\">&quot;原味稽&quot;</span>: <span class=\"string\">&quot;https://i.loli.net/2019/02/01/5c53d26b7ae13.png&quot;</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"string\">&quot;还是算了&quot;</span>: <span class=\"string\">&quot;https://i.loli.net/2020/04/30/riySFlu75fJdG4p.png&quot;</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"string\">&quot;将稽就稽&quot;</span>: <span class=\"string\">&quot;https://i.loli.net/2020/04/30/KVwf8qCrZts6WOT.gif&quot;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">            &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\">        &#125;,</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"string\">&quot;阿鲁&quot;</span>: &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"string\">&quot;inputType&quot;</span>: <span class=\"string\">&quot;image&quot;</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"string\">&quot;container&quot;</span>: &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"string\">&quot;高兴&quot;</span>:<span class=\"string\">&quot;https://cdn.jsdelivr.net/gh/monsterxcn/MyBucket/owoEmoji/aru/E9AB98E585B4_2x.png&quot;</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"string\">&quot;小怒&quot;</span>:<span class=\"string\">&quot;https://cdn.jsdelivr.net/gh/monsterxcn/MyBucket/owoEmoji/aru/E5B08FE68092_2x.png&quot;</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">                <span class=\"string\">&quot;脸红&quot;</span>:<span class=\"string\">&quot;https://cdn.jsdelivr.net/gh/monsterxcn/MyBucket/owoEmoji/aru/E884B8E7BAA2_2x.png&quot;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">            &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\">        &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\">      &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\">  &#125;)</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span>        </span><br></pre></td></tr></table></figure>\n<p>修改<code>themes/Yilia-Pro/layout/_partial/article.ejs</code><br>找到<code>&lt;section id=&quot;comments&quot; class=&quot;comments&quot;&gt;</code>引入<code>&lt;%- partial(&#39;comments/Artalk&#39;) %&gt;</code></p>\n</li>\n</ol>\n<h2 id=\"我的3个文件配置内容\"><a href=\"#我的3个文件配置内容\" class=\"headerlink\" title=\"我的3个文件配置内容\"></a>我的3个文件配置内容</h2><ol>\n<li><p>_config.yml</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">## Artalk</span></span><br><span class=\"line\"><span class=\"comment\">## https://artalk.js.org</span></span><br><span class=\"line\"><span class=\"attr\">Artalk:</span></span><br><span class=\"line\"> <span class=\"attr\">enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"> <span class=\"attr\">placeholder:</span> <span class=\"string\">开车不规范，亲人两行泪</span> <span class=\"comment\"># 评论框占位字符</span></span><br><span class=\"line\"> <span class=\"attr\">noComment:</span> <span class=\"string\">快来沙发！</span> <span class=\"comment\"># 评论为空时显示字符</span></span><br><span class=\"line\"> <span class=\"attr\">sendBtn:</span> <span class=\"string\">发送</span> <span class=\"comment\"># 发送按钮文字</span></span><br><span class=\"line\"> <span class=\"attr\">defaultAvatar:</span> <span class=\"string\">mp</span> <span class=\"comment\">#https://cdn.lete114.top/img/avatar.png</span></span><br><span class=\"line\"> <span class=\"attr\">pageKey:</span> <span class=\"string\">location.pathname</span> <span class=\"comment\"># 页面唯一标识</span></span><br><span class=\"line\"> <span class=\"attr\">serverUrl:</span> <span class=\"string\">https://artalk.lete114.top</span> <span class=\"comment\"># 服务器地址</span></span><br><span class=\"line\"> <span class=\"attr\">cdn:</span> <span class=\"string\">https://dn-qiniu-avatar.qbox.me/avatar/</span> <span class=\"comment\">#https://cdn.lete114.top/img/avatar.png # 头像CDN地址</span></span><br><span class=\"line\"> <span class=\"attr\">pageSize:</span> <span class=\"number\">5</span> <span class=\"comment\"># 每次请求获取评论数量数量</span></span><br><span class=\"line\"> <span class=\"attr\">autoLoad:</span> <span class=\"literal\">true</span> <span class=\"comment\"># 滚动到底部自动加载</span></span><br><span class=\"line\"> <span class=\"attr\">emoticons:</span> <span class=\"string\">&#x27;&#123;&quot;滑稽&quot;:&#123;&quot;inputType&quot;:&quot;image&quot;,&quot;container&quot;:&#123;&quot;原味稽&quot;:&quot;https://i.loli.net/2019/02/01/5c53d26b7ae13.png&quot;,&quot;还是算了&quot;:&quot;https://i.loli.net/2020/04/30/riySFlu75fJdG4p.png&quot;,&quot;蓝纹稽&quot;:&quot;https://i.loli.net/2020/04/30/jyh5IVzpqXsHuvU.jpg&quot;,&quot;随稽应变&quot;:&quot;https://i.loli.net/2017/02/05/5896e6ec1d528.jpg&quot;,&quot;蠕动&quot;:&quot;https://i.loli.net/2017/02/05/5896e9712a3c1.gif&quot;,&quot;束手无稽&quot;:&quot;https://i.loli.net/2020/04/30/dF8sTOpgomj7qf5.jpg&quot;,&quot;微笑默叹以为妙绝&quot;:&quot;https://i.loli.net/2019/02/01/5c53daa84f24a.png&quot;,&quot;喝嘤料&quot;:&quot;https://i.loli.net/2019/02/01/5c53d63d8c6af.jpg&quot;,&quot;暗中观察&quot;:&quot;https://i.loli.net/2019/02/01/5c53dd21a2e7b.jpg&quot;,&quot;高兴&quot;:&quot;https://i.loli.net/2019/02/01/5c53d1b9e5f38.jpg&quot;,&quot;惊稽&quot;:&quot;https://i.loli.net/2019/02/01/5c53d1e2ad89f.jpg&quot;,&quot;可这和我的帅有什么关系&quot;:&quot;https://i.loli.net/2017/02/05/5896ece29a8e0.jpg&quot;,&quot;狱稽&quot;:&quot;https://i.loli.net/2020/04/30/cUEQrVYGFiDjqhy.jpg&quot;,&quot;梆&quot;:&quot;https://i.loli.net/2020/04/30/TlAGjm6IvJSMVpq.jpg&quot;,&quot;吃鱼摆摆&quot;:&quot;https://i.loli.net/2017/02/05/5896ec2cb7f39.gif&quot;,&quot;跃跃欲试 3&quot;:&quot;https://i.loli.net/2017/02/05/5896ece2ac5a2.gif&quot;,&quot;突然滑稽&quot;:&quot;https://i.loli.net/2019/02/01/5c53cf2a457f1.jpg&quot;,&quot;扶墙怂&quot;:&quot;https://i.loli.net/2017/02/05/5896ece2ab57a.jpg&quot;,&quot;阔以&quot;:&quot;https://i.loli.net/2020/04/30/7EYyq1TcBKa3eQ2.jpg&quot;,&quot;不得行&quot;:&quot;https://i.loli.net/2020/04/30/KoqBGauX7TEfeyn.jpg&quot;,&quot;少儿不宜&quot;:&quot;https://i.loli.net/2020/04/30/nt2ZWRozUNjBxAK.jpg&quot;,&quot;稽日可期&quot;:&quot;https://i.loli.net/2020/04/30/FmfYcoMJesi2Ddq.jpg&quot;,&quot;哎&quot;:&quot;https://i.loli.net/2020/04/30/ps7PTIANgSErqnU.jpg&quot;,&quot;别看丢人&quot;:&quot;https://i.loli.net/2019/02/01/5c53d4f89ea29.jpg&quot;,&quot;地稽 2&quot;:&quot;https://i.loli.net/2019/02/01/5c53dbae85687.jpg&quot;,&quot;地稽&quot;:&quot;https://i.loli.net/2020/04/30/BnTMX35EPxleVmA.jpg&quot;,&quot;老阔有点扣&quot;:&quot;https://i.loli.net/2020/04/30/fhDXbA9T1zJPlKk.gif&quot;,&quot;啊哈哈&quot;:&quot;https://i.loli.net/2019/02/01/5c53dc2947d84.jpg&quot;,&quot;无稽可奈&quot;:&quot;https://i.loli.net/2020/04/30/UyxTzB2fS3LtH7Q.jpg&quot;,&quot;老实巴交&quot;:&quot;https://i.loli.net/2020/04/30/7DgSoyqwtYBxchE.jpg&quot;,&quot;紧张&quot;:&quot;https://i.loli.net/2017/02/05/5896e8a408253.jpg&quot;,&quot;摇摆稽&quot;:&quot;https://i.loli.net/2019/02/01/5c53d1904dcb2.gif&quot;,&quot;又不是不能用&quot;:&quot;https://i.loli.net/2019/02/01/5c53ce897ab55.jpg&quot;,&quot;一时滑稽&quot;:&quot;https://i.loli.net/2019/02/01/5c53d5d28e22c.jpg&quot;,&quot;无法接受&quot;:&quot;https://i.loli.net/2019/02/01/5c53cee8422fc.jpg&quot;,&quot;嘤雄豪稽&quot;:&quot;https://i.loli.net/2020/04/30/sbtw6o7iKaM4Nmq.jpg&quot;,&quot;相视双稽&quot;:&quot;https://i.loli.net/2019/02/01/5c53d5a093149.jpg&quot;,&quot;稽皮发麻&quot;:&quot;https://i.loli.net/2017/02/05/5896ece2a019f.jpg&quot;,&quot;地稽 3&quot;:&quot;https://i.loli.net/2019/02/01/5c53dbe510bcf.jpg&quot;,&quot;地稽委屈&quot;:&quot;https://i.loli.net/2019/02/01/5c53d76e250da.jpg&quot;,&quot;地稽抚摸&quot;:&quot;https://i.loli.net/2020/04/30/cavZ6nNzMPimLy7.gif&quot;,&quot;地稽捶打&quot;:&quot;https://i.loli.net/2020/04/30/vFVPynXaHR5sitk.gif&quot;,&quot;绝望&quot;:&quot;https://i.loli.net/2019/02/01/5c53dc0ba2303.jpg&quot;,&quot;气稽败坏&quot;:&quot;https://i.loli.net/2019/02/01/5c53d216f3c60.jpg&quot;,&quot;当场去世&quot;:&quot;https://i.loli.net/2020/04/30/sogxHMTFWbE2lrP.jpg&quot;,&quot;喝酒&quot;:&quot;https://i.loli.net/2019/02/01/5c53d78c3f4a5.jpg&quot;,&quot;老衲摆摊算命&quot;:&quot;https://i.loli.net/2017/02/05/5896ece29d8a5.gif&quot;,&quot;老哥，稳&quot;:&quot;https://i.loli.net/2017/02/05/5896ece29ebb0.jpg&quot;,&quot;自闭稽&quot;:&quot;https://i.loli.net/2019/02/01/5c53d6603ee24.jpg&quot;,&quot;无话可说&quot;:&quot;https://i.loli.net/2019/02/01/5c53d6a77b7e4.jpg&quot;,&quot;跃跃欲试&quot;:&quot;https://i.loli.net/2017/02/05/5896e9710dfd5.jpg&quot;,&quot;跃跃欲试 2&quot;:&quot;https://i.loli.net/2019/02/01/5c53dcc057350.jpg&quot;,&quot;满脑子骚操作&quot;:&quot;https://i.loli.net/2020/04/30/xJXcUtO2BryHAsa.gif&quot;,&quot;稽之舞&quot;:&quot;https://i.loli.net/2019/02/01/5c53de1a4d14d.gif&quot;,&quot;将稽就稽&quot;:&quot;https://i.loli.net/2020/04/30/KVwf8qCrZts6WOT.gif&quot;&#125;&#125;&#125;&#x27;</span></span><br><span class=\"line\"> <span class=\"comment\"># 表情包 如上示例使用json 空的话使用默认表情包</span></span><br><span class=\"line\"> <span class=\"comment\"># 压缩和验证json：https://www.bejson.com/</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>Artalk.ejs</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">href</span>=<span class=\"string\">&quot;https://cdn.jsdelivr.net/gh/monsterxcn/Artalk@master/dist/Artalk.css&quot;</span> <span class=\"attr\">rel</span>=<span class=\"string\">&quot;stylesheet&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;ArtalkComments&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;https://cdn.jsdelivr.net/gh/monsterxcn/Artalk@master/dist/Artalk.js&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"keyword\">new</span> <span class=\"title class_\">Artalk</span>(&#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"attr\">el</span>: <span class=\"string\">&quot;#ArtalkComments&quot;</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"attr\">placeholder</span>: <span class=\"string\">&quot;&lt;%= theme.Artalk.placeholder %&gt;&quot;</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"attr\">noComment</span>: <span class=\"string\">&quot;&lt;%= theme.Artalk.noComment %&gt;&quot;</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"attr\">sendBtn</span>: <span class=\"string\">&quot;&lt;%= theme.Artalk.sendBtn %&gt;&quot;</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"attr\">defaultAvatar</span>: <span class=\"string\">&quot;&lt;%= theme.Artalk.defaultAvatar %&gt;&quot;</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"attr\">pageKey</span>: &lt;%= theme.<span class=\"property\">Artalk</span>.<span class=\"property\">pageKey</span> %&gt;,</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"attr\">serverUrl</span>: <span class=\"string\">&quot;&lt;%= theme.Artalk.serverUrl %&gt;&quot;</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"attr\">readMore</span>: &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"attr\">pageSize</span>: &lt;%= theme.<span class=\"property\">Artalk</span>.<span class=\"property\">pageSize</span> %&gt;,</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"attr\">autoLoad</span>: &lt;%= theme.<span class=\"property\">Artalk</span>.<span class=\"property\">autoLoad</span> %&gt;</span></span><br><span class=\"line\"><span class=\"language-javascript\">        &#125;,</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"attr\">gravatar</span>: &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">            <span class=\"attr\">cdn</span>: <span class=\"string\">&quot;&lt;%= theme.Artalk.cdn %&gt;&quot;</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">        &#125;,&lt;%<span class=\"keyword\">if</span>(theme.<span class=\"property\">Artalk</span>.<span class=\"property\">emoticons</span> !=<span class=\"literal\">undefined</span>)&#123;%&gt;</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"attr\">moticons</span>:</span></span><br><span class=\"line\"><span class=\"language-javascript\">            &lt;%- theme.<span class=\"property\">Artalk</span>.<span class=\"property\">emoticons</span> %&gt;&lt;%&#125;%&gt;</span></span><br><span class=\"line\"><span class=\"language-javascript\">    &#125;)</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>article.ejs</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">article</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;&lt;%= post.layout %&gt;-&lt;%= post.slug %&gt;&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;article article-type-&lt;%= post.layout %&gt; &lt;%if(index)&#123;%&gt; article-index&lt;%&#125;%&gt;&quot;</span> <span class=\"attr\">itemscope</span> <span class=\"attr\">itemprop</span>=<span class=\"string\">&quot;blogPost&quot;</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;article-inner&quot;</span>&gt;</span></span><br><span class=\"line\">    &lt;% if (post.link || post.title)&#123; %&gt;</span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">header</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;article-header&quot;</span>&gt;</span></span><br><span class=\"line\">        &lt;%- partial(&#x27;post/title&#x27;, &#123;class_name: &#x27;article-title&#x27;&#125;) %&gt;</span><br><span class=\"line\">        &lt;% if (!post.noDate)&#123; %&gt;</span><br><span class=\"line\">        &lt;%- partial(&#x27;post/date&#x27;, &#123;class_name: &#x27;archive-article-date&#x27;, date_format: null&#125;) %&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- 开始添加字数统计--&gt;</span></span><br><span class=\"line\">        &lt;% if(theme.word_count.enable &amp;&amp; !post.no_word_count)&#123;%&gt;</span><br><span class=\"line\">        &lt;%- partial(&#x27;post/word&#x27;) %&gt;</span><br><span class=\"line\">        &lt;% &#125; %&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">        &lt;% &#125; %&gt;</span><br><span class=\"line\">      <span class=\"tag\">&lt;/<span class=\"name\">header</span>&gt;</span></span><br><span class=\"line\">    &lt;% &#125; %&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;article-entry&quot;</span> <span class=\"attr\">itemprop</span>=<span class=\"string\">&quot;articleBody&quot;</span>&gt;</span></span><br><span class=\"line\">        &lt;% if (post.excerpt &amp;&amp; index)&#123; %&gt;</span><br><span class=\"line\">          &lt;%- post.excerpt %&gt;</span><br><span class=\"line\">            <span class=\"comment\">&lt;!--cover--&gt;</span></span><br><span class=\"line\">            &lt;% if (post.cover)&#123; %&gt;</span><br><span class=\"line\">              <span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;&lt;%-post.cover%&gt;&quot;</span> <span class=\"attr\">style</span>=<span class=\"string\">&quot;pointer-events: none;width: 100%&quot;</span> <span class=\"attr\">alt</span>=<span class=\"string\">&quot;封面&quot;</span>&gt;</span></span><br><span class=\"line\">            &lt;%&#125;%&gt;</span><br><span class=\"line\">        &lt;% &#125; else &#123; %&gt;</span><br><span class=\"line\">          &lt;%- post.content %&gt;</span><br><span class=\"line\">        &lt;% &#125; %&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">      &lt;%- partial(&#x27;copyright&#x27;)%&gt;</span><br><span class=\"line\">      <span class=\"comment\">&lt;!--打赏--&gt;</span></span><br><span class=\"line\">      &lt;%- partial(&#x27;reward&#x27;)%&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;article-info article-info-index&quot;</span>&gt;</span></span><br><span class=\"line\">      &lt;%if(post.top)&#123;%&gt;</span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;article-pop-out tagcloud&quot;</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">i</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;fas fa-thumbtack&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">i</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;article-tag-list-link color3&quot;</span>&gt;</span>置顶<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">      &lt;% &#125; %&gt;</span><br><span class=\"line\">      &lt;%- partial(&#x27;post/tag&#x27;) %&gt;</span><br><span class=\"line\">      &lt;%- partial(&#x27;post/category&#x27;) %&gt;</span><br><span class=\"line\">      &lt;% if (index &amp;&amp; theme.show_all_link)&#123; %&gt;</span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">p</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;article-more-link&quot;</span>&gt;</span></span><br><span class=\"line\">          <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;article-more-a&quot;</span> <span class=\"attr\">href</span>=<span class=\"string\">&quot;&lt;%- url_for(post.path) %&gt;&quot;</span>&gt;</span>&lt;%= theme.show_all_link %&gt; &gt;&gt;<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">p</span>&gt;</span></span><br><span class=\"line\">      &lt;% &#125; %&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">      &lt;% if (!index &amp;&amp; theme.share_jia)&#123; %&gt;</span><br><span class=\"line\">        &lt;%- partial(&#x27;post/share&#x27;) %&gt;</span><br><span class=\"line\">      &lt;% &#125; %&gt;</span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;clearfix&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">article</span>&gt;</span></span><br><span class=\"line\">&lt;% if (!index)&#123; %&gt;</span><br><span class=\"line\">  &lt;%- partial(&#x27;post/nav&#x27;) %&gt;</span><br><span class=\"line\">&lt;% &#125; %&gt;</span><br><span class=\"line\">&lt;%- partial(&#x27;_partial/aside&#x27;) %&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;% if (theme.comments &amp;&amp; !index)&#123; %&gt;</span><br><span class=\"line\">  &lt;% if (post.comments==null || post.comments)&#123; %&gt;</span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">section</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;comments&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;comments&quot;</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">style</span>&gt;</span><span class=\"language-css\"></span></span><br><span class=\"line\"><span class=\"language-css\">        <span class=\"selector-class\">.comments</span>&#123;<span class=\"attribute\">margin</span>:<span class=\"number\">30px</span>;<span class=\"attribute\">padding</span>:<span class=\"number\">10px</span>;&#125;</span></span><br><span class=\"line\"><span class=\"language-css\">        <span class=\"keyword\">@media</span> screen <span class=\"keyword\">and</span> (<span class=\"attribute\">max-width</span>:<span class=\"number\">800px</span>)&#123;<span class=\"selector-class\">.comments</span>&#123;<span class=\"attribute\">margin</span>:auto;<span class=\"attribute\">padding</span>:<span class=\"number\">10px</span>;&#125;&#125;</span></span><br><span class=\"line\"><span class=\"language-css\">      </span><span class=\"tag\">&lt;/<span class=\"name\">style</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">style</span>=<span class=\"string\">&quot;margin: 10px;&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;comment-headline&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">i</span> <span class=\"attr\">style</span>=<span class=\"string\">&quot;font-size: 1.5em;&quot;</span> <span class=\"attr\">class</span>=<span class=\"string\">&quot;fas fa-comments fa-fw&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">i</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">style</span>=<span class=\"string\">&quot;position: relative;left: 10px;font-size: 22px;&quot;</span>&gt;</span> 评论<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">      &lt;% if (theme.Valine.enable &amp;&amp; theme.Valine.appId &amp;&amp; theme.Valine.appKey)&#123; %&gt;</span><br><span class=\"line\">        &lt;%- partial(&#x27;comments/Valine&#x27;) %&gt;</span><br><span class=\"line\">      &lt;% &#125;else if (theme.Artalk.enable &amp;&amp; theme.Artalk.serverUrl &amp;&amp; theme.Artalk.pageKey)&#123; %&gt;</span><br><span class=\"line\">        &lt;%- partial(&#x27;comments/Artalk&#x27;) %&gt;</span><br><span class=\"line\">      &lt;% &#125; %&gt;</span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">section</span>&gt;</span></span><br><span class=\"line\">  &lt;% &#125; %&gt;</span><br><span class=\"line\">&lt;% &#125; %&gt;</span><br></pre></td></tr></table></figure>\n\n</li>\n</ol>\n<h2 id=\"Yilia-Pro\"><a href=\"#Yilia-Pro\" class=\"headerlink\" title=\"Yilia-Pro\"></a>Yilia-Pro</h2><p>Github：<a href=\"https://github.com/lete114/hexo-theme-yilia-pro\">https://github.com/lete114/hexo-theme-yilia-pro</a></p>\n",
            "tags": [
                "教程",
                "Hexo",
                "Config"
            ]
        },
        {
            "id": "https://blog.imlete.cn/article/Hexo-add-CodeBlock.html",
            "url": "https://blog.imlete.cn/article/Hexo-add-CodeBlock.html",
            "title": "Hexo-添加代码块边框",
            "date_published": "2020-09-21T11:03:40.000Z",
            "content_html": "<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>如何给<code>Hexo</code>代码块添加代码块边框？<br>看到其他主题的代码块边框很好看，而且还显示代码语言功能，而自己使用的主题没有代码块边框<br>很想用这种功能，很无奈，这样扒别人网站上的样式样式是很繁琐，且枯燥的，就算扒完样式后<br>该如何在<code>Hexo</code>生成页面的时候给代码块插入样式呢？<br><img src=\"/img/Hexo-add-CodeBlock/2.png\" alt=\"emoje\"></p>\n<p>那么废话不多说，看下面正文</p>\n<h2 id=\"正文\"><a href=\"#正文\" class=\"headerlink\" title=\"正文\"></a>正文</h2><ol>\n<li><p>在<code>D:\\Lete\\Blog\\themes\\Yilia-Pro\\scripts\\</code>下新建<code>codeblock.js</code>(名字自定义)</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo.<span class=\"property\">extend</span>.<span class=\"property\">filter</span>.<span class=\"title function_\">register</span>(<span class=\"string\">&#x27;after_post_render&#x27;</span>, <span class=\"keyword\">function</span> (<span class=\"params\">data</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (<span class=\"regexp\">/&lt;figure class=&quot;highlight ([a-zA-Z\\+\\-\\/\\#]+)&quot;&gt;.*?&lt;\\/figure&gt;/</span>.<span class=\"title function_\">test</span>(data.<span class=\"property\">content</span>)) &#123;</span><br><span class=\"line\">        data.<span class=\"property\">content</span> = data.<span class=\"property\">content</span>.<span class=\"title function_\">replace</span>(<span class=\"regexp\">/&lt;figure class=&quot;highlight ([a-zA-Z\\+\\-\\/\\#]+)&quot;&gt;.*?&lt;\\/figure&gt;/</span>, <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> language = <span class=\"title class_\">RegExp</span>.<span class=\"property\">$1</span> || <span class=\"string\">&#x27;code&#x27;</span></span><br><span class=\"line\">            <span class=\"keyword\">var</span> lastMatch = <span class=\"title class_\">RegExp</span>.<span class=\"property\">lastMatch</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (language==<span class=\"string\">&#x27;plain&#x27;</span>)&#123;</span><br><span class=\"line\">                language=<span class=\"string\">&#x27;code&#x27;</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            lastMatch = lastMatch.<span class=\"title function_\">replace</span>(<span class=\"regexp\">/&lt;figure class=&quot;highlight /</span>, <span class=\"string\">&#x27;&lt;figure class=&quot;iseeu highlight &#x27;</span>)</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"string\">&#x27;&lt;div class=&quot;highlight-wrap&quot; data-rel=&quot;&#x27;</span></span><br><span class=\"line\">                + language.<span class=\"title function_\">replace</span>(language[<span class=\"number\">0</span>],language[<span class=\"number\">0</span>].<span class=\"title function_\">toUpperCase</span>()) + <span class=\"string\">&#x27;&quot;&gt;&#x27;</span> + lastMatch + <span class=\"string\">&#x27;&lt;/div&gt;&#x27;</span></span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> data</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>在<code>D:\\Lete\\Blog\\themes\\Yilia-Pro\\source\\css\\</code>下新建<code>_highlight</code>(这个文件夹可选)<br>然后新建<code>codeFrame.styl</code></p>\n<figure class=\"highlight styl\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">@require <span class=\"string\">&#x27;theme&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*Mac代码框样式*/</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"selector-class\">.highlight-wrap</span><span class=\"selector-attr\">[data-rel]</span><span class=\"selector-pseudo\">:hover</span></span><br><span class=\"line\">    <span class=\"attribute\">transition</span> box-shadow <span class=\"number\">0.3s</span> ease-in-out</span><br><span class=\"line\">    <span class=\"attribute\">box-shadow</span> <span class=\"number\">0</span> <span class=\"number\">0px</span> <span class=\"number\">30px</span> <span class=\"number\">0px</span> rgba(<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0.4</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"selector-class\">.highlight-wrap</span><span class=\"selector-attr\">[data-rel]</span></span><br><span class=\"line\">    <span class=\"attribute\">position</span> relative</span><br><span class=\"line\">    <span class=\"attribute\">overflow</span> hidden</span><br><span class=\"line\">    <span class=\"attribute\">border-radius</span> <span class=\"number\">10px</span></span><br><span class=\"line\">    <span class=\"attribute\">box-shadow</span> <span class=\"number\">0</span> <span class=\"number\">0px</span> <span class=\"number\">10px</span> <span class=\"number\">0px</span> rgba(<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0.4</span>)</span><br><span class=\"line\">    <span class=\"selector-pseudo\">&amp;::before</span></span><br><span class=\"line\">      <span class=\"attribute\">content</span> attr(data-rel)</span><br><span class=\"line\">      <span class=\"attribute\">height</span> <span class=\"number\">38px</span></span><br><span class=\"line\">      <span class=\"attribute\">line-height</span> <span class=\"number\">38px</span></span><br><span class=\"line\">      <span class=\"attribute\">background</span> <span class=\"variable\">$highlight</span>-wrap</span><br><span class=\"line\">      <span class=\"attribute\">color</span> <span class=\"variable\">$highlight</span>-foreground</span><br><span class=\"line\">      <span class=\"attribute\">font-size</span> <span class=\"number\">16px</span></span><br><span class=\"line\">      <span class=\"attribute\">position</span> absolute</span><br><span class=\"line\">      <span class=\"attribute\">top</span> <span class=\"number\">0</span></span><br><span class=\"line\">      <span class=\"attribute\">left</span> <span class=\"number\">0</span></span><br><span class=\"line\">      <span class=\"attribute\">width</span> <span class=\"number\">100%</span></span><br><span class=\"line\">      <span class=\"attribute\">font-weight</span> bold</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"keyword\">if</span> <span class=\"built_in\">hexo-config</span>(<span class=\"string\">&#x27;highlight_theme&#x27;</span>) == mac || <span class=\"built_in\">hexo-config</span>(<span class=\"string\">&#x27;highlight_theme&#x27;</span>) == <span class=\"string\">&#x27;mac light&#x27;</span></span><br><span class=\"line\">        <span class=\"attribute\">padding</span> <span class=\"number\">0px</span> <span class=\"number\">80px</span></span><br><span class=\"line\">      <span class=\"attribute\">text-indent</span> <span class=\"number\">15px</span></span><br><span class=\"line\">      <span class=\"attribute\">float</span> left</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> <span class=\"built_in\">hexo-config</span>(<span class=\"string\">&#x27;highlight_theme&#x27;</span>) == mac || <span class=\"built_in\">hexo-config</span>(<span class=\"string\">&#x27;highlight_theme&#x27;</span>) == <span class=\"string\">&#x27;mac light&#x27;</span></span><br><span class=\"line\">      <span class=\"selector-pseudo\">&amp;::after</span></span><br><span class=\"line\">         <span class=\"attribute\">content</span> <span class=\"string\">&#x27; &#x27;</span></span><br><span class=\"line\">         <span class=\"attribute\">position</span> absolute</span><br><span class=\"line\">         -webkit-<span class=\"attribute\">border-radius</span> <span class=\"number\">50%</span></span><br><span class=\"line\">         <span class=\"attribute\">border-radius</span> <span class=\"number\">50%</span></span><br><span class=\"line\">         <span class=\"attribute\">background</span> <span class=\"number\">#fc625d</span></span><br><span class=\"line\">         <span class=\"attribute\">width</span> <span class=\"number\">12px</span></span><br><span class=\"line\">         <span class=\"attribute\">height</span> <span class=\"number\">12px</span></span><br><span class=\"line\">         <span class=\"attribute\">top</span> <span class=\"number\">0</span></span><br><span class=\"line\">         <span class=\"attribute\">left</span> <span class=\"number\">20px</span></span><br><span class=\"line\">         <span class=\"attribute\">margin-top</span> <span class=\"number\">13px</span></span><br><span class=\"line\">         -webkit-<span class=\"attribute\">box-shadow</span> <span class=\"number\">20px</span> <span class=\"number\">0px</span> <span class=\"number\">#fdbc40</span>, <span class=\"number\">40px</span> <span class=\"number\">0px</span> <span class=\"number\">#35cd4b</span></span><br><span class=\"line\">         <span class=\"attribute\">box-shadow</span> <span class=\"number\">20px</span> <span class=\"number\">0px</span> <span class=\"number\">#fdbc40</span>, <span class=\"number\">40px</span> <span class=\"number\">0px</span> <span class=\"number\">#35cd4b</span></span><br><span class=\"line\">         <span class=\"attribute\">z-index</span> <span class=\"number\">3</span></span><br></pre></td></tr></table></figure>\n<p>新建<code>diff.styl</code></p>\n<figure class=\"highlight styl\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// For diff highlight</span></span><br><span class=\"line\"><span class=\"selector-tag\">figure</span><span class=\"selector-class\">.highlight</span></span><br><span class=\"line\">  <span class=\"selector-tag\">table</span></span><br><span class=\"line\">    &amp;::-webkit-scrollbar-thumb</span><br><span class=\"line\">      <span class=\"attribute\">background</span>: <span class=\"variable\">$highlight</span>-scrollbar</span><br><span class=\"line\"></span><br><span class=\"line\">  pre <span class=\"selector-class\">.deletion</span></span><br><span class=\"line\">    <span class=\"attribute\">color</span>: <span class=\"variable\">$highlight</span>-deletion</span><br><span class=\"line\"></span><br><span class=\"line\">  pre <span class=\"selector-class\">.addition</span></span><br><span class=\"line\">    <span class=\"attribute\">color</span>: <span class=\"variable\">$highlight</span>-addition</span><br><span class=\"line\"></span><br><span class=\"line\">  pre <span class=\"selector-class\">.meta</span></span><br><span class=\"line\">    <span class=\"attribute\">color</span>: <span class=\"variable\">$highlight</span>-purple</span><br><span class=\"line\"></span><br><span class=\"line\">  pre</span><br><span class=\"line\">    <span class=\"selector-class\">.comment</span></span><br><span class=\"line\">      <span class=\"attribute\">color</span>: <span class=\"variable\">$highlight</span>-comment</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"selector-class\">.variable</span>,</span><br><span class=\"line\">    <span class=\"selector-class\">.attribute</span>,</span><br><span class=\"line\">    <span class=\"selector-class\">.regexp</span>,</span><br><span class=\"line\">    <span class=\"selector-class\">.ruby</span> <span class=\"selector-class\">.constant</span>,</span><br><span class=\"line\">    <span class=\"selector-class\">.xml</span> <span class=\"selector-class\">.tag</span> <span class=\"selector-class\">.title</span>,</span><br><span class=\"line\">    <span class=\"selector-class\">.xml</span> <span class=\"selector-class\">.pi</span>,</span><br><span class=\"line\">    <span class=\"selector-class\">.xml</span> <span class=\"selector-class\">.doctype</span>,</span><br><span class=\"line\">    <span class=\"selector-class\">.html</span> <span class=\"selector-class\">.doctype</span>,</span><br><span class=\"line\">    <span class=\"selector-class\">.css</span> <span class=\"selector-class\">.id</span>,</span><br><span class=\"line\">    <span class=\"selector-class\">.tag</span> <span class=\"selector-class\">.name</span>,</span><br><span class=\"line\">    <span class=\"selector-class\">.css</span> <span class=\"selector-class\">.class</span>,</span><br><span class=\"line\">    <span class=\"selector-class\">.css</span> <span class=\"selector-class\">.pseudo</span></span><br><span class=\"line\">      <span class=\"attribute\">color</span>: <span class=\"variable\">$highlight</span>-red</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"selector-class\">.tag</span></span><br><span class=\"line\">      <span class=\"attribute\">color</span>: <span class=\"variable\">$highlight</span>-aqua</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"selector-class\">.number</span>,</span><br><span class=\"line\">    <span class=\"selector-class\">.preprocessor</span>,</span><br><span class=\"line\">    <span class=\"selector-class\">.literal</span>,</span><br><span class=\"line\">    <span class=\"selector-class\">.params</span>,</span><br><span class=\"line\">    <span class=\"selector-class\">.constant</span>,</span><br><span class=\"line\">    <span class=\"selector-class\">.command</span></span><br><span class=\"line\">      <span class=\"attribute\">color</span>: <span class=\"variable\">$highlight</span>-orange</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"selector-class\">.built_in</span></span><br><span class=\"line\">      <span class=\"attribute\">color</span>: <span class=\"variable\">$highlight</span>-yellow</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"selector-class\">.ruby</span> <span class=\"selector-class\">.class</span> <span class=\"selector-class\">.title</span>,</span><br><span class=\"line\">    <span class=\"selector-class\">.css</span> <span class=\"selector-class\">.rules</span> <span class=\"selector-class\">.attribute</span>,</span><br><span class=\"line\">    <span class=\"selector-class\">.string</span>,</span><br><span class=\"line\">    <span class=\"selector-class\">.value</span>,</span><br><span class=\"line\">    <span class=\"selector-class\">.inheritance</span>,</span><br><span class=\"line\">    <span class=\"selector-class\">.header</span>,</span><br><span class=\"line\">    <span class=\"selector-class\">.ruby</span> <span class=\"selector-class\">.symbol</span>,</span><br><span class=\"line\">    <span class=\"selector-class\">.xml</span> <span class=\"selector-class\">.cdata</span>,</span><br><span class=\"line\">    <span class=\"selector-class\">.special</span>,</span><br><span class=\"line\">    <span class=\"selector-class\">.number</span>,</span><br><span class=\"line\">    <span class=\"selector-class\">.formula</span></span><br><span class=\"line\">      <span class=\"attribute\">color</span>: <span class=\"variable\">$highlight</span>-green</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"selector-class\">.keyword</span>,</span><br><span class=\"line\">    <span class=\"selector-class\">.title</span>,</span><br><span class=\"line\">    <span class=\"selector-class\">.css</span> <span class=\"selector-class\">.hexcolor</span></span><br><span class=\"line\">      <span class=\"attribute\">color</span>: <span class=\"variable\">$highlight</span>-aqua</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"selector-class\">.function</span>,</span><br><span class=\"line\">    <span class=\"selector-class\">.python</span> <span class=\"selector-class\">.decorator</span>,</span><br><span class=\"line\">    <span class=\"selector-class\">.python</span> <span class=\"selector-class\">.title</span>,</span><br><span class=\"line\">    <span class=\"selector-class\">.ruby</span> <span class=\"selector-class\">.function</span> <span class=\"selector-class\">.title</span>,</span><br><span class=\"line\">    <span class=\"selector-class\">.ruby</span> <span class=\"selector-class\">.title</span> <span class=\"selector-class\">.keyword</span>,</span><br><span class=\"line\">    <span class=\"selector-class\">.perl</span> <span class=\"selector-class\">.sub</span>,</span><br><span class=\"line\">    <span class=\"selector-class\">.javascript</span> <span class=\"selector-class\">.title</span>,</span><br><span class=\"line\">    <span class=\"selector-class\">.coffeescript</span> <span class=\"selector-class\">.title</span></span><br><span class=\"line\">      <span class=\"attribute\">color</span>: <span class=\"variable\">$highlight</span>-blue</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"selector-class\">.tag</span> <span class=\"selector-class\">.attr</span>,</span><br><span class=\"line\">    <span class=\"selector-class\">.javascript</span> <span class=\"selector-class\">.function</span></span><br><span class=\"line\">      <span class=\"attribute\">color</span>: <span class=\"variable\">$highlight</span>-purple</span><br></pre></td></tr></table></figure>\n<p>新建<code>theme.styl</code></p>\n<figure class=\"highlight styl\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/*代码颜色处理*/</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$highlight_theme</span> = <span class=\"built_in\">hexo-config</span>(<span class=\"string\">&#x27;highlight_theme&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> <span class=\"variable\">$highlight_theme</span> == <span class=\"string\">&#x27;default&#x27;</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-wrap = <span class=\"number\">#222d32</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-<span class=\"attribute\">background</span> = <span class=\"number\">#263238</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-current-line = <span class=\"number\">#efefef</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-selection = <span class=\"number\">#80CBC420</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-foreground = <span class=\"number\">#EEFFFF</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-comment = <span class=\"number\">#546E7A</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-red = <span class=\"number\">#FF5370</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-orange = <span class=\"number\">#F78C6C</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-yellow = <span class=\"number\">#FFCB6B</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-green = <span class=\"number\">#C3E88D</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-aqua = <span class=\"number\">#89DDFF</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-blue = <span class=\"number\">#82AAFF</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-purple = <span class=\"number\">#C792EA</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-deletion = <span class=\"number\">#BF42BF</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-addition = <span class=\"number\">#105EDE</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-gutter = &#123;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: alpha(<span class=\"variable\">$highlight</span>-foreground, .<span class=\"number\">5</span>),</span><br><span class=\"line\">    bg-<span class=\"attribute\">color</span>: <span class=\"variable\">$highlight</span>-background</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-tools = &#123;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: alpha(<span class=\"variable\">$highlight</span>-foreground, .<span class=\"number\">8</span>),</span><br><span class=\"line\">    bg-<span class=\"attribute\">color</span>: darken(<span class=\"variable\">$highlight</span>-background, <span class=\"number\">2</span>)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-scrollbar = <span class=\"built_in\">darken</span>(<span class=\"variable\">$highlight</span>-<span class=\"attribute\">background</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> <span class=\"variable\">$highlight_theme</span> == <span class=\"string\">&#x27;darker&#x27;</span> || (<span class=\"variable\">$highlight_theme</span> == <span class=\"string\">&#x27;mac&#x27;</span>)</span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-wrap = <span class=\"number\">#1c1c1c</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-<span class=\"attribute\">background</span> = <span class=\"number\">#212121</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-current-line = <span class=\"number\">#282a2e</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-selection = <span class=\"number\">#61616150</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-foreground = <span class=\"number\">#EEFFFF</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-comment = <span class=\"number\">#969896</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-red = <span class=\"number\">#FF5370</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-orange = <span class=\"number\">#F78C6C</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-yellow = <span class=\"number\">#FFCB6B</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-green = <span class=\"number\">#C3E88D</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-aqua = <span class=\"number\">#89DDFF</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-blue = <span class=\"number\">#82AAFF</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-purple = <span class=\"number\">#C792EA</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-deletion = <span class=\"number\">#BF42BF</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-addition = <span class=\"number\">#105EDE</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-mac-<span class=\"attribute\">border</span> = rgba(<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, .<span class=\"number\">4</span>)</span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-gutter = &#123;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: alpha(<span class=\"variable\">$highlight</span>-foreground, .<span class=\"number\">5</span>),</span><br><span class=\"line\">    bg-<span class=\"attribute\">color</span>: <span class=\"variable\">$highlight</span>-background</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-tools = &#123;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: alpha(<span class=\"variable\">$highlight</span>-foreground, .<span class=\"number\">8</span>),</span><br><span class=\"line\">    bg-<span class=\"attribute\">color</span>: darken(<span class=\"variable\">$highlight</span>-background, <span class=\"number\">2</span>)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-scrollbar = <span class=\"built_in\">darken</span>(<span class=\"variable\">$highlight</span>-<span class=\"attribute\">background</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> <span class=\"variable\">$highlight_theme</span> == <span class=\"string\">&#x27;pale night&#x27;</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-wrap = <span class=\"number\">#252938</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-<span class=\"attribute\">background</span> = <span class=\"number\">#292D3E</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-current-line = <span class=\"number\">#393939</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-selection = <span class=\"number\">#717CB450</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-foreground = <span class=\"number\">#A6ACCD</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-comment = <span class=\"number\">#676E95</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-red = <span class=\"number\">#FF5370</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-orange = <span class=\"number\">#F78C6C</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-yellow = <span class=\"number\">#FFCB6B</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-green = <span class=\"number\">#C3E88D</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-aqua = <span class=\"number\">#89DDFF</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-blue = <span class=\"number\">#82AAFF</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-purple = <span class=\"number\">#C792EA</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-deletion = <span class=\"number\">#BF42BF</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-addition = <span class=\"number\">#105EDE</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-gutter = &#123;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: alpha(<span class=\"variable\">$highlight</span>-foreground, .<span class=\"number\">5</span>),</span><br><span class=\"line\">    bg-<span class=\"attribute\">color</span>: <span class=\"variable\">$highlight</span>-background</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-tools = &#123;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: <span class=\"variable\">$highlight</span>-foreground,</span><br><span class=\"line\">    bg-<span class=\"attribute\">color</span>: darken(<span class=\"variable\">$highlight</span>-background, <span class=\"number\">2</span>)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-scrollbar = <span class=\"built_in\">darken</span>(<span class=\"variable\">$highlight</span>-<span class=\"attribute\">background</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> <span class=\"variable\">$highlight_theme</span> == <span class=\"string\">&#x27;ocean&#x27;</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-wrap = <span class=\"number\">#0b0d14</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-<span class=\"attribute\">background</span> = <span class=\"number\">#0F111A</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-current-line = <span class=\"number\">#000000</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-selection = <span class=\"number\">#717CB450</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-foreground = <span class=\"number\">#8F93A2</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-comment = <span class=\"built_in\">rgba</span>(<span class=\"number\">101</span>, <span class=\"number\">115</span>, <span class=\"number\">126</span>, .<span class=\"number\">8</span>)</span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-red = <span class=\"number\">#FF5370</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-orange = <span class=\"number\">#F78C6C</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-yellow = <span class=\"number\">#FFCB6B</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-green = <span class=\"number\">#C3E88D</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-aqua = <span class=\"number\">#89DDFF</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-blue = <span class=\"number\">#82AAFF</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-purple = <span class=\"number\">#C792EA</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-deletion = <span class=\"number\">#BF42BF</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-addition = <span class=\"number\">#105EDE</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-gutter = &#123;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: alpha(<span class=\"variable\">$highlight</span>-foreground, .<span class=\"number\">5</span>),</span><br><span class=\"line\">    bg-<span class=\"attribute\">color</span>: <span class=\"variable\">$highlight</span>-background</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-tools = &#123;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: <span class=\"variable\">$highlight</span>-foreground,</span><br><span class=\"line\">    bg-<span class=\"attribute\">color</span>: darken(<span class=\"variable\">$highlight</span>-background, <span class=\"number\">2</span>)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-scrollbar = <span class=\"built_in\">darken</span>(<span class=\"variable\">$highlight</span>-<span class=\"attribute\">background</span>, <span class=\"number\">5</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> <span class=\"variable\">$highlight_theme</span> == <span class=\"string\">&#x27;light&#x27;</span> || (<span class=\"variable\">$highlight_theme</span> == <span class=\"string\">&#x27;mac light&#x27;</span>)</span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-wrap = <span class=\"number\">#e6ebf1</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-<span class=\"attribute\">background</span> = <span class=\"number\">#F6F8FA</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-current-line = <span class=\"number\">#00346e</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-selection = <span class=\"number\">#80CBC440</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-foreground = <span class=\"number\">#90A4AE</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-comment = <span class=\"built_in\">rgba</span>(<span class=\"number\">149</span>, <span class=\"number\">165</span>, <span class=\"number\">166</span>, .<span class=\"number\">8</span>)</span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-red = <span class=\"number\">#E53935</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-orange = <span class=\"number\">#F76D47</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-yellow = <span class=\"number\">#FFB62C</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-green = <span class=\"number\">#91B859</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-aqua = <span class=\"number\">#39ADB5</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-blue = <span class=\"number\">#6182B8</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-purple = <span class=\"number\">#7C4DFF</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-deletion = <span class=\"number\">#BF42BF</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-addition = <span class=\"number\">#105EDE</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-mac-<span class=\"attribute\">border</span> = rgba(<span class=\"number\">144</span>, <span class=\"number\">164</span>, <span class=\"number\">174</span>, .<span class=\"number\">4</span>)</span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-gutter = &#123;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: alpha(<span class=\"variable\">$highlight</span>-foreground, .<span class=\"number\">5</span>),</span><br><span class=\"line\">    bg-<span class=\"attribute\">color</span>: <span class=\"variable\">$highlight</span>-background</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-tools = &#123;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: <span class=\"variable\">$highlight</span>-foreground,</span><br><span class=\"line\">    bg-<span class=\"attribute\">color</span>: darken(<span class=\"variable\">$highlight</span>-background, <span class=\"number\">5</span>)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-scrollbar = <span class=\"built_in\">darken</span>(<span class=\"variable\">$highlight</span>-<span class=\"attribute\">background</span>, <span class=\"number\">8</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> <span class=\"variable\">$highlight_theme</span> == false</span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-wrap = <span class=\"number\">#e6ebf1</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-<span class=\"attribute\">background</span> = <span class=\"number\">#F6F8FA</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-foreground = <span class=\"number\">#90A4AE</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-selection = <span class=\"number\">#80CBC440</span></span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-gutter = &#123;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: alpha(<span class=\"variable\">$highlight</span>-foreground, .<span class=\"number\">5</span>),</span><br><span class=\"line\">    bg-<span class=\"attribute\">color</span>: <span class=\"variable\">$highlight</span>-background</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"variable\">$highlight</span>-tools = &#123;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: <span class=\"variable\">$highlight</span>-foreground,</span><br><span class=\"line\">    bg-<span class=\"attribute\">color</span>: darken(<span class=\"variable\">$highlight</span>-background, <span class=\"number\">5</span>)</span><br><span class=\"line\">  &#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>找到主题关于代码块样式相应的文件<br>比如这里我已经把Yilia主题的<code>scss</code>css预处理封装成<code>styles</code>css预处理器了，而且命名为<code>main.styl</code><br>在<code>main.styl</code>里顶部引用(添加)<code>@require &#39;_highlight/theme&#39;</code></p>\n</li>\n<li><p>然后找到主题下主体<code>styl</code>引用文件，我这里改的Yilia主题把他命名为<code>index.styl</code><br>引用刚才上面新建的三个<code>styl</code>文件</p>\n<figure class=\"highlight styl\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">@import</span> <span class=\"string\">&#x27;_highlight/codeFrame&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">@import</span> <span class=\"string\">&#x27;_highlight/theme&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">@import</span> <span class=\"string\">&#x27;_highlight/diff&#x27;</span></span><br></pre></td></tr></table></figure>\n<p>一般都长这样，有很多<code>@import</code><br><img src=\"/img/Hexo-add-CodeBlock/4.png\" alt=\"images\"></p>\n</li>\n<li><p>在主题配置文件里添加</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">## 代码块样式</span></span><br><span class=\"line\"><span class=\"attr\">highlight_theme:</span> <span class=\"string\">mac</span> <span class=\"comment\"># default / darker / pale night / light / ocean / mac / mac light / false</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>配置好后第一次一定要执行<code>hexo clean</code>不然不生效<br>如果出现代码块与代码框不匹配的可以自己修改相应的css样式，由于各个主题样式都不同，这里我就不演示了(f12是个好东西)</p>\n</li>\n</ol>\n<p>你会发现第一行代码呗挡住了，这是我添加修改的</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.article-entry</span> pre, <span class=\"selector-class\">.article-entry</span> <span class=\"selector-class\">.highlight</span>&#123;</span><br><span class=\"line\">      <span class=\"attribute\">margin-top</span>: <span class=\"number\">30px</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"前后对比\"><a href=\"#前后对比\" class=\"headerlink\" title=\"前后对比\"></a>前后对比</h2><p><img src=\"/img/Hexo-add-CodeBlock/1.png\" alt=\"images\"><br><img src=\"/img/Hexo-add-CodeBlock/3.png\" alt=\"images\"></p>\n",
            "tags": [
                "教程",
                "Hexo"
            ]
        },
        {
            "id": "https://blog.imlete.cn/article/Live2d-Config.html",
            "url": "https://blog.imlete.cn/article/Live2d-Config.html",
            "title": "Hexo-Live2d安装教程(自定义Live2d)",
            "date_published": "2020-09-11T13:30:46.000Z",
            "content_html": "<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>使用自己的Live2d看板娘</p>\n<p>每次看别人博客或者网站的时候，别人网站都有好看的看板娘，即使安装了<code>helper-live2d</code>但提供的Live2d太少了<br>那么如何使用自定义的Live2d呢？<br>看网上很多教程都是乱七八糟的，看也看不懂，自己研究了一下，成功了！<br>分享出来，让更多人少踩坑，这里我以<code>紫罗兰永恒花园</code>的<code>薇尔莉特·伊芙加登</code>小姐姐的Live2d模型作为演示，结束后会奉上几个好看的模型<br>如果你有好看的模型可以与我分享(好东西要学会分享)<img src=\"https://blog.imlete.cn/img/Live2d-Config/xixi.png\" alt=\"嘻嘻\"></p>\n<h2 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h2><p>使用<code>helper-live2d</code>的Live2d插件<a href=\"https://github.com/EYHN/hexo-helper-live2d\">https://github.com/EYHN/hexo-helper-live2d</a></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install --save hexo-helper-live2d</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h3><p>安装成功后，在hexo根目录的<code>_config.yml</code>添加如下配置(可以写在主题配置文件里)</p>\n<ol>\n<li><p>基础配置</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Live2D</span></span><br><span class=\"line\"><span class=\"comment\">## https://github.com/EYHN/hexo-helper-live2d</span></span><br><span class=\"line\"><span class=\"attr\">live2d:</span></span><br><span class=\"line\">  <span class=\"attr\">enable:</span> <span class=\"literal\">true</span> <span class=\"comment\"># 开启live2d</span></span><br><span class=\"line\">  <span class=\"comment\"># enable: false</span></span><br><span class=\"line\">  <span class=\"attr\">scriptFrom:</span> <span class=\"string\">local</span> <span class=\"comment\"># 默认</span></span><br><span class=\"line\">  <span class=\"attr\">pluginRootPath:</span> <span class=\"string\">live2d/</span> <span class=\"comment\"># 插件在站点上的根目录(相对路径)</span></span><br><span class=\"line\">  <span class=\"attr\">pluginJsPath:</span> <span class=\"string\">lib/</span> <span class=\"comment\"># 脚本文件相对与插件根目录路径</span></span><br><span class=\"line\">  <span class=\"attr\">pluginModelPath:</span> <span class=\"string\">assets/</span> <span class=\"comment\"># 模型文件相对与插件根目录路径</span></span><br><span class=\"line\">  <span class=\"comment\"># scriptFrom: jsdelivr # jsdelivr CDN</span></span><br><span class=\"line\">  <span class=\"comment\"># scriptFrom: unpkg # unpkg CDN</span></span><br><span class=\"line\">  <span class=\"comment\"># scriptFrom: https://cdn.jsdelivr.net/npm/live2d-widget@3.x/lib/L2Dwidget.min.js # 你的自定义 url</span></span><br><span class=\"line\">  <span class=\"attr\">tagMode:</span> <span class=\"literal\">false</span> <span class=\"comment\"># 标签模式, 是否仅替换 live2d tag标签而非插入到所有页面中</span></span><br><span class=\"line\">  <span class=\"attr\">debug:</span> <span class=\"literal\">false</span> <span class=\"comment\"># 调试, 是否在控制台输出日志</span></span><br><span class=\"line\">  <span class=\"attr\">model:</span></span><br><span class=\"line\">    <span class=\"attr\">use:</span> <span class=\"string\">live2d-widget-model-wanko</span> <span class=\"comment\"># npm-module package name</span></span><br><span class=\"line\">    <span class=\"comment\"># use: wanko # 博客根目录/live2d_models/ 下的目录名</span></span><br><span class=\"line\">    <span class=\"comment\"># use: ./wives/wanko # 相对于博客根目录的路径</span></span><br><span class=\"line\">    <span class=\"comment\"># use: https://cdn.jsdelivr.net/npm/live2d-widget-model-wanko@1.0.5/assets/wanko.model.json # 你的自定义 url</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>进阶配置<br>看如下配置在<code>基础配置</code>的基础上进行添加相应的配置</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">live2d:</span></span><br><span class=\"line\">  <span class=\"attr\">enable:</span> <span class=\"literal\">true</span> <span class=\"comment\"># 是否开启live2d</span></span><br><span class=\"line\">  <span class=\"attr\">scriptFrom:</span> <span class=\"string\">local</span> <span class=\"comment\">## 脚本从本地引入</span></span><br><span class=\"line\">  <span class=\"attr\">pluginRootPath:</span> <span class=\"string\">live2dw/</span> <span class=\"comment\"># 模型根目录(指hexo g后生成public\\live2dw文件名)</span></span><br><span class=\"line\">  <span class=\"attr\">pluginJsPath:</span> <span class=\"string\">lib/</span> <span class=\"comment\"># 依赖js的文件夹名(public\\live2dw\\lib)</span></span><br><span class=\"line\">  <span class=\"attr\">pluginModelPath:</span> <span class=\"string\">assets/</span> <span class=\"comment\"># 模型存放目录(public\\live2dw\\assets)</span></span><br><span class=\"line\">  <span class=\"attr\">tagMode:</span> <span class=\"literal\">false</span> <span class=\"comment\"># 标记模式(未知) </span></span><br><span class=\"line\">  <span class=\"attr\">log:</span> <span class=\"literal\">false</span> <span class=\"comment\"># 日志</span></span><br><span class=\"line\">  <span class=\"attr\">model:</span> <span class=\"comment\"># 模型</span></span><br><span class=\"line\">    <span class=\"attr\">use:</span> <span class=\"string\">live2d-widget-model-wanko</span> <span class=\"comment\"># 使用的模型名称</span></span><br><span class=\"line\">  <span class=\"attr\">display:</span> <span class=\"comment\"># 显示</span></span><br><span class=\"line\">    <span class=\"attr\">position:</span> <span class=\"string\">right</span> <span class=\"comment\"># 显示在右边(left显示在左边)</span></span><br><span class=\"line\">    <span class=\"attr\">width:</span> <span class=\"number\">150</span> <span class=\"comment\"># 宽度</span></span><br><span class=\"line\">    <span class=\"attr\">height:</span> <span class=\"number\">300</span> <span class=\"comment\"># 高度</span></span><br><span class=\"line\">  <span class=\"attr\">mobile:</span></span><br><span class=\"line\">    <span class=\"attr\">show:</span> <span class=\"literal\">true</span> <span class=\"comment\"># 手机端是否显示</span></span><br><span class=\"line\">  <span class=\"attr\">react:</span></span><br><span class=\"line\">    <span class=\"attr\">opacity:</span> <span class=\"number\">0.7</span> <span class=\"comment\"># 透明度</span></span><br></pre></td></tr></table></figure>\n<p>下面是我在<code>基础配置</code>的基础上添加的几个属性</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Live2D</span></span><br><span class=\"line\"><span class=\"comment\">## https://github.com/EYHN/hexo-helper-live2d</span></span><br><span class=\"line\"><span class=\"attr\">live2d:</span></span><br><span class=\"line\">  <span class=\"attr\">enable:</span> <span class=\"literal\">true</span> <span class=\"comment\"># 开启live2d</span></span><br><span class=\"line\">  <span class=\"comment\"># enable: false</span></span><br><span class=\"line\">  <span class=\"attr\">scriptFrom:</span> <span class=\"string\">local</span> <span class=\"comment\"># 默认</span></span><br><span class=\"line\">  <span class=\"attr\">pluginRootPath:</span> <span class=\"string\">live2d/</span> <span class=\"comment\"># 插件在站点上的根目录(相对路径)</span></span><br><span class=\"line\">  <span class=\"attr\">pluginJsPath:</span> <span class=\"string\">lib/</span> <span class=\"comment\"># 脚本文件相对与插件根目录路径</span></span><br><span class=\"line\">  <span class=\"attr\">pluginModelPath:</span> <span class=\"string\">assets/</span> <span class=\"comment\"># 模型文件相对与插件根目录路径</span></span><br><span class=\"line\">  <span class=\"comment\"># scriptFrom: jsdelivr # jsdelivr CDN</span></span><br><span class=\"line\">  <span class=\"comment\"># scriptFrom: unpkg # unpkg CDN</span></span><br><span class=\"line\">  <span class=\"comment\"># scriptFrom: https://cdn.jsdelivr.net/npm/live2d-widget@3.x/lib/L2Dwidget.min.js # 你的自定义 url</span></span><br><span class=\"line\">  <span class=\"attr\">tagMode:</span> <span class=\"literal\">false</span> <span class=\"comment\"># 标签模式, 是否仅替换 live2d tag标签而非插入到所有页面中</span></span><br><span class=\"line\">  <span class=\"attr\">debug:</span> <span class=\"literal\">false</span> <span class=\"comment\"># 调试, 是否在控制台输出日志</span></span><br><span class=\"line\">  <span class=\"attr\">display:</span></span><br><span class=\"line\">     <span class=\"attr\">position:</span> <span class=\"string\">left</span></span><br><span class=\"line\">  <span class=\"attr\">mobile:</span></span><br><span class=\"line\">     <span class=\"attr\">show:</span> <span class=\"literal\">false</span>   </span><br><span class=\"line\">  <span class=\"attr\">model:</span></span><br><span class=\"line\">     <span class=\"attr\">scale:</span> <span class=\"number\">1.2</span></span><br><span class=\"line\">     <span class=\"attr\">use:</span> <span class=\"string\">weier</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>高级配置<br>建议小白可以不必理会，高玩请随意，官方 API 地址：<a href=\"https://l2dwidget.js.org/docs/class/src/index.js~L2Dwidget.html#instance-method-init\">L2Dwidget | live2d-widget.js</a></p>\n</li>\n</ol>\n<h3 id=\"使用模型\"><a href=\"#使用模型\" class=\"headerlink\" title=\"使用模型\"></a>使用模型</h3><ol>\n<li><p>自定义模型<br>使用自己下载好的模型<br>在hexo根目录新建<code>live2d_models</code>文件夹，然后把模型放进去，最后在<code>live2d</code>配置里的<code>model:</code>下的<code>use:</code>输入模型文件夹名<br>在我提供的<code>live2d</code>的压缩包里有几个模型，这里我以<code>薇尔莉特·伊芙加登</code>进行演示</p>\n<blockquote>\n<p>将<code>薇尔莉特·伊芙加登</code>复制到刚从新建的<code>live2d_models</code>文件夹内，然后重命名为<code>weier</code>(当然这个名字是你自定义的)，然后进入<code>weier</code>文件夹，里面有个<code>14.json</code>文件，将他重命名为<code>weier.model.json</code>其他文件无需修改，最后在<code>live2d</code>配置里的<code>model:</code>下的<code>use:</code>输入模型文件夹名(weier)</p>\n</blockquote>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">model:</span></span><br><span class=\"line\">     <span class=\"attr\">use:</span> <span class=\"string\">weier</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>使用 <code>npm install &#123;packagename&#125;</code> 安装模型如下</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install live2d-widget-model-wanko</span><br></pre></td></tr></table></figure>\n<p>目前有如下模型<a href=\"https://huaji8.top/post/live2d-plugin-2.0/\">模型样式</a><br><code>live2d-widget-model-chitose</code><br><code>live2d-widget-model-epsilon2_1</code><br><code>live2d-widget-model-gf</code><br><code>live2d-widget-model-haru/01</code> (use <code>npm install --save live2d-widget-model-haru</code>)<br><code>live2d-widget-model-haru/02</code> (use <code>npm install --save live2d-widget-model-haru</code>)<br><code>live2d-widget-model-haruto</code><br><code>live2d-widget-model-hibiki</code><br><code>live2d-widget-model-hijiki</code><br><code>live2d-widget-model-izumi</code><br><code>live2d-widget-model-koharu</code><br><code>live2d-widget-model-miku</code><br><code>live2d-widget-model-ni-j</code><br><code>live2d-widget-model-nico</code><br><code>live2d-widget-model-nietzsche</code><br><code>live2d-widget-model-nipsilon</code><br><code>live2d-widget-model-nito</code><br><code>live2d-widget-model-shizuku</code><br><code>live2d-widget-model-tororo</code><br><code>live2d-widget-model-tsumiki</code><br><code>live2d-widget-model-unitychan</code><br><code>live2d-widget-model-wanko</code><br><code>live2d-widget-model-z16</code></p>\n</li>\n</ol>\n<h3 id=\"模型下载地址\"><a href=\"#模型下载地址\" class=\"headerlink\" title=\"模型下载地址\"></a>模型下载地址</h3><p>链接: <a href=\"https://terabox.com/s/1ucoUS1sO_QvNGAR4Srx1mQ\">https://terabox.com/s/1ucoUS1sO_QvNGAR4Srx1mQ</a>  密码:<code>us6i</code></p>\n",
            "tags": [
                "教程",
                "Live2d",
                "Config"
            ]
        },
        {
            "id": "https://blog.imlete.cn/article/upyun-cdn-config.html",
            "url": "https://blog.imlete.cn/article/upyun-cdn-config.html",
            "title": "又拍云CDN配置",
            "date_published": "2020-08-14T22:39:10.000Z",
            "content_html": "<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>为什么我要写这篇文章？因为网上的教程不行，看了也不懂，重点没有说明清楚<br>导致很多人没弄清楚，到头来还是自己摸索出来的(在说自己)<br>看了本片文章，少走弯路</p>\n<h2 id=\"准备工作\"><a href=\"#准备工作\" class=\"headerlink\" title=\"准备工作\"></a>准备工作</h2><p>1.又拍云<br>2.域名<br>3.域名已备案<br>4.一双手和一个小脑袋</p>\n<p>准备两个二级域名<br>加速域名: test1.lete114.top<br>回源域名: test2.lete114.top<br>(如果你的网站是Github Pages的话可以使用xxxx.github.io当作回源域名)<br>(我这里为了方便演示，就使用test1和test2，test1就是相当于本站的blog.lete114.top)<br><img src=\"/img/upyun-cdn-config/1.png\" alt=\"\"></p>\n<h2 id=\"创建-CDN-服务\"><a href=\"#创建-CDN-服务\" class=\"headerlink\" title=\"创建 CDN 服务\"></a>创建 CDN 服务</h2><p>这里的加速域名我test后面少打了个1<br>源站证书校验就不要开启了，如果开启的话源站与的ssl证书与又拍云证书不符合，就会拒接访问<br><img src=\"/img/upyun-cdn-config/2.png\" alt=\"\"></p>\n<p>test1.lete114.top域名<code>CNAME</code>解析到<code>lete-test.b0.aicdn.com</code><br>test2.lete114.top域名<code>CNAME</code>解析到<code>lete114.github.io</code><br><img src=\"/img/upyun-cdn-config/3.png\" alt=\"\"></p>\n<h2 id=\"其他配置\"><a href=\"#其他配置\" class=\"headerlink\" title=\"其他配置\"></a>其他配置</h2><h3 id=\"缓存控制\"><a href=\"#缓存控制\" class=\"headerlink\" title=\"缓存控制\"></a>缓存控制</h3><p>资源路径输入<code>*.*</code>表示全站缓存，缓存时间看个人喜好（我选择2小时）</p>\n<p>补充：缓存配置是为了不必要的资源消耗，设置缓存配置后，两小时内又拍云不会到源站抓取资源，节省了CDN流量<br>如果未设置缓存配置的话，每次有人打开你的网站，又拍云都要到源站去抓取资源</p>\n<p><img src=\"https://upimage.alexhchu.com/2020/08/15/b7ba0d54c0fb2.png\" alt=\"image.png\"></p>\n<h3 id=\"性能优化\"><a href=\"#性能优化\" class=\"headerlink\" title=\"性能优化\"></a>性能优化</h3><p><code>开启</code>页面压缩</p>\n<p>自动去除页面文件中非必要的字符（空白、注释等），自动压缩文件大小，加快传输速度。</p>\n<p><code>开启</code>重定向跟随</p>\n<p>CDN 节点回源请求，若源站响应 301/302 状态码，则直接跳转获取资源，不会返回 301/302 给终端用户，免去了用户再次向 301/302 后的 URL 发起请求的连接时间，从而加快用户访问速度。</p>\n<h3 id=\"HTTPS\"><a href=\"#HTTPS\" class=\"headerlink\" title=\"HTTPS\"></a>HTTPS</h3><p><code>开启</code>TLS 1.3</p>\n<p>TLS 1.3 是一种全新的加密协议，它既能提高终端用户的访问速度，又能增强安全性</p>\n<p><code>开启</code>最低 TLS 版本 选择1.0</p>\n<p><code>开启</code>HTTP/2</p>\n<h3 id=\"访问控制\"><a href=\"#访问控制\" class=\"headerlink\" title=\"访问控制\"></a>访问控制</h3><p><code>开启</code>CC 防护</p>\n<p>针对网络安全领域中的 CC 攻击而进行的一种应用层攻击防护，针对匹配的 URI 进行页面校验，来决定是放行还是直接拦截。</p>\n<p><code>开启</code>WAF 保护 </p>\n<p>WAF 也即 Web Application Firewall，能有效拦截跨站攻击、SQL 注入和其他代码执行等多种攻击方式。</p>\n<h3 id=\"成本控制\"><a href=\"#成本控制\" class=\"headerlink\" title=\"成本控制\"></a>成本控制</h3><p><code>开启</code>WebP 自适应</p>\n<p>智能判断浏览器是否支持 WebP，来决定返回 WebP 格式图片还是原图，从而减少网络传输消耗。</p>\n<h3 id=\"页脚添加又拍云\"><a href=\"#页脚添加又拍云\" class=\"headerlink\" title=\"页脚添加又拍云\"></a>页脚添加又拍云</h3><p>打开主题配置文件找到<code>custom_text:</code>添加<br>如果你没有页脚文字描述的话可以吧前面的<code>&lt;br&gt;</code>去掉</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">&lt;br&gt;&lt;a</span> <span class=\"string\">href=&quot;https://www.upyun.com/?utm_source=lianmeng&amp;utm_medium=referral&quot;</span> <span class=\"string\">target=&quot;_blank&quot;</span> <span class=\"string\">rel=&quot;noopener&quot;</span> <span class=\"string\">class=&quot;one-pan-link-mark&quot;&gt;&lt;img</span> <span class=\"string\">style=&quot;position:relative;top:-3px;</span> <span class=\"string\">&quot; src=&quot;</span><span class=\"string\">https://cdn.jsdelivr.net/gh/lete114/CDN/upyun/%E5%8F%88%E6%8B%8D%E4%BA%91_logo5.png&quot;</span> <span class=\"string\">align=&quot;absmiddle&quot;</span> <span class=\"string\">width=&quot;60px&quot;</span> <span class=\"string\">height=&quot;30px&quot;&gt;提供加速服务&lt;/a&gt;</span></span><br></pre></td></tr></table></figure>\n\n\n<p><span style=\"font-size:20px\">如有任何问题，可以在评论区留言</span></p>\n",
            "tags": [
                "记录",
                "教程"
            ]
        },
        {
            "id": "https://blog.imlete.cn/article/DouYin.html",
            "url": "https://blog.imlete.cn/article/DouYin.html",
            "title": "手把手教你，抖音去水印(有手就能学会)",
            "date_published": "2020-07-18T15:00:57.000Z",
            "content_html": "<h1 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h1><p>相信你在百度搜索可能搜到在线去水印的在线网站吧？<br>或者使用<code>APP</code>去水印，<code>微信小程序</code>去水印？<br>是的，这些的确是去水印最快的方法，不过在使用多次以后，就不能再次使用了<br>有些需要你<code>花钱</code>购买<code>解析次数</code>(下载次数)，或者限制每天只能解析<code>1~~3</code>个视频(可能是按月)<br>其实上面所说的大多都是封装了下面的步骤而实现的自动化去水印</p>\n<p>本片文章获取的无水印视频步骤可能很多，不方便批量处理，但这里只是提供一个去视频水印的一个思路(其他平台自测)</p>\n<h2 id=\"教程开始\"><a href=\"#教程开始\" class=\"headerlink\" title=\"教程开始\"></a>教程开始</h2><ol>\n<li><p>点击抖音的分享按钮，获取链接<br>这里我以<code>《烈阳天道Ⅰ》</code>为例<br>地址：<a href=\"https://v.douyin.com/JYAYdfH/\">https://v.douyin.com/JYAYdfH/</a></p>\n</li>\n<li><p>复制链接浏览器打开<br>打开后按<code>F12</code>—&gt;选择<code>手机模式</code>—&gt;<code>刷新网页</code>—&gt;选择<code>Network</code>—&gt;搜索框内输入<code>item</code>—&gt;选择<code>Headers</code>—&gt;展开<code>General</code><br><img src=\"/img/DouYin/1.png\" alt=\"image.png\"></p>\n</li>\n<li><p>复制<code>Requst URL</code>的链接到地址栏回车(手机模式)<br>打开后按<code>F12</code>—&gt;依次展开—&gt;<code>item_list</code>—&gt;<code>0</code>—&gt;<code>video</code>—&gt;<code>play_addr</code>—&gt;<code>url_list</code>—&gt;<code>0</code><br>最终得到<code>0: &quot;https://aweme.snssdk.com/aweme/v1/playwm/?video_id=v0200f480000bs78bq8ckillkpgb8c8g&amp;ratio=720p&amp;line=0&quot;</code><br><img src=\"/img/DouYin/2.png\" alt=\"image.png\"></p>\n</li>\n<li><p>最后一步<br>复制<code>0</code>后面的链接复制到浏览器地址栏<br>将链接的<code>playwm</code>改为<code>play</code><br>说明：<code>wm</code>为<code>Watermark</code>而Watermark翻译过来就是<code>水印</code><br>修改后：<a href=\"https://aweme.snssdk.com/aweme/v1/play/?video_id=v0200f480000bs78bq8ckillkpgb8c8g&amp;ratio=720p&amp;line=0\">https://aweme.snssdk.com/aweme/v1/play/?video_id=v0200f480000bs78bq8ckillkpgb8c8g&amp;ratio=720p&amp;line=0</a></p>\n</li>\n<li><p>常见问题<br><code>问：</code>为什么显示下载的是html文件？<br><code>答：</code>因为抖音采取的视频是m3u8格式视频，只需要把html改成mp4即可<br><code>m3u8：</code>将一个视频切片成多个细小的块，然后分发给各个用户(抖音采取的<code>p2p</code>传输模式，大大降低了宽带费用的，如果不采取p2p模式的话，宽带成本是很高的，毕竟日活跃用户那么高)<br><code>问：</code>为什么最后得到的链接输入后回车，白屏？<br><code>答：</code>因该是浏览器问题，或者是被某款杀毒软件拦截，这个问题我也有，不过我把链接放到手机浏览器打开可以在线播放和下载(华为自带浏览器)<br><span style='color:red'>注：由于我的GitHub仓库被官方人员禁止了，导致视频失效</span><br><video id=\"video\" controls style='height: 100%;width: 100%;object-fit: cover;'></video></p>\n<script>\nvar video = document.getElementById('video');\nvar videoSrc = 'https://cdn.jsdelivr.net/gh/lete114/CDN2/video/lytd/1.m3u8';\nif (Hls.isSupported()) {\n var hls = new Hls();\n hls.loadSource(videoSrc);\n hls.attachMedia(video);\n hls.on(Hls.Events.MANIFEST_PARSED, function() {\n   video.play();\n });\n}\n</script>\n</li>\n</ol>\n",
            "tags": [
                "记录",
                "教程"
            ]
        }
    ]
}