(async()=>{const e=(e,t)=>(t||document).querySelector(e),t=document.currentScript.getAttribute("path"),n=e(".search-input"),i=e(".search-history"),o=e(".search-history-list"),a=e(".search-history-clear"),r=e(".search-result"),s=JSON.parse(localStorage.getItem("search-history")||"[]").reverse();a.addEventListener("click",(()=>{localStorage.setItem("search-history","[]"),s.length=0,o.innerHTML="",i.style=""}));const c=document.createDocumentFragment();s.forEach((e=>{const t=document.createElement("div");t.className="search-history-item",t.innerText=e,t.addEventListener("click",(()=>{n.value=e,n.dispatchEvent(new Event("input"))})),c.appendChild(t)})),o.appendChild(c);const l=await fetch(t),p=(await l.json()).map((e=>(e.content=function(e){const t=String.fromCharCode,n=e.length,i=32768;if(!e)return"";var o,a,r,s,c,l,p,h=[],d=4,u=4,m=3,v="",f=[],g={val:e.charCodeAt(0),position:i,index:1};for(o=0;o<3;o+=1)h[o]=o;r=0,c=Math.pow(2,2),l=1;for(;l!=c;)s=g.val&g.position,g.position>>=1,0==g.position&&(g.position=i,g.val=e.charCodeAt(g.index++)),r|=(s>0?1:0)*l,l<<=1;switch(next=r){case 0:for(r=0,c=Math.pow(2,8),l=1;l!=c;)s=g.val&g.position,g.position>>=1,0==g.position&&(g.position=i,g.val=e.charCodeAt(g.index++)),r|=(s>0?1:0)*l,l<<=1;p=t(r);break;case 1:for(r=0,c=Math.pow(2,16),l=1;l!=c;)s=g.val&g.position,g.position>>=1,0==g.position&&(g.position=i,g.val=e.charCodeAt(g.index++)),r|=(s>0?1:0)*l,l<<=1;p=t(r);break;case 2:return""}h[3]=p,a=p,f.push(p);for(;;){if(g.index>n)return"";for(r=0,c=Math.pow(2,m),l=1;l!=c;)s=g.val&g.position,g.position>>=1,0==g.position&&(g.position=i,g.val=e.charCodeAt(g.index++)),r|=(s>0?1:0)*l,l<<=1;switch(p=r){case 0:for(r=0,c=Math.pow(2,8),l=1;l!=c;)s=g.val&g.position,g.position>>=1,0==g.position&&(g.position=i,g.val=e.charCodeAt(g.index++)),r|=(s>0?1:0)*l,l<<=1;h[u++]=t(r),p=u-1,d--;break;case 1:for(r=0,c=Math.pow(2,16),l=1;l!=c;)s=g.val&g.position,g.position>>=1,0==g.position&&(g.position=i,g.val=e.charCodeAt(g.index++)),r|=(s>0?1:0)*l,l<<=1;h[u++]=t(r),p=u-1,d--;break;case 2:return f.join("")}if(0==d&&(d=Math.pow(2,m),m++),h[p])v=h[p];else{if(p!==u)return null;v=a+a.charAt(0)}f.push(v),h[u++]=a+v.charAt(0),a=v,0==--d&&(d=Math.pow(2,m),m++)}}(e.content),e)));n.addEventListener("input",(()=>{const e=n.value.trim();var t=e.split(/[\s\-]+/);r.innerHTML="";const i=document.createDocumentFragment(),o=document.createElement("ul");o.className="search-result-list",i.appendChild(o),e.length&&(p.forEach((e=>{var i=!0;e.title||(e.title="No Title");var a=e.title.trim(),r=e.content.trim().replace(/<[^>]+>/g,"").toLowerCase(),c=e.url.startsWith("/")?e.url:"/"+e.url,l=-1,p=-1,h=-1;if(r?t.forEach((function(e,t){l=a.indexOf(e),p=r.indexOf(e),l<0&&p<0?i=!1:(p<0&&(p=0),0==t&&(h=p))})):i=!1,i){var d=e.content.trim().replace(/<[^>]+>/g,"");if(h>=0){var u=h-20,m=h+80;u<0&&(u=0),0==u&&(m=100),m>d.length&&(m=d.length);var v=d.substring(u,m);t.forEach((e=>{const t=new RegExp(`(${e})`,"gi"),n='<span class="search-keyword">$1</span>';v=v.replace(t,n),a=a.replace(t,n)}));const e=document.createElement("li"),i=document.createElement("a"),r=document.createElement("p");i.href=c,i.className="search-result-title",i.innerHTML=a,i.addEventListener("click",(()=>{const e=n.value;s.includes(e)||s.push(e),localStorage.setItem("search-history",JSON.stringify(s))})),r.className="search-abstract",r.innerHTML=v+"...",e.appendChild(i),e.appendChild(r),o.appendChild(e)}}})),r.appendChild(i))}))})();