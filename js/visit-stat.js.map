{"version":3,"names":["url","view_icon","user_icon","home","document","querySelector","page","posts","Array","from","querySelectorAll","urls","map","post","href","console","log","fetch","method","body","JSON","stringify","then","response","json","data","forEach","item","action","parentElement","insert_meta","page_uv","page_pv","meta","icon","meta_dom","clone","cloneNode","innerHTML","appendChild","referrerPolicy"],"sources":["visit-stat.js.map"],"sourcesContent":[";(() => {\n  const url = 'https://visit-stat.imlete.cn'\n  const view_icon =\n    '<svg class=\"view-icon\" width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M7.90078 2.80078C4.49278 2.80078 1.74745 6.11672 0.800781 7.77469C1.74745 9.58339 4.49278 13.2008 7.90078 13.2008C11.3088 13.2008 14.0541 9.58339 15.0008 7.77469C14.0541 6.11672 11.3088 2.80078 7.90078 2.80078Z\" stroke=\"currentColor\"></path><circle cx=\"7.89922\" cy=\"8.00078\" r=\"2.2\" stroke=\"currentColor\"></circle</svg>'\n  const user_icon =\n    '<svg class=\"user-icon\" width=\"16\" height=\"16\" viewBox=\"0 0 48 48\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" stroke-width=\"4\" stroke=\"currentColor\"><circle cx=\"24\" cy=\"12\" r=\"8\"></circle><path d=\"M42 44C42 34.0589 33.9411 26 24 26C14.0589 26 6 34.0589 6 44\"></path></svg>'\n  const home = document.querySelector('.post-title')\n  const page = document.querySelector('.page-title')\n  if (home) {\n    const posts = Array.from(document.querySelectorAll('.post-item .post-title'))\n    const urls = posts.map((post) => post.href)\n    console.log('urls', urls)\n    fetch(url + '/visits', { method: 'post', body: JSON.stringify({ urls }) })\n      .then((response) => response.json())\n      .then((/** @type { object[] } */ data) => {\n        console.log('visits data', data)\n        posts.forEach((/** @type { HTMLAnchorElement } */ post) => {\n          const url = post.href\n          data.forEach((/** @type { { url:string; page_pv:number; page_uv:number; } } */ item) => {\n            if (item.url !== url) return\n            /**\n             * @type { Element }\n             */\n            const action = post.parentElement.querySelector('.post-action-item')\n            insert_meta(action, user_icon, item.page_uv)\n            insert_meta(action, view_icon, item.page_pv)\n          })\n        })\n      })\n  }\n  if (page) {\n    fetch(url, { referrerPolicy: 'no-referrer-when-downgrade' })\n      .then((response) => response.json())\n      .then((data) => {\n        console.log('data', data)\n        insert_meta('.article-meta-item', user_icon, data.page_uv)\n        insert_meta('.article-meta-item', view_icon, data.page_pv)\n      })\n  }\n  /**\n   *\n   * @param { Element | string } meta\n   * @param { string } icon\n   * @param { number } data\n   */\n  function insert_meta(meta, icon, data) {\n    /**\n     * @type { HTMLDivElement }\n     */\n    const meta_dom = typeof meta === 'string' ? document.querySelector(meta) : meta\n    /**\n     * @type { HTMLDivElement }\n     */\n    const clone = meta_dom.cloneNode(true)\n    clone.innerHTML = icon + `<span>${data}</span>`\n    meta_dom.parentElement.appendChild(clone)\n  }\n})()\n"],"mappings":"AAAC,MACC,MAAMA,EAAM,+BACNC,EACJ,4bACIC,EACJ,sRACIC,EAAOC,SAASC,cAAc,eAC9BC,EAAOF,SAASC,cAAc,eACpC,GAAIF,EAAM,CACR,MAAMI,EAAQC,MAAMC,KAAKL,SAASM,iBAAiB,2BAC7CC,EAAOJ,EAAMK,KAAKC,GAASA,EAAKC,OACtCC,QAAQC,IAAI,OAAQL,GACpBM,MAAMjB,EAAM,UAAW,CAAEkB,OAAQ,OAAQC,KAAMC,KAAKC,UAAU,CAAEV,WAC7DW,MAAMC,GAAaA,EAASC,SAC5BF,MAAgCG,IAC/BV,QAAQC,IAAI,cAAeS,GAC3BlB,EAAMmB,SAA4Cb,IAChD,MAAMb,EAAMa,EAAKC,KACjBW,EAAKC,SAA0EC,IAC7E,GAAIA,EAAK3B,MAAQA,EAAK,OAItB,MAAM4B,EAASf,EAAKgB,cAAcxB,cAAc,qBAChDyB,EAAYF,EAAQ1B,EAAWyB,EAAKI,SACpCD,EAAYF,EAAQ3B,EAAW0B,EAAKK,QAAO,GAC5C,GACF,GAEP,CAgBA,SAASF,EAAYG,EAAMC,EAAMT,GAI/B,MAAMU,EAA2B,iBAATF,EAAoB7B,SAASC,cAAc4B,GAAQA,EAIrEG,EAAQD,EAASE,WAAU,GACjCD,EAAME,UAAYJ,EAAO,SAAST,WAClCU,EAASN,cAAcU,YAAYH,EACrC,CA1BI9B,GACFW,MAAMjB,EAAK,CAAEwC,eAAgB,+BAC1BlB,MAAMC,GAAaA,EAASC,SAC5BF,MAAMG,IACLV,QAAQC,IAAI,OAAQS,GACpBK,EAAY,qBAAsB5B,EAAWuB,EAAKM,SAClDD,EAAY,qBAAsB7B,EAAWwB,EAAKO,QAAO,GAqBhE,EAzDA"}